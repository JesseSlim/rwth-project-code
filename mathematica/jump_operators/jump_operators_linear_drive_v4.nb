(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    260994,       6957]
NotebookOptionsPosition[    251658,       6671]
NotebookOutlinePosition[    252016,       6687]
CellTagsIndexPosition[    251973,       6684]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.720865999487705*^9, 3.720866008214306*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<MagnusFuncs.m\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.720770458697122*^9, 3.7207704760425997`*^9}, {
   3.7207705082294483`*^9, 3.720770515291053*^9}, 3.721499805021591*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{3.722276309554469*^9, 3.72231689040982*^9, 
  3.722317068636815*^9, 3.722317276611753*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/jesse/NC/\"\>"}],
  SequenceForm["  ", "/Users/jesse/NC/"],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276309554469*^9, 3.72231689040982*^9, 
  3.722317068636815*^9, 3.722317276621943*^9}],

Cell[BoxData["\<\"You can now use \\\"<< NCAlgebra`\\\" to load \
NCAlgebra.\"\>"], "Print",
 CellChangeTimes->{3.722276309554469*^9, 3.72231689040982*^9, 
  3.722317068636815*^9, 3.7223172766344633`*^9}],

Cell["\<\
------------------------------------------------------------
NCAlgebra - Version 5.0.3
Compatible with Mathematica Version 10 and above

Authors:

  J. William Helton*
  Mauricio de Oliveira&

* Math, UCSD, La Jolla, CA
& MAE, UCSD, La Jolla, CA

with major earlier contributions by:

  Mark Stankus$ 
  Robert L. Miller#

$ Math, Cal Poly San Luis Obispo
# General Atomics Corp

Copyright: 
  Helton and de Oliveira 2017
  Helton 2002
  Helton and Miller June 1991
  All rights reserved.

The program was written by the authors and by:
  David Hurst, Daniel Lamm, Orlando Merino, Robert Obar,
  Henry Pfister, Mike Walker, John Wavrik, Lois Yu,
  J. Camino, J. Griffin, J. Ovall, T. Shaheen, John Shopple. 
  The beginnings of the program come from eran@slac.
  Considerable recent help came from Igor Klep.

Current primary support is from the 
  NSF Division of Mathematical Sciences.
  
This program was written with support from 
  AFOSR, NSF, ONR, Lab for Math and Statistics at UCSD,
  UCSD Faculty Mentor Program,
  and US Department of Education.

For NCAlgebra updates see:

  www.github.com/NCAlgebra/NC
  www.math.ucsd.edu/~ncalg

------------------------------------------------------------\
\>", "Print",
 CellChangeTimes->{3.722276309554469*^9, 3.72231689040982*^9, 
  3.722317068636815*^9, 3.722317276646441*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"MatrixExp", "::", "eivn"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCommutative", "[", 
   RowBox[{"t", ",", "td0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ww", ">", "0"}], ",", 
     RowBox[{"phi1", ">", "0"}], ",", 
     RowBox[{"t", ">", "0"}], ",", 
     RowBox[{"t0", ">", "0"}], ",", 
     RowBox[{"H1", ">", "0"}], ",", 
     RowBox[{"phi10", ">", "0"}], ",", 
     RowBox[{"tp", ">", "0"}], ",", 
     RowBox[{"xz", ">", "0"}], ",", 
     RowBox[{"t", ">", "t0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7213698094964457`*^9, 3.721369813997707*^9}, {
  3.72214943501926*^9, 3.722149443585431*^9}, {3.72214955434289*^9, 
  3.722149568429648*^9}, {3.722149686466992*^9, 3.722149712930354*^9}, {
  3.722162588045642*^9, 3.722162595126998*^9}, {3.7222309498527403`*^9, 
  3.7222309723199244`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"saveResult", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"saveFile", "=", "\"\<jump_ops_linear_drive_v4.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reload", "=", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.722162597655137*^9, 3.7221625980629597`*^9}, {
   3.722230969754139*^9, 3.722230970217848*^9}, {3.722243646469027*^9, 
   3.722243652899678*^9}, {3.72227179702881*^9, 3.722271797111582*^9}, {
   3.722272054932908*^9, 3.722272057758637*^9}, 3.7222722480077477`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Original Hamiltonian (rotating frame)", "Section",
 CellChangeTimes->{{3.720770537323778*^9, 3.7207705427393923`*^9}, {
  3.720777692919585*^9, 3.7207777320811033`*^9}, {3.7207816372003403`*^9, 
  3.720781655216631*^9}, {3.720787435766768*^9, 3.7207874365371943`*^9}}],

Cell["\<\
Right now I\[CloseCurlyQuote]m just interested in the case of linear drive, \
so the taylor expansion only has two terms\
\>", "Text",
 CellChangeTimes->{{3.720787439975534*^9, 3.7207874751904593`*^9}, {
  3.7227553600620193`*^9, 3.722755369443171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Horig", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"H1", "/", "4"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "phi", "]"}], "*", "sx"}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "*", 
       "sy"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Delta", "/", "2"}], "*", "sz"}]}]}]], "Input",
 CellChangeTimes->{{3.720781656785536*^9, 3.720781674585722*^9}}],

Cell["\<\
The real Hamiltonian only contains H1 (evaluated at different times of \
course), but we include rules for (higher) derivatives so we can apply them \
to Heff as well. Higher order jump operators can be calculated by adding more \
terms in the Taylor expansion here.\
\>", "Text",
 CellChangeTimes->{{3.722755405221078*^9, 3.7227554690460873`*^9}, {
  3.7227555481656513`*^9, 3.7227555737939453`*^9}, {3.722755847487422*^9, 
  3.7227558726593847`*^9}, {3.722756710895602*^9, 3.722756732988941*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"taylorReplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"H1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Hd0", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "-", "t0"}], ")"}], " ", "Hd1"}]}], ")"}]}], ",", 
     RowBox[{"H1D", "\[Rule]", "Hd1"}], ",", 
     RowBox[{"H1DD", "\[Rule]", "0"}], ",", 
     RowBox[{"H1DDD", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"phi", "\[Rule]", "0"}], ",", 
      RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.720782341021213*^9, 3.720782408514426*^9}, {
   3.7207828174550657`*^9, 3.7207828460226517`*^9}, {3.720782879688923*^9, 
   3.720782957978816*^9}, {3.7207874199364567`*^9, 3.7207874246413527`*^9}, {
   3.721369507318478*^9, 3.7213695447896433`*^9}, {3.721369820304812*^9, 
   3.721369822823305*^9}, 3.7213698643632402`*^9, {3.721384728536125*^9, 
   3.721384731526524*^9}, {3.721640976333373*^9, 3.7216409836755543`*^9}, {
   3.722149326419242*^9, 3.72214935693607*^9}, {3.722149392031625*^9, 
   3.72214939584789*^9}, {3.7222718343025*^9, 3.722271845497401*^9}, {
   3.722271918162076*^9, 3.722271944303186*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hsimple", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Horig", "[", "t", "]"}], "/.", "taylorReplacement"}], "/.", 
   "parameters"}]}]], "Input",
 CellChangeTimes->{{3.720783050759514*^9, 3.720783101982284*^9}, 
   3.7207833240077047`*^9, {3.720783804429677*^9, 3.720783810107931*^9}, {
   3.72214936199796*^9, 3.722149365629217*^9}, {3.722149826031633*^9, 
   3.7221498273903513`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Delta", " ", "sz"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{"Hd0", "+", 
     RowBox[{"Hd1", " ", 
      RowBox[{"(", 
       RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
     RowBox[{"sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.722276309913615*^9, 3.722316893866757*^9, 
  3.722317071508169*^9, 3.722317484697859*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "Hsimple", "]"}]], "Input",
 CellChangeTimes->{{3.720783304920519*^9, 3.720783310933688*^9}, 
   3.7207838071563997`*^9, 3.722149833377084*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Effective Hamiltonians (from Daniel)", "Section",
 CellChangeTimes->{{3.7213912625165873`*^9, 3.721391274414789*^9}, {
  3.7227553824041443`*^9, 3.72275538484443*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"termHww0", "=", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
      RowBox[{"H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"32", " ", "ww"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Delta", " ", "H1", " ", "sx"}], "+", 
         RowBox[{"H1D", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"H1D", " ", "sx"}], "-", 
         RowBox[{"Delta", " ", "H1", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SuperscriptBox["ww", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"8", " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
      RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7213912768379793`*^9, 3.7213913006335983`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"termHww0", "=", 
  RowBox[{"termHww0", "/.", "parameters"}]}], "\[IndentingNewLine]", 
 RowBox[{"termHwwM1", "=", 
  RowBox[{"termHwwM1", "/.", "parameters"}]}], "\[IndentingNewLine]", 
 RowBox[{"termHwwM2", "=", 
  RowBox[{"termHwwM2", "/.", "parameters"}]}]}], "Input",
 CellChangeTimes->{{3.7221514345050793`*^9, 3.722151489585125*^9}, {
  3.722271861712817*^9, 3.7222718652377853`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
    RowBox[{"H1", " ", "sx", " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"H1", " ", "sy", " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.722276309967696*^9, {3.722316882577291*^9, 3.722316897677741*^9}, 
   3.7223170727782784`*^9, 3.7223174861216917`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"32", " ", "ww"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Delta", " ", "H1", " ", "sx"}], "+", 
       RowBox[{"H1D", " ", "sy"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"H1D", " ", "sx"}], "-", 
       RowBox[{"Delta", " ", "H1", " ", "sy"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.722276309967696*^9, {3.722316882577291*^9, 3.722316897677741*^9}, 
   3.7223170727782784`*^9, 3.722317486127068*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "8"}], " ", "Delta", " ", 
     SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"8", " ", "Delta", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
    RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
    RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"3", " ", "phi"}], "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"3", " ", "phi"}], "+", 
       RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
    RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
    RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
    RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"3", " ", "phi"}], "+", 
       RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"3", " ", "phi"}], "+", 
       RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.722276309967696*^9, {3.722316882577291*^9, 3.722316897677741*^9}, 
   3.7223170727782784`*^9, 3.722317486132265*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.7213917280023413`*^9, 3.721391729772744*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Heff", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"termHww0", "+", "termHwwM1", "+", "termHwwM2"}], ")"}], "/.", 
   "taylorReplacement"}]}]], "Input",
 CellChangeTimes->{{3.721391303644435*^9, 3.7213913745294228`*^9}, {
   3.7213917000477457`*^9, 3.7213917011961613`*^9}, {3.721453944575795*^9, 
   3.7214539816917553`*^9}, {3.721454459164365*^9, 3.721454497947255*^9}, {
   3.722149808128591*^9, 3.722149811967021*^9}, {3.722150720936048*^9, 
   3.722150727695092*^9}, 3.722151465569895*^9, {3.7222719286896343`*^9, 
   3.7222719320306396`*^9}, 3.722271976099217*^9, 3.7222723481540422`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
     RowBox[{"sx", " ", 
      RowBox[{"(", 
       RowBox[{"Hd0", "+", 
        RowBox[{"Hd1", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"sy", " ", 
      RowBox[{"(", 
       RowBox[{"Hd0", "+", 
        RowBox[{"Hd1", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", "ww"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sz", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"]}], "-", 
     RowBox[{"2", " ", "sz", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Hd1", " ", "sy"}], "+", 
        RowBox[{"Delta", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Hd1", " ", "sx"}], "-", 
        RowBox[{"Delta", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "8"}], " ", "Delta", " ", "sz", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"]}], "-", 
     RowBox[{"2", " ", "sx", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"8", " ", "Delta", " ", "sz", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", "sx", " ", 
      RowBox[{"(", 
       RowBox[{"Hd0", "+", 
        RowBox[{"Hd1", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "sx", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"sx", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", "sy", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"24", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{"Hd0", "+", 
        RowBox[{"Hd1", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", "sy", " ", 
      RowBox[{"(", 
       RowBox[{"Hd0", "+", 
        RowBox[{"Hd1", " ", 
         RowBox[{"(", 
          RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "sy", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"sy", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.722276310092454*^9, {3.722316882704795*^9, 3.722316897776555*^9}, 
   3.722317072861*^9, 3.7223174862036533`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.72139167843118*^9, 3.721391681812262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion for real Hamiltonian", "Section",
 CellChangeTimes->{{3.72149984456395*^9, 3.721499852290381*^9}, {
  3.7221626431366787`*^9, 3.722162649199335*^9}}],

Cell[BoxData[
 RowBox[{"Remove", "[", "\[CapitalOmega]\[CapitalOmega]simple", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7214719822626133`*^9, 3.7214719896931877`*^9}, {
  3.721472353514744*^9, 3.721472354111644*^9}, {3.721499877011467*^9, 
  3.72149987735284*^9}, {3.721583163400134*^9, 3.721583163642398*^9}, {
  3.721641028958159*^9, 3.721641030924942*^9}, {3.722149838537915*^9, 
  3.722149850484721*^9}, {3.722150373418338*^9, 3.7221503811862926`*^9}, {
  3.7221625841509542`*^9, 3.722162584886582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.721471594711541*^9, 3.721471612498687*^9}, {
   3.72147171132694*^9, 3.7214717650563602`*^9}, {3.721471818875194*^9, 
   3.7214718577305*^9}, {3.721471992456099*^9, 3.7214719926053867`*^9}, {
   3.72147478029744*^9, 3.721474782400672*^9}, {3.721475070506382*^9, 
   3.721475072657221*^9}, {3.7214754970412693`*^9, 3.721475497382984*^9}, {
   3.721481730665987*^9, 3.721481730729863*^9}, {3.7214998793351593`*^9, 
   3.721499879586091*^9}, {3.721583167493902*^9, 3.721583169356577*^9}, 
   3.7215836919134483`*^9, {3.7216252926059504`*^9, 3.721625303081492*^9}, {
   3.721641015366444*^9, 3.7216410342436657`*^9}, 3.7221498543218822`*^9, {
   3.722150249015389*^9, 3.722150249597885*^9}, {3.722150365347493*^9, 
   3.7221503657301064`*^9}, {3.722150826924828*^9, 3.722150827962327*^9}, {
   3.722151143487228*^9, 3.7221511439973087`*^9}, {3.72215139675976*^9, 
   3.722151397413951*^9}, {3.7222436972986317`*^9, 3.722243698478166*^9}, 
   3.7222438058638077`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MI", "=", 
   RowBox[{"JesseGetMagnusIntegrands", "[", 
    RowBox[{"h", ",", "\[CapitalOmega]\[CapitalOmega]simple", ",", "max"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MI", "=", 
   RowBox[{"MI", "/.", 
    RowBox[{"h", "\[Rule]", 
     RowBox[{"Hsimple", "[", "t", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.721471594711541*^9, 3.721471612498687*^9}, {
   3.72147171132694*^9, 3.7214717650563602`*^9}, {3.721471818875194*^9, 
   3.7214718577305*^9}, {3.721471992456099*^9, 3.7214719926053867`*^9}, {
   3.72147478029744*^9, 3.721474782400672*^9}, {3.721475070506382*^9, 
   3.721475072657221*^9}, {3.7214754970412693`*^9, 3.721475497382984*^9}, {
   3.721481730665987*^9, 3.721481730729863*^9}, {3.7214998793351593`*^9, 
   3.721499879586091*^9}, {3.721583167493902*^9, 3.721583169356577*^9}, 
   3.7215836919134483`*^9, {3.7216252926059504`*^9, 3.721625303081492*^9}, {
   3.721641015366444*^9, 3.7216410342436657`*^9}, 3.7221498543218822`*^9, {
   3.722150249015389*^9, 3.722150249597885*^9}, {3.722150365347493*^9, 
   3.7221503657301064`*^9}, {3.722150826924828*^9, 3.722150827962327*^9}, {
   3.722151143487228*^9, 3.7221511439973087`*^9}, {3.72215139675976*^9, 
   3.722151397413951*^9}, {3.7222436972986317`*^9, 3.722243698478166*^9}, 
   3.7222438058638077`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
       RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
      RowBox[{"JesseDoMagnusIntegration", "[", 
       RowBox[{
        RowBox[{"MI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        SubscriptBox["WWeff", "i"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.721499891942844*^9, {3.721583174720359*^9, 3.72158317504136*^9}, {
   3.721583823315545*^9, 3.72158384151307*^9}, {3.721583901018448*^9, 
   3.7215839042305737`*^9}, 3.7216270486445513`*^9, 3.7216410377051992`*^9, 
   3.722149857373662*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "22", ",", "38"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 22, 38}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222763101917953`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "38"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {22, 38}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276310199624*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "38"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {22, 38}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.72227631037531*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "38"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {22, 38}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276311025701*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "38"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {22, 38}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276311037072*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276342171085*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {22, 39}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276342640954*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276344336318*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222763443465223`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "22", ",", "39"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276344829897*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276344840106*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {22, 39}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.72227634791328*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276391968173*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "39"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {22, 39}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222763919800787`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "43"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {22, 43}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276587598506*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "43"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "9"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {22, 43}, "  trimmed coeffs:  ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276593061051*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "44"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {22, 44}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276669347666*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "44"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {22, 44}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276669358158*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "22", ",", "44"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 22, 44}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222766699595623`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "44"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {22, 44}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722276670030644*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"22", ",", "57"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "24"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {22, 57}, "  trimmed coeffs:  ", 
   24],
  Editable->False]], "Print",
 CellChangeTimes->{3.722277473084638*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"23", ",", "56"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {23, 56}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222809898523693`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"23", ",", "56"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {23, 56}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722280989863695*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "45"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {0, 45}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722283932002551*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "47"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "9"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {0, 47}, "  trimmed coeffs:  ", 9],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.722284066505601*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "52"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {0, 52}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222843307710447`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "52"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {0, 52}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722284330782226*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", "/", "tc"}], " ", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
     RowBox[{
      RowBox[{"ta", "+", "tc"}], ",", "ta"}], "]"}]}], "//", "FS"}], "//", 
  "CWW"}]], "Input",
 CellChangeTimes->{{3.721641265824979*^9, 3.721641273206327*^9}, {
   3.721643572709309*^9, 3.721643576643758*^9}, {3.721643630264494*^9, 
   3.721643661719714*^9}, 3.7221502772472057`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", "Delta", " ", "sz"}], "+", 
     RowBox[{"2", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"2", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Hd1", " ", "\[Pi]", " ", "sx", " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
    RowBox[{"Hd1", " ", "\[Pi]", " ", "sy", " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
    RowBox[{"Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", 
       RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}]}], 
   RowBox[{"8", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{3.722284332804064*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]simple"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.721499946855296*^9, 3.721499973780986*^9}, {
   3.721583179773501*^9, 3.721583184528266*^9}, 3.722149725724958*^9, 
   3.7221502705228167`*^9, {3.72215038604436*^9, 3.722150392675001*^9}, {
   3.722160249165916*^9, 3.722160255243806*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hlinbar", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.721499989961666*^9, 3.721499999299775*^9}, {
  3.721535505319736*^9, 3.721535512229414*^9}, {3.7215831887963543`*^9, 
  3.721583193637969*^9}, {3.722150329187159*^9, 3.722150334340963*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"3072", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"384", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "Delta", " ", "sz", " ", "ta", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"4", " ", "Delta", " ", "sz", " ", "tb", " ", 
         SuperscriptBox["ww", "2"]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Hd0"}], "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
        RowBox[{"Hd1", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", "Hd0", " ", "sy", " ", "ta", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"Hd1", " ", "sy", " ", 
         SuperscriptBox["ta", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"2", " ", "Hd0", " ", "sy", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
        RowBox[{"2", " ", "Hd1", " ", "sy", " ", "ta", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"Hd1", " ", "sy", " ", 
         SuperscriptBox["tb", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
        RowBox[{"2", " ", "Hd0", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{"Hd1", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{"Hd1", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"Hd1", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", "Hd0", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"Hd1", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
       ")"}]}]}], "-", 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "Delta", " ", "Hd1", " ", 
        SuperscriptBox["ta", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sy", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
          RowBox[{"sx", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"12", " ", "Delta", " ", "Hd1", " ", 
        SuperscriptBox["ta", "2"], " ", "tb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sy", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
          RowBox[{"sx", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"12", " ", "Delta", " ", "Hd1", " ", "ta", " ", 
        SuperscriptBox["tb", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sy", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
          RowBox[{"sx", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", "Delta", " ", "Hd1", " ", 
        SuperscriptBox["tb", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sy", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
          RowBox[{"sx", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["ww", "2"]], 
        RowBox[{"3", " ", "Hd0", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
           RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["ww", "2"]], 
        RowBox[{"3", " ", "Hd1", " ", "tb", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"6", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"5", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"6", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       "+", 
       RowBox[{
        FractionBox["1", "ww"], 
        RowBox[{"6", " ", "Hd0", " ", "tb", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Hd0"}], " ", "sz"}], "+", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       "-", 
       RowBox[{
        FractionBox["1", "ww"], 
        RowBox[{"6", " ", "Hd1", " ", "ta", " ", "tb", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "Hd0", " ", "sz"}], "+", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       "+", 
       RowBox[{
        FractionBox["1", "ww"], 
        RowBox[{"3", " ", "Hd1", " ", 
         SuperscriptBox["tb", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "Hd0", " ", "sz"}], "+", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       "-", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["ww", "2"]], 
        RowBox[{"3", " ", "Hd1", " ", "ta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
           RowBox[{"4", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
           RowBox[{"Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
           RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["ww", "3"]], 
        RowBox[{"6", " ", "Hd1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}]}], "-", 
       RowBox[{
        FractionBox["1", "ww"], 
        RowBox[{"6", " ", "Hd0", " ", "ta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Hd0"}], " ", "sz"}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}]}], "+", 
       RowBox[{
        FractionBox["1", "ww"], 
        RowBox[{"6", " ", "Hd1", " ", 
         SuperscriptBox["ta", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Hd0"}], " ", "sz"}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
           RowBox[{"2", " ", "Delta", " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "3"]], 
     RowBox[{"Hd0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "96"}], " ", 
         SuperscriptBox["Delta", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "-", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"32", " ", 
            SuperscriptBox["Delta", "2"]}], "+", 
           SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "-", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "-", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
           RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "+", 
        RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"96", " ", 
         SuperscriptBox["Delta", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "-", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"96", " ", 
         SuperscriptBox["Delta", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "-", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "-", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
           RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["ta", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"8", " ", 
               SuperscriptBox["Delta", "2"]}], "+", 
              SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"16", " ", "ta", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"8", " ", 
               SuperscriptBox["Delta", "2"]}], "+", 
              SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["tb", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"8", " ", 
               SuperscriptBox["Delta", "2"]}], "+", 
              SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}], "-", 
        RowBox[{"2", " ", "tb", " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz"}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
           RowBox[{"16", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}],
            "-", 
           RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["Delta", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["Delta", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "-", 
              RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
           RowBox[{"48", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"48", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "-", 
              RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"ta", " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"72", " ", "Delta", " ", "Hd0", " ", "sz"}], "+", 
           RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "+", 
               RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}], "2"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"16", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"96", " ", 
            SuperscriptBox["Delta", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"30", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "phi", "]"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "phi"}], "]"}]}], "-", 
           RowBox[{"24", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
           RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], "2"],
             " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "2"]}], 
           "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"phi", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], "2"],
             " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "2"]}], 
           "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"96", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"24", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"96", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"phi", "+", 
               RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"12", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
           RowBox[{"96", " ", 
            SuperscriptBox["Delta", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "phi", "]"}], "2"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "phi"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"24", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "2"], 
            " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"phi", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], 
             "2"]}], "+", 
           RowBox[{"24", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["Delta", "2"], " ", "sx"}], "-", 
              RowBox[{
               SuperscriptBox["Hd0", "2"], " ", "sx"}], "+", 
              RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}],
              ")"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
            RowBox[{"Sin", "[", "phi", "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], ")"}]}], 
             "]"}]}], "+", 
           RowBox[{"Hd0", " ", 
            RowBox[{"Cos", "[", "phi", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"30", " ", "Hd0", " ", "sx"}], "-", 
              RowBox[{"48", " ", "Delta", " ", "sz", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
              RowBox[{"3", " ", "Hd0", " ", "sx", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"2", " ", "phi"}], "+", 
                 RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
              RowBox[{"32", " ", "Delta", " ", "sz", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
              RowBox[{"6", " ", "Hd0", " ", "sy", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
              RowBox[{"24", " ", "Hd0", " ", "sy", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"phi", "+", 
                   RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
              RowBox[{"2", " ", "Hd0", " ", "sy", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"2", " ", "phi"}], "+", 
                 RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
              RowBox[{"12", " ", "Hd0", " ", "sy", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"phi", "+", 
                   RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
              RowBox[{"Hd0", " ", "sy", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"2", " ", "phi"}], "+", 
                 RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
              RowBox[{"8", " ", "Hd0", " ", "sx", " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "2"],
                " ", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 RowBox[{"phi", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], 
                "2"]}], "-", 
              RowBox[{"2", " ", "Hd0", " ", "sy", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"phi", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], ")"}]}], 
                "]"}]}]}], ")"}]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"3", " ", "phi"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}]}], ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.722286159404701*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Hlinbar"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721499995856163*^9, 3.721500001564535*^9}, {
   3.721583205626096*^9, 3.721583224744295*^9}, {3.721583259957012*^9, 
   3.721583260242675*^9}, 3.722149728125202*^9, {3.7221503373302927`*^9, 
   3.722150339218555*^9}, {3.7221503965733967`*^9, 3.7221504006992083`*^9}, {
   3.722160258549572*^9, 3.722160262464308*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
        RowBox[{"tb", ",", "ta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.722173497816763*^9, 3.722173504817401*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "3072"], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["ww", "2"]], 
       RowBox[{"384", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", "Delta", " ", "sz", " ", "ta", " ", 
           SuperscriptBox["ww", "2"]}], "+", 
          RowBox[{"4", " ", "Delta", " ", "sz", " ", "tb", " ", 
           SuperscriptBox["ww", "2"]}], "+", 
          RowBox[{"sx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "Hd0"}], "+", 
             RowBox[{"Hd1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"Hd1", " ", "sy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "Hd0", " ", "sy", " ", "ta", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
          RowBox[{"Hd1", " ", "sy", " ", 
           SuperscriptBox["ta", "2"], " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
          RowBox[{"2", " ", "Hd0", " ", "sy", " ", "tb", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
          RowBox[{"2", " ", "Hd1", " ", "sy", " ", "ta", " ", "tb", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
          RowBox[{"Hd1", " ", "sy", " ", 
           SuperscriptBox["tb", "2"], " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
          RowBox[{"2", " ", "Hd0", " ", "sx", " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
          RowBox[{"Hd1", " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
          "-", 
          RowBox[{"Hd1", " ", "sx", " ", "ta", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"Hd1", " ", "sx", " ", "tb", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", "Hd0", " ", "sy", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
          
          RowBox[{"Hd1", " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], 
           " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
         ")"}]}]}], "-", 
      RowBox[{"16", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "Delta", " ", "Hd1", " ", 
          SuperscriptBox["ta", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sy", " ", 
             RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
            RowBox[{"sx", " ", 
             RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"12", " ", "Delta", " ", "Hd1", " ", 
          SuperscriptBox["ta", "2"], " ", "tb", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sy", " ", 
             RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
            RowBox[{"sx", " ", 
             RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "-", 
         RowBox[{"12", " ", "Delta", " ", "Hd1", " ", "ta", " ", 
          SuperscriptBox["tb", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sy", " ", 
             RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
            RowBox[{"sx", " ", 
             RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
         RowBox[{"4", " ", "Delta", " ", "Hd1", " ", 
          SuperscriptBox["tb", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sy", " ", 
             RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
            RowBox[{"sx", " ", 
             RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "-", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ww", "2"]], 
          RowBox[{"3", " ", "Hd0", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
             
             RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
         "+", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ww", "2"]], 
          RowBox[{"3", " ", "Hd1", " ", "tb", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"6", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
             
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"5", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"6", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
         "+", 
         RowBox[{
          FractionBox["1", "ww"], 
          RowBox[{"6", " ", "Hd0", " ", "tb", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Hd0"}], " ", "sz"}], "+", 
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"2", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"2", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
         "-", 
         RowBox[{
          FractionBox["1", "ww"], 
          RowBox[{"6", " ", "Hd1", " ", "ta", " ", "tb", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Hd0", " ", "sz"}], "+", 
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
         "+", 
         RowBox[{
          FractionBox["1", "ww"], 
          RowBox[{"3", " ", "Hd1", " ", 
           SuperscriptBox["tb", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Hd0", " ", "sz"}], "+", 
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
         "-", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ww", "2"]], 
          RowBox[{"3", " ", "Hd1", " ", "ta", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
             
             RowBox[{"4", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
             
             RowBox[{"Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
             
             RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ww", "3"]], 
          RowBox[{"6", " ", "Hd1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", "ww"], 
          RowBox[{"6", " ", "Hd0", " ", "ta", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Hd0"}], " ", "sz"}], "+", 
             RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
             
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "ww"], 
          RowBox[{"6", " ", "Hd1", " ", 
           SuperscriptBox["ta", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Hd0"}], " ", "sz"}], "+", 
             RowBox[{"2", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"2", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
             
             RowBox[{"2", " ", "Delta", " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", "Delta", " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"3", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["ww", "3"]], 
       RowBox[{"Hd0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "96"}], " ", 
           SuperscriptBox["Delta", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"12", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"4", " ", "ta", " ", "ww"}], "-", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"32", " ", 
              SuperscriptBox["Delta", "2"]}], "+", 
             SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"6", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "-", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "-", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
             RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
          "+", 
          RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "+", 
               RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"96", " ", 
           SuperscriptBox["Delta", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"6", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"4", " ", "ta", " ", "ww"}], "-", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "+", 
               RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"96", " ", 
           SuperscriptBox["Delta", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{"12", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "-", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"3", " ", "phi"}], "+", 
             RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "-", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
             RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"8", " ", 
           SuperscriptBox["ta", "2"], " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["Delta", "2"]}], "+", 
                SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"16", " ", "ta", " ", "tb", " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["Delta", "2"]}], "+", 
                SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["tb", "2"], " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"8", " ", 
                 SuperscriptBox["Delta", "2"]}], "+", 
                SuperscriptBox["Hd0", "2"]}], ")"}], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}], "-", 
          RowBox[{"2", " ", "tb", " ", "ww", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz"}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
             RowBox[{"16", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], 
               "]"}]}], "-", 
             RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"48", " ", 
              SuperscriptBox["Delta", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"48", " ", 
              SuperscriptBox["Delta", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "-", 
                RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
             RowBox[{"48", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"48", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "-", 
                RowBox[{"2", " ", "ta", " ", "ww"}], "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"ta", " ", "ww", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"72", " ", "Delta", " ", "Hd0", " ", "sz"}], "+", 
             RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}], "2"]}], "+", 
             RowBox[{"12", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"16", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
             RowBox[{"96", " ", 
              SuperscriptBox["Delta", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"30", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "phi", "]"}], "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "phi"}], "]"}]}], "-", 
             RowBox[{"24", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
             
             RowBox[{"48", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
             
             RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], 
               "2"], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], 
               "2"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], 
               "2"], " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], 
               "2"]}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
             
             RowBox[{"24", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"96", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"24", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"48", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"96", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"24", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}], "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"12", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"12", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
             RowBox[{"96", " ", 
              SuperscriptBox["Delta", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "phi", "]"}], "2"], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "phi"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"2", " ", "phi"}], "+", 
                RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
             RowBox[{"24", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"48", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"phi", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], 
             "+", 
             RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "2"], 
              " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"phi", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], 
               "2"]}], "+", 
             RowBox[{"24", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"phi", "+", 
                RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["Delta", "2"], " ", "sx"}], "-", 
                RowBox[{
                 SuperscriptBox["Hd0", "2"], " ", "sx"}], "+", 
                RowBox[{"4", " ", "Delta", " ", "Hd0", " ", "sz", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"phi", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], 
                  "]"}]}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sx", " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"phi", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], ")"}]}], 
               "]"}]}], "+", 
             RowBox[{"Hd0", " ", 
              RowBox[{"Cos", "[", "phi", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"30", " ", "Hd0", " ", "sx"}], "-", 
                RowBox[{"48", " ", "Delta", " ", "sz", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"phi", "+", 
                   RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
                RowBox[{"3", " ", "Hd0", " ", "sx", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"2", " ", "phi"}], "+", 
                   RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
                RowBox[{"32", " ", "Delta", " ", "sz", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"phi", "+", 
                   RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
                RowBox[{"6", " ", "Hd0", " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
                "-", 
                RowBox[{"24", " ", "Hd0", " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"phi", "+", 
                    RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
                RowBox[{"2", " ", "Hd0", " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"2", " ", "phi"}], "+", 
                   RowBox[{"4", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
                RowBox[{"12", " ", "Hd0", " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"phi", "+", 
                    RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
                RowBox[{"Hd0", " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"2", " ", "phi"}], "+", 
                   RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
                RowBox[{"8", " ", "Hd0", " ", "sx", " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], 
                  "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{"phi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], 
                  "2"]}], "-", 
                RowBox[{"2", " ", "Hd0", " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"phi", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], ")"}]}], 
                  "]"}]}]}], ")"}]}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["Hd0", "2"], " ", "sy", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"3", " ", "phi"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
            ")"}]}]}], ")"}]}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.722287545568653*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]realsum"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.722319061925902*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion for effective Hamiltonian", "Section",
 CellChangeTimes->{{3.722162662772456*^9, 3.722162681096442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\[CapitalOmega]\[CapitalOmega]eff", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722162683579185*^9, 3.7221627113242483`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MI", "=", 
   RowBox[{"JesseGetMagnusIntegrands", "[", 
    RowBox[{"h", ",", "\[CapitalOmega]\[CapitalOmega]eff", ",", "max"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MI", "=", 
   RowBox[{"MI", "/.", 
    RowBox[{"h", "\[Rule]", 
     RowBox[{"Heff", "[", "t", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722162714722845*^9, 3.7221627508366327`*^9}, {
  3.722316912369532*^9, 3.7223169131044827`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
       RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
      RowBox[{"JesseDoMagnusIntegration", "[", 
       RowBox[{
        RowBox[{"MI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        SubscriptBox["WWeff", "i"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.7221627329169493`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "15", ",", "10", ",", "4"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 15, 10, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317499482006*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "4"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317499489161*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "7"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 5}, "  trimmed coeffs:  ", 7],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317503250277*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317536593638*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317536603798*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317560140294*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "7"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 6}, "  trimmed coeffs:  ", 7],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.72231756144769*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.7223175900615883`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.72231759006888*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "15", ",", "10", ",", "6"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 15, 10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.7223175960492277`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317596056518*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "31"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 6}, "  trimmed coeffs:  ", 31],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317598619282*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317604436414*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.7223176044435463`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317609193407*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "4"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 6}, "  trimmed coeffs:  ", 4],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317609276599*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317609465906*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317609471661*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "15", ",", "10", ",", "6"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 15, 10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.7223176155098248`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317615923924*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "33"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 7}, "  trimmed coeffs:  ", 33],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.7223176282885027`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.72231762829608*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317628304528*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317628366274*^9}],

Cell[BoxData["\<\"    > starting trim with empty coefficient list\"\>"], \
"Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317628372835*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 7}, "  trimmed coeffs:  ", 0],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317628378882*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.72231762838477*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "7"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722287545916048*^9, 3.7223169150737133`*^9, 
  3.72231708587204*^9, 3.722317628390604*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]eff"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.722162789261259*^9, 3.7221627894681168`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", "/", "tc"}], " ", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
     RowBox[{
      RowBox[{"ta", "+", "tc"}], ",", "ta"}], "]"}]}], "//", "FS"}], "//", 
  "CWW"}]], "Input",
 CellChangeTimes->{{3.722162832046605*^9, 3.722162832325976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "256"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"128", " ", "Delta", " ", "sz"}], "+", 
     RowBox[{"64", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"64", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", "ww"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
     RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"32", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"32", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "8"}], " ", "Delta", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
     RowBox[{"8", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"8", " ", "Delta", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"16", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", "Delta", " ", "Hd1", " ", "\[Pi]", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", "Hd1", " ", "\[Pi]", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7223176407846537`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hlineffbar", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.72216280735779*^9, 3.722162812191296*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "768"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "16"}], " ", "Delta", " ", "Hd1", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sy", " ", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
       RowBox[{"sx", " ", 
        RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Delta"}], " ", 
            SuperscriptBox["Hd0", "2"]}], "+", 
           RowBox[{"Hd0", " ", 
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            "ww"}], "+", 
           RowBox[{"16", " ", "Delta", " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Hd0", "3"], "-", 
           RowBox[{"16", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
        RowBox[{"8", " ", "Hd0", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Delta", " ", "Hd0"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"32", " ", "Hd1", " ", "sy", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sx", " ", "ta", " ", "ww", " ", 
         
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sx", " ", "tb", " ", "ww", " ", 
         
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"64", " ", "Hd0", " ", "sy", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
        RowBox[{"32", " ", "Hd1", " ", "sy", " ", "ta", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"32", " ", "Hd1", " ", "sy", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"32", " ", "Hd1", " ", "sx", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sy", " ", "ta", " ", "ww", " ", 
         
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sy", " ", "tb", " ", "ww", " ", 
         
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7223176652060757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Hlineffbar"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
        RowBox[{"tb", ",", "ta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", 
   "S"}]}]}], "Input",
 CellChangeTimes->{
  3.722162821039257*^9, {3.7221734342700043`*^9, 3.7221734711991568`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "768"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", "Delta", " ", "Hd1", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sy", " ", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
       RowBox[{"sx", " ", 
        RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Delta"}], " ", 
            SuperscriptBox["Hd0", "2"]}], "+", 
           RowBox[{"Hd0", " ", 
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            "ww"}], "+", 
           RowBox[{"16", " ", "Delta", " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Hd0", "3"], "-", 
           RowBox[{"16", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
        RowBox[{"8", " ", "Hd0", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Delta", " ", "Hd0"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"32", " ", "Hd1", " ", "sy", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sx", " ", "ta", " ", "ww", " ", 
         
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sx", " ", "tb", " ", "ww", " ", 
         
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"64", " ", "Hd0", " ", "sy", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
        RowBox[{"32", " ", "Hd1", " ", "sy", " ", "ta", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"32", " ", "Hd1", " ", "sy", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "Hd1", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"32", " ", "Hd1", " ", "sx", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "Hd0", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sy", " ", "ta", " ", "ww", " ", 
         
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
        RowBox[{
        "16", " ", "Delta", " ", "Hd1", " ", "sy", " ", "tb", " ", "ww", " ", 
         
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.722317665341209*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]effsum"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7222437063727922`*^9, 3.7222437170699797`*^9}, {
  3.722319079344441*^9, 3.7223190825107737`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load results", "Section",
 CellChangeTimes->{{3.7222437418447638`*^9, 3.72224374667692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reload", "=", "True"}], ";"}]], "Input",
 CellChangeTimes->{{3.722318001668429*^9, 3.7223180038827047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"reload", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Get", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"max", "=", "3"}], ";", 
     RowBox[{
      RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
       RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Plus", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
            RowBox[{"tb", ",", "ta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", "S"}]}],
      ";"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
       RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Plus", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
            RowBox[{"tb", ",", "ta"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", "S"}]}],
      ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.722243747785515*^9, 3.722243759334203*^9}, {
   3.7222468243855333`*^9, 3.7222468269445267`*^9}, {3.7222720674758472`*^9, 
   3.722272111578216*^9}, 3.722318035370583*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking results", "Section",
 CellChangeTimes->{{3.7213922110718603`*^9, 3.7213922150841417`*^9}, {
  3.721392917805194*^9, 3.7213929303153143`*^9}, {3.722151071374181*^9, 
  3.722151077938756*^9}}],

Cell["\<\
The finite-order Magnus expansion of the real Hamiltonian and of the \
effective Hamiltonian should be equal if evaluated over a complete interval \
t_c, as per the definition of Heff. Let\[CloseCurlyQuote]s check that!\
\>", "Text",
 CellChangeTimes->{{3.722755606100995*^9, 3.7227556485000753`*^9}, {
  3.722755753393816*^9, 3.722755811193165*^9}, {3.7227559049655247`*^9, 
  3.722755909252947*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hlinbar", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "FS"}], "//", 
   "CWW"}]}]], "Input",
 CellChangeTimes->{{3.7221510798933992`*^9, 3.722151106347843*^9}, {
  3.7221512958929567`*^9, 3.7221512977393*^9}, {3.722163173961741*^9, 
  3.7221631750883703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "768"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"384", " ", "Delta", " ", "sz"}], "+", 
     RowBox[{"192", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"192", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"768", " ", "ww"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"24", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "\[Pi]", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", "Delta", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "\[Pi]", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"768", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "24"}], " ", "Delta", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", "Hd1", " ", 
      SuperscriptBox["\[Pi]", "2"], " ", "sy", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"24", " ", "Delta", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"48", " ", "Delta", " ", "Hd1", " ", "\[Pi]", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", "Delta", " ", "Hd1", " ", 
      SuperscriptBox["\[Pi]", "2"], " ", "sx", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"72", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"48", " ", 
      SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", "Delta", " ", "Hd1", " ", "\[Pi]", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "t0", " ", "ww"}]}], "]"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.722319528645644*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hlineffbar", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "FS"}], "//", 
   "CWW"}]}]], "Input",
 CellChangeTimes->{{3.7221631279601*^9, 3.722163128182786*^9}, {
  3.722163178843224*^9, 3.722163180297141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "768"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"384", " ", "Delta", " ", "sz"}], "+", 
     RowBox[{"192", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"192", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"768", " ", "ww"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"24", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "\[Pi]", " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", "Delta", " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "\[Pi]", " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"96", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"768", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "24"}], " ", "Delta", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", "Hd1", " ", 
      SuperscriptBox["\[Pi]", "2"], " ", "sy", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"24", " ", "Delta", " ", 
      SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"48", " ", "Delta", " ", "Hd1", " ", "\[Pi]", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", "Hd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", "Delta", " ", "Hd1", " ", 
      SuperscriptBox["\[Pi]", "2"], " ", "sx", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
     RowBox[{"72", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", "Hd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"48", " ", 
      SuperscriptBox["Delta", "2"], " ", "Hd0", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", "Delta", " ", "Hd1", " ", "\[Pi]", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.722319557556662*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"test2", "-", "test1"}], "/.", 
   RowBox[{"{", 
    RowBox[{"t0", "\[Rule]", 
     RowBox[{"\[Alpha]0", "/", "ww"}]}], "}"}]}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7221631861997843`*^9, 3.722163215569655*^9}, {
  3.722319592573617*^9, 3.7223195929954777`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722319557739662*^9, 3.722319593206121*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jump operators", "Section",
 CellChangeTimes->{{3.72216218339668*^9, 3.722162197273571*^9}}],

Cell[TextData[{
 "We consider the case of a jump in the driving envelope at time tj between \
one linear drive envelope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]]],
 " for t < tj and another linear drive envelope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]]],
 " for t > tj. We allow for discontinuities in both the envelope value and \
the first derivative. We Taylor expand the driving envelopes around tj. The \
relevant parameters describing the drive envelope are then \n\nt < tj\t\t\t\t\
t > tj\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]]],
 "(tj)\t\tEmd0\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]]],
 "(tj)\t\tEpd0\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "t"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]]],
 "(tj)\t\tEmd1\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "t"], TraditionalForm]]],
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]]],
 "(tj)\t\tEpd1\n\nRelevant time evolution operators (in exponent form):\nA\t\
Hmeff(tj) -> Heffm(t0+ktc)\nB\tHmreal(t0+ktc) -> Hmreal(tj)\nC\tHpreal(tj) -> \
Hpreal(t0+(k+1)tc)\nD\tHpeff(t0+(k+1)tc) -> Hpeff(tj)\n\nWe calculate the \
relevant Magnus exponents with tj as the starting time (and thus as the \
\[OpenCurlyDoubleQuote]Taylor expansion anchor time\[CloseCurlyDoubleQuote]). \
In case we need to evolve in the opposite time direction (i.e. tj as final \
time), we just multiply the exponent by -1 to reverse time evolution. We plug \
in dimensionless \[Alpha]0 and \[Alpha]j already to be able to fairly compare \
1/ww orders."
}], "Text",
 CellChangeTimes->{{3.722162201642559*^9, 3.722162368367354*^9}, {
  3.7221625236287193`*^9, 3.722162571485042*^9}, {3.7221632329004307`*^9, 
  3.722163344159778*^9}, {3.722164504325034*^9, 3.722164525651071*^9}, {
  3.722165000148678*^9, 3.722165060739952*^9}, {3.722165119451817*^9, 
  3.722165304643661*^9}, {3.7221662505640697`*^9, 3.7221662885776577`*^9}, {
  3.722755941998165*^9, 3.72275599708698*^9}, {3.722756313235094*^9, 
  3.7227563752823257`*^9}, {3.722757018359682*^9, 3.722757034469862*^9}, {
  3.72275707396947*^9, 3.722757156793379*^9}, {3.7227572186685247`*^9, 
  3.722757225363523*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]A", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
       RowBox[{"t0", ",", "tj"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", "\[Rule]", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
        RowBox[{"tj", "\[Rule]", 
         RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hd0", "\[Rule]", "Emd0"}], ",", 
       RowBox[{"Hd1", "\[Rule]", "Emd1"}]}], "}"}]}], "//", "FS"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722165346513688*^9, 3.722165366270275*^9}, {
  3.722166146415406*^9, 3.722166171590048*^9}, {3.722166241552552*^9, 
  3.722166245080381*^9}, {3.722166301916195*^9, 3.722166302417989*^9}, {
  3.722167052649054*^9, 3.722167074665103*^9}, {3.722167632951058*^9, 
  3.7221676410180883`*^9}, {3.722168725842442*^9, 3.722168727553561*^9}, {
  3.72217372443112*^9, 3.722173769639975*^9}, {3.722243983865851*^9, 
  3.7222440297930927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]B", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
       RowBox[{"t0", ",", "tj"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t0", "\[Rule]", 
        RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
       RowBox[{"tj", "\[Rule]", 
        RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Hd0", "\[Rule]", "Emd0"}], ",", 
      RowBox[{"Hd1", "\[Rule]", "Emd1"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.722166425224987*^9, 3.722166447722316*^9}, {
   3.722167000945086*^9, 3.722167009689746*^9}, {3.722167078169743*^9, 
   3.722167091193595*^9}, 3.7221676463817177`*^9, {3.72216769034193*^9, 
   3.72216771103909*^9}, {3.722173781768188*^9, 3.72217380423955*^9}, {
   3.7222440077608547`*^9, 3.722244033052853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]C", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
       RowBox[{
        RowBox[{"t0", "+", "tc"}], ",", "tj"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", "\[Rule]", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
        RowBox[{"tj", "\[Rule]", 
         RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hd0", "\[Rule]", "Epd0"}], ",", 
       RowBox[{"Hd1", "\[Rule]", "Epd1"}]}], "}"}]}], "//", "S"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722167019705962*^9, 3.722167032424327*^9}, {
   3.7221673901970463`*^9, 3.7221674359406357`*^9}, 3.722167647628875*^9, 
   3.722173836812299*^9, {3.722244009630838*^9, 3.722244037569263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]D", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
        RowBox[{
         RowBox[{"t0", "+", "tc"}], ",", "tj"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", "\[Rule]", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
        RowBox[{"tj", "\[Rule]", 
         RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hd0", "\[Rule]", "Epd0"}], ",", 
       RowBox[{"Hd1", "\[Rule]", "Epd1"}]}], "}"}]}], "//", "FS"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722167800464551*^9, 3.722167881986027*^9}, {
  3.722173871685955*^9, 3.722173879242647*^9}, {3.722244011622781*^9, 
  3.722244039801837*^9}}],

Cell["\<\
Intermezzo: let\[CloseCurlyQuote]s look at the 1/ww^0 terms of these terms \
and check if they correspond to the rotating wave approximation of the \
problem. In particular, the sum of all these coefficients should come out to \
zero in the RWA.\
\>", "Text",
 CellChangeTimes->{{3.7221683156712313`*^9, 3.722168382826825*^9}, {
  3.72216846800807*^9, 3.7221684680541477`*^9}, {3.7221687909478273`*^9, 
  3.722168822530778*^9}, {3.722319722241027*^9, 3.722319723119501*^9}, {
  3.7227563907717237`*^9, 3.7227563913384743`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ww0A", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]A", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0B", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]B", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0C", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]C", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0D", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]D", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7221684766451597`*^9, 3.7221685168557587`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722320173379488*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7223201734627037`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7223201734683247`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722320173474272*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ww0A", "+", "ww0B", "+", "ww0C", "+", "ww0D"}], "//", 
  "FS"}]], "Input",
 CellChangeTimes->{{3.7221684948786907`*^9, 3.722168495038825*^9}, {
  3.722168691833044*^9, 3.722168702358116*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722320173528493*^9}]
}, Open  ]],

Cell["\<\
I see, they are all zero. Does this make sense? The 1/ww case is more or less \
exact if ww -> infinity, but then tc -> 0 and the effective and real \
trajectories have coincidence points everywhere, so tj will get vanishingly \
close to the closest coincidence point. Then any jumps get vanishingly small.\
\
\>", "Text",
 CellChangeTimes->{{3.7227567554635477`*^9, 3.722756992372966*^9}}],

Cell["\<\
Now, we\[CloseCurlyQuote]re interested in calculating
exp[D] exp[C] exp[B] exp[A]
up to the order 1/ww^k using the BCH formula.

In each intermediate step, we weed out the higher-order 1/ww terms to speed \
up the calculation\
\>", "Text",
 CellChangeTimes->{{3.722168152176427*^9, 3.722168185835939*^9}, {
  3.7221682195011463`*^9, 3.722168244397887*^9}, {3.722169010340488*^9, 
  3.722169014097417*^9}, {3.722756406451687*^9, 3.7227564430039988`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"jumpOrder", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factors", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[CapitalOmega]D", ",", "\[CapitalOmega]C", ",", "\[CapitalOmega]B", ",",
      "\[CapitalOmega]A"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722234457236*^9, 3.722234490304687*^9}, {
  3.7222440518004637`*^9, 3.7222441552504063`*^9}, {3.722244489831881*^9, 
  3.722244546951318*^9}, {3.722244603458599*^9, 3.722244604353558*^9}, {
  3.7222448689571257`*^9, 3.722244918998105*^9}, {3.722244949648678*^9, 
  3.72224503118594*^9}, {3.7222461068384867`*^9, 3.722246137817358*^9}, {
  3.722246547217857*^9, 3.722246547542665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Calculate", " ", "C", " ", "in", " ", 
     RowBox[{"exp", "[", "A", "]"}], 
     RowBox[{"exp", "[", "B", "]"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"exp", "[", "C", "]"}], ".", " ", "Weed"}], " ", "out", " ", 
     "higher", " ", "order", " ", 
     RowBox[{"1", "/", "ww"}], " ", "terms", "\[IndentingNewLine]", "to", " ",
      "keep", " ", "the", " ", "calculation", " ", "tractable"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"combineExponent", "[", 
     RowBox[{"A_", ",", "B_", ",", "o_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "=", 
        RowBox[{"BCHFormula", "[", 
         RowBox[{"A", ",", "B", ",", "o"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BCH formule up to order \>\"", ",", "o", ",", 
         "\"\<, done:  \>\"", ",", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"JesseGrim", "[", 
         RowBox[{"result", ",", 
          RowBox[{"{", 
           RowBox[{"1", "/", "ww"}], "}"}], ",", "o", ",", "Simplify", ",", 
          "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Trimming done:  \>\"", ",", " ", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.722245270369453*^9, 3.722245274010118*^9}, {
  3.722245526995511*^9, 3.7222457355529337`*^9}, {3.722247382138583*^9, 
  3.722247406354499*^9}, {3.7227564574939003`*^9, 3.722756534022931*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Multiply", " ", "the", " ", "factors", " ", 
    RowBox[{"together", "!"}], " ", "Keep", " ", "track", " ", "of", " ", 
    "the", " ", "intermediate", " ", "products", " ", "in", " ", 
    "intmProduct"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"intmProduct", "[", "1", "]"}], "=", 
     RowBox[{"First", "[", "factors", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"idx", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"factorsToGo", "=", 
     RowBox[{"Rest", "[", "factors", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "factorsToGo", "]"}], ">", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Working on \>\"", ",", "idx"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nextFactor", "=", 
        RowBox[{"First", "[", "factorsToGo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"factorsToGo", "=", 
        RowBox[{"Rest", "[", "factorsToGo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"intmProduct", "[", 
         RowBox[{"idx", "+", "1"}], "]"}], "=", 
        RowBox[{"combineExponent", "[", 
         RowBox[{
          RowBox[{"intmProduct", "[", "idx", "]"}], ",", "nextFactor", ",", 
          "jumpOrder"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"idx", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"finalProduct", "=", 
     RowBox[{"intmProduct", "[", "idx", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.722234457236*^9, 3.722234490304687*^9}, {
  3.7222440518004637`*^9, 3.7222441552504063`*^9}, {3.722244489831881*^9, 
  3.722244546951318*^9}, {3.722244603458599*^9, 3.722244604353558*^9}, {
  3.7222448689571257`*^9, 3.722244918998105*^9}, {3.722244949648678*^9, 
  3.722245012177392*^9}, {3.722246175298983*^9, 3.722246208257749*^9}, {
  3.7222462436932583`*^9, 3.72224625238801*^9}, {3.722246285635899*^9, 
  3.722246360303728*^9}, {3.722246393458109*^9, 3.7222465446850557`*^9}, {
  3.722247167950688*^9, 3.722247168630262*^9}, {3.72224723378367*^9, 
  3.722247244524581*^9}, {3.7222473207764807`*^9, 3.72224732735128*^9}, {
  3.722756550809424*^9, 3.722756557135468*^9}, {3.722756631237938*^9, 
  3.722756656698741*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working on \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Working on ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320173636278*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BCH formule up to order \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["BCH formule up to order ", 2, ", done:  ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7223202194705677`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 50}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.72232022475308*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320224807918*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["Trimming done:  ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7223202248344517`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working on \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Working on ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320224852901*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BCH formule up to order \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["BCH formule up to order ", 2, ", done:  ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7223202276822443`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 50}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.7223202522219276`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320252229488*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["Trimming done:  ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320252237159*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working on \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Working on ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.7223202522447863`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BCH formule up to order \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["BCH formule up to order ", 2, ", done:  ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.7223202532605247`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 50}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320255881177*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320255888843*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "50"}], "}"}]}],
  SequenceForm["Trimming done:  ", {10, 50}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722320255896077*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jlin", "=", "finalProduct"}]], "Input",
 CellChangeTimes->{{3.7221746694512987`*^9, 3.722174673641407*^9}, {
  3.722235173023079*^9, 3.722235173430215*^9}, {3.722247312937896*^9, 
  3.722247334870063*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}], 
   RowBox[{"4", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Emd0", "2"], "-", 
          SuperscriptBox["Epd0", "2"]}], ")"}]}], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Delta", " ", 
          RowBox[{"(", 
           RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", "sx"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["Epd0", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"4", " ", "Emd1", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Epd1", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Delta", " ", "Emd0", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Delta", " ", "Epd0", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.722320255989168*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Jlin"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7222721631335793`*^9, 3.7222721637760353`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jlin", "//", "CWW"}]], "Input",
 CellChangeTimes->{{3.722174742800955*^9, 3.722174746429471*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}], 
   RowBox[{"4", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Emd0", "2"], "-", 
          SuperscriptBox["Epd0", "2"]}], ")"}]}], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Delta", " ", 
          RowBox[{"(", 
           RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", "sx"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["Epd0", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"4", " ", "Emd1", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Epd1", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Delta", " ", "Emd0", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Delta", " ", "Epd0", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.722320256063151*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722247461431122*^9, 3.72224746958881*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722320256127357*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722174801258543*^9, 3.722174825950988*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7223202567670603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7222474332200203`*^9, 3.722247433547275*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "32"]}], " ", "\[ImaginaryI]", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Delta", " ", 
           RowBox[{"(", 
            RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", "sx"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", "sy"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["Emd0", "2"]}], "+", 
          SuperscriptBox["Epd0", "2"]}], ")"}], " ", "sz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
         "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", "sx"}], "+", 
          RowBox[{"Delta", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Emd0"}], "+", "Epd0"}], ")"}], " ", "sy"}]}], 
         ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7223202874090147`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results for order 2", "Section",
 CellChangeTimes->{{3.7222474758766603`*^9, 3.722247481636539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"compatRepl", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Emd0", "\[Rule]", "HA"}], ",", 
     RowBox[{"Epd0", "\[Rule]", "HB"}], ",", 
     RowBox[{"Emd1", "\[Rule]", "HAD"}], ",", 
     RowBox[{"Epd1", "\[Rule]", "HBD"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.722321116329794*^9, 3.722321142220797*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722247461431122*^9, 3.72224746958881*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0", "/.", "compatRepl"}]], "Input",
 CellChangeTimes->{{3.722247485717783*^9, 3.722247486420767*^9}, {
  3.722321161846408*^9, 3.722321162102404*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722321163046167*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722174801258543*^9, 3.722174825950988*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}], "/.", 
  "compatRepl"}]], "Input",
 CellChangeTimes->{{3.722247487612586*^9, 3.7222474880048923`*^9}, {
  3.722321164646351*^9, 3.7223211694536953`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"HA", "-", "HB"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.722321169869608*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7222474332200203`*^9, 3.722247433547275*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Alpha]0", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Alpha]j", "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Alpha]j", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}], "/.", "compatRepl"}]], "Input",
 CellChangeTimes->{{3.722247490580701*^9, 3.722247491181348*^9}, {
  3.722321173126912*^9, 3.722321173742795*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"HA", "-", "HB"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"HA", "+", "HB"}], ")"}], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]0", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Alpha]j", "]"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]j", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"HAD", "-", "HBD"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sy", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
       RowBox[{"sx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.722321173998763*^9}]
}, Open  ]],

Cell["And for general \[CapitalDelta], \[Phi]", "Text",
 CellChangeTimes->{{3.7223210076285048`*^9, 3.722321010416445*^9}, {
  3.722321044241514*^9, 3.722321050425859*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722247461431122*^9, 3.72224746958881*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0", "/.", "compatRepl"}]], "Input",
 CellChangeTimes->{{3.722321058307577*^9, 3.7223210590979147`*^9}, {
  3.7223211782568893`*^9, 3.7223211784548693`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722321223527562*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722174801258543*^9, 3.722174825950988*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
    ")"}]}], "/.", "compatRepl"}]], "Input",
 CellChangeTimes->{{3.722321060274021*^9, 3.722321060914467*^9}, {
  3.722321225160228*^9, 3.722321225416401*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"HA", "-", "HB"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.722321226024757*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7222474332200203`*^9, 3.722247433547275*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "32"]}], " ", "\[ImaginaryI]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Delta", " ", 
            RowBox[{"(", 
             RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", "sx"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", "sy"}]}], ")"}], " ", 
         
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["Emd0", "2"]}], "+", 
           SuperscriptBox["Epd0", "2"]}], ")"}], " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
          "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", "sx"}], "+", 
           RowBox[{"Delta", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Emd0"}], "+", "Epd0"}], ")"}], " ", "sy"}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
       ")"}]}]}], ")"}]}], "/.", "compatRepl"}]], "Input",
 CellChangeTimes->{{3.722321061473927*^9, 3.7223210620744133`*^9}, {
  3.7223212285205603`*^9, 3.7223212299596977`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "32"]}], " ", "\[ImaginaryI]", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"HA", "-", "HB"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"HA", "+", "HB"}], ")"}], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Delta", " ", 
           RowBox[{"(", 
            RowBox[{"HA", "-", "HB"}], ")"}], " ", "sx"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"HAD", "-", "HBD"}], ")"}], " ", "sy"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["HA", "2"]}], "+", 
          SuperscriptBox["HB", "2"]}], ")"}], " ", "sz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
         "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"HAD", "-", "HBD"}], ")"}], " ", "sx"}], "+", 
          RowBox[{"Delta", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "HA"}], "+", "HB"}], ")"}], " ", "sy"}]}], ")"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.722321230276593*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%69", "-", "%72"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722321329345832*^9, 3.7223213587794724`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.72232135397163*^9, 3.722321359960202*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 819},
WindowMargins->{{-874, Automatic}, {43, Automatic}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 70, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[653, 26, 95, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[773, 31, 285, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[1083, 41, 203, 3, 22, "Print"],
Cell[1289, 46, 290, 6, 22, "Print"],
Cell[1582, 54, 204, 3, 22, "Print"],
Cell[1789, 59, 1338, 50, 665, "Print"]
}, Open  ]]
}, Open  ]],
Cell[3154, 113, 962, 23, 63, "Input"],
Cell[4119, 138, 557, 11, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4713, 154, 274, 3, 64, "Section"],
Cell[4990, 159, 263, 5, 30, "Text"],
Cell[5256, 166, 745, 23, 46, "Input"],
Cell[6004, 191, 508, 8, 68, "Text"],
Cell[6515, 201, 1351, 32, 63, "Input"],
Cell[CellGroupData[{
Cell[7891, 237, 437, 10, 28, "Input"],
Cell[8331, 249, 860, 27, 84, "Output"]
}, Open  ]],
Cell[9206, 279, 192, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9435, 287, 173, 2, 64, "Section"],
Cell[9611, 291, 4486, 124, 282, "Input"],
Cell[CellGroupData[{
Cell[14122, 419, 415, 8, 63, "Input"],
Cell[14540, 429, 455, 12, 47, "Output"],
Cell[14998, 443, 1077, 32, 71, "Output"],
Cell[16078, 477, 2928, 79, 131, "Output"]
}, Open  ]],
Cell[19021, 559, 129, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[19175, 565, 649, 12, 28, "Input"],
Cell[19827, 579, 6552, 195, 281, "Output"]
}, Open  ]],
Cell[26394, 777, 138, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26569, 784, 182, 2, 64, "Section"],
Cell[26754, 788, 507, 8, 28, "Input"],
Cell[27264, 798, 1054, 16, 28, "Input"],
Cell[28321, 816, 1439, 27, 63, "Input"],
Cell[CellGroupData[{
Cell[29785, 847, 1030, 28, 98, "Input"],
Cell[CellGroupData[{
Cell[30840, 879, 429, 10, 38, "Print"],
Cell[31272, 891, 278, 7, 22, "Print"],
Cell[31553, 900, 428, 11, 22, "Print"],
Cell[31984, 913, 318, 8, 22, "Print"],
Cell[32305, 923, 268, 7, 22, "Print"],
Cell[32576, 932, 308, 7, 22, "Print"],
Cell[32887, 941, 429, 11, 22, "Print"],
Cell[33319, 954, 318, 8, 22, "Print"],
Cell[33640, 964, 296, 7, 22, "Print"],
Cell[33939, 973, 427, 10, 38, "Print"],
Cell[34369, 985, 278, 7, 22, "Print"],
Cell[34650, 994, 428, 11, 22, "Print"],
Cell[35081, 1007, 318, 8, 22, "Print"],
Cell[35402, 1017, 270, 7, 22, "Print"],
Cell[35675, 1026, 308, 7, 22, "Print"],
Cell[35986, 1035, 429, 11, 22, "Print"],
Cell[36418, 1048, 318, 8, 22, "Print"],
Cell[36739, 1058, 294, 7, 22, "Print"],
Cell[37036, 1067, 429, 10, 38, "Print"],
Cell[37468, 1079, 278, 7, 22, "Print"],
Cell[37749, 1088, 435, 12, 22, "Print"],
Cell[38187, 1102, 320, 8, 22, "Print"],
Cell[38510, 1112, 268, 7, 22, "Print"],
Cell[38781, 1121, 306, 7, 22, "Print"],
Cell[39090, 1130, 430, 12, 22, "Print"],
Cell[39523, 1144, 318, 8, 22, "Print"],
Cell[39844, 1154, 292, 7, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40185, 1167, 471, 12, 31, "Input"],
Cell[40659, 1181, 951, 26, 86, "Output"]
}, Open  ]],
Cell[41625, 1210, 550, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[42200, 1227, 773, 21, 31, "Input"],
Cell[42976, 1250, 57706, 1413, 2216, "Output"]
}, Open  ]],
Cell[100697, 2666, 597, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[101319, 2683, 544, 15, 31, "Input"],
Cell[101866, 2700, 61012, 1450, 2248, "Output"]
}, Open  ]],
Cell[162893, 4153, 332, 10, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163262, 4168, 137, 1, 64, "Section"],
Cell[163402, 4171, 180, 4, 28, "Input"],
Cell[163585, 4177, 637, 17, 80, "Input"],
Cell[CellGroupData[{
Cell[164247, 4198, 806, 24, 97, "Input"],
Cell[CellGroupData[{
Cell[165078, 4226, 495, 11, 38, "Print"],
Cell[165576, 4239, 346, 8, 22, "Print"],
Cell[165925, 4249, 500, 13, 22, "Print"],
Cell[166428, 4264, 386, 9, 22, "Print"],
Cell[166817, 4275, 336, 8, 22, "Print"],
Cell[167156, 4285, 376, 8, 22, "Print"],
Cell[167535, 4295, 499, 13, 22, "Print"],
Cell[168037, 4310, 388, 9, 22, "Print"],
Cell[168428, 4321, 361, 8, 22, "Print"],
Cell[168792, 4331, 497, 11, 38, "Print"],
Cell[169292, 4344, 346, 8, 22, "Print"],
Cell[169641, 4354, 499, 12, 22, "Print"],
Cell[170143, 4368, 386, 9, 22, "Print"],
Cell[170532, 4379, 338, 8, 22, "Print"],
Cell[170873, 4389, 376, 8, 22, "Print"],
Cell[171252, 4399, 500, 13, 22, "Print"],
Cell[171755, 4414, 386, 9, 22, "Print"],
Cell[172144, 4425, 362, 8, 22, "Print"],
Cell[172509, 4435, 497, 11, 38, "Print"],
Cell[173009, 4448, 346, 8, 22, "Print"],
Cell[173358, 4458, 501, 12, 22, "Print"],
Cell[173862, 4472, 385, 9, 22, "Print"],
Cell[174250, 4483, 336, 8, 22, "Print"],
Cell[174589, 4493, 376, 8, 22, "Print"],
Cell[174968, 4503, 195, 3, 22, "Print"],
Cell[175166, 4508, 500, 13, 22, "Print"],
Cell[175669, 4523, 385, 9, 22, "Print"],
Cell[176057, 4534, 362, 8, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[176446, 4546, 351, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[176822, 4559, 344, 10, 28, "Input"],
Cell[177169, 4571, 4902, 126, 263, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182108, 4702, 626, 19, 28, "Input"],
Cell[182737, 4723, 6547, 168, 306, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189321, 4896, 832, 24, 46, "Input"],
Cell[190156, 4922, 6625, 170, 306, "Output"]
}, Open  ]],
Cell[196796, 5095, 410, 11, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197243, 5111, 98, 1, 64, "Section"],
Cell[197344, 5114, 143, 3, 28, "Input"],
Cell[197490, 5119, 1608, 42, 115, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199135, 5166, 205, 3, 64, "Section"],
Cell[199343, 5171, 411, 7, 49, "Text"],
Cell[CellGroupData[{
Cell[199779, 5182, 369, 10, 28, "Input"],
Cell[200151, 5194, 5388, 137, 299, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205576, 5336, 317, 9, 28, "Input"],
Cell[205896, 5347, 5230, 132, 282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211163, 5484, 317, 8, 28, "Input"],
Cell[211483, 5494, 92, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[211624, 5501, 98, 1, 64, "Section"],
Cell[211725, 5504, 2340, 53, 386, "Text"],
Cell[214068, 5559, 1052, 25, 28, "Input"],
Cell[215123, 5586, 913, 22, 28, "Input"],
Cell[216039, 5610, 841, 22, 28, "Input"],
Cell[216883, 5634, 816, 23, 28, "Input"],
Cell[217702, 5659, 537, 9, 49, "Text"],
Cell[CellGroupData[{
Cell[218264, 5672, 735, 17, 80, "Input"],
Cell[219002, 5691, 70, 1, 28, "Output"],
Cell[219075, 5694, 72, 1, 28, "Output"],
Cell[219150, 5697, 72, 1, 28, "Output"],
Cell[219225, 5700, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219332, 5706, 226, 5, 28, "Input"],
Cell[219561, 5713, 70, 1, 28, "Output"]
}, Open  ]],
Cell[219646, 5717, 400, 7, 68, "Text"],
Cell[220049, 5726, 463, 10, 106, "Text"],
Cell[220515, 5738, 738, 16, 63, "Input"],
Cell[221256, 5756, 2097, 52, 165, "Input"],
Cell[CellGroupData[{
Cell[223378, 5812, 2491, 55, 233, "Input"],
Cell[CellGroupData[{
Cell[225894, 5871, 200, 5, 22, "Print"],
Cell[226097, 5878, 374, 8, 22, "Print"],
Cell[226474, 5888, 428, 11, 22, "Print"],
Cell[226905, 5901, 318, 8, 22, "Print"],
Cell[227226, 5911, 270, 7, 22, "Print"],
Cell[227499, 5920, 200, 5, 22, "Print"],
Cell[227702, 5927, 374, 8, 22, "Print"],
Cell[228079, 5937, 431, 11, 22, "Print"],
Cell[228513, 5950, 318, 8, 22, "Print"],
Cell[228834, 5960, 268, 7, 22, "Print"],
Cell[229105, 5969, 202, 5, 22, "Print"],
Cell[229310, 5976, 374, 8, 22, "Print"],
Cell[229687, 5986, 429, 11, 22, "Print"],
Cell[230119, 5999, 318, 8, 22, "Print"],
Cell[230440, 6009, 268, 7, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[230757, 6022, 229, 4, 28, "Input"],
Cell[230989, 6028, 2645, 71, 130, "Output"]
}, Open  ]],
Cell[233649, 6102, 324, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[233998, 6115, 121, 2, 28, "Input"],
Cell[234122, 6119, 2645, 71, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236804, 6195, 217, 5, 28, "Input"],
Cell[237024, 6202, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237131, 6208, 218, 5, 28, "Input"],
Cell[237352, 6215, 559, 16, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237948, 6236, 220, 5, 28, "Input"],
Cell[238171, 6243, 1810, 53, 93, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[240030, 6302, 106, 1, 64, "Section"],
Cell[240139, 6305, 357, 9, 28, "Input"],
Cell[240499, 6316, 217, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[240741, 6325, 174, 3, 28, "Input"],
Cell[240918, 6330, 70, 1, 28, "Output"]
}, Open  ]],
Cell[241003, 6334, 218, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[241246, 6343, 654, 18, 48, "Input"],
Cell[241903, 6363, 525, 15, 47, "Output"]
}, Open  ]],
Cell[242443, 6381, 220, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[242688, 6390, 1230, 34, 86, "Input"],
Cell[243921, 6426, 1085, 32, 66, "Output"]
}, Open  ]],
Cell[245021, 6461, 172, 2, 30, "Text"],
Cell[245196, 6465, 217, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[245438, 6474, 180, 3, 28, "Input"],
Cell[245621, 6479, 70, 1, 28, "Output"]
}, Open  ]],
Cell[245706, 6483, 218, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[245949, 6492, 676, 18, 48, "Input"],
Cell[246628, 6512, 553, 16, 47, "Output"]
}, Open  ]],
Cell[247196, 6531, 220, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[247441, 6540, 1980, 56, 136, "Input"],
Cell[249424, 6598, 1783, 53, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251244, 6656, 290, 8, 28, "Input"],
Cell[251537, 6666, 93, 1, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
