(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70839,       2092]
NotebookOptionsPosition[     65471,       1921]
NotebookOutlinePosition[     65830,       1937]
CellTagsIndexPosition[     65787,       1934]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.720865999487705*^9, 3.720866008214306*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<MagnusFuncs.m\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.720770458697122*^9, 3.7207704760425997`*^9}, {
   3.7207705082294483`*^9, 3.720770515291053*^9}, 3.721499805021591*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{3.722246757865308*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/jesse/NC/\"\>"}],
  SequenceForm["  ", "/Users/jesse/NC/"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7222467578774757`*^9}],

Cell[BoxData["\<\"You can now use \\\"<< NCAlgebra`\\\" to load \
NCAlgebra.\"\>"], "Print",
 CellChangeTimes->{3.7222467578912487`*^9}],

Cell["\<\
------------------------------------------------------------
NCAlgebra - Version 5.0.3
Compatible with Mathematica Version 10 and above

Authors:

  J. William Helton*
  Mauricio de Oliveira&

* Math, UCSD, La Jolla, CA
& MAE, UCSD, La Jolla, CA

with major earlier contributions by:

  Mark Stankus$ 
  Robert L. Miller#

$ Math, Cal Poly San Luis Obispo
# General Atomics Corp

Copyright: 
  Helton and de Oliveira 2017
  Helton 2002
  Helton and Miller June 1991
  All rights reserved.

The program was written by the authors and by:
  David Hurst, Daniel Lamm, Orlando Merino, Robert Obar,
  Henry Pfister, Mike Walker, John Wavrik, Lois Yu,
  J. Camino, J. Griffin, J. Ovall, T. Shaheen, John Shopple. 
  The beginnings of the program come from eran@slac.
  Considerable recent help came from Igor Klep.

Current primary support is from the 
  NSF Division of Mathematical Sciences.
  
This program was written with support from 
  AFOSR, NSF, ONR, Lab for Math and Statistics at UCSD,
  UCSD Faculty Mentor Program,
  and US Department of Education.

For NCAlgebra updates see:

  www.github.com/NCAlgebra/NC
  www.math.ucsd.edu/~ncalg

------------------------------------------------------------\
\>", "Print",
 CellChangeTimes->{3.722246757905846*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"MatrixExp", "::", "eivn"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCommutative", "[", 
   RowBox[{"t", ",", "td0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ww", ">", "0"}], ",", 
     RowBox[{"phi1", ">", "0"}], ",", 
     RowBox[{"t", ">", "0"}], ",", 
     RowBox[{"t0", ">", "0"}], ",", 
     RowBox[{"H1", ">", "0"}], ",", 
     RowBox[{"phi10", ">", "0"}], ",", 
     RowBox[{"tp", ">", "0"}], ",", 
     RowBox[{"xz", ">", "0"}], ",", 
     RowBox[{"t", ">", "t0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7213698094964457`*^9, 3.721369813997707*^9}, {
  3.72214943501926*^9, 3.722149443585431*^9}, {3.72214955434289*^9, 
  3.722149568429648*^9}, {3.722149686466992*^9, 3.722149712930354*^9}, {
  3.722162588045642*^9, 3.722162595126998*^9}, {3.7222309498527403`*^9, 
  3.7222309723199244`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"saveResult", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"saveFile", "=", "\"\<jump_ops_linear_drive_noDeltaPhi_v2.wl\>\""}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.722162597655137*^9, 3.7221625980629597`*^9}, {
  3.722230969754139*^9, 3.722230970217848*^9}, {3.722243646469027*^9, 
  3.722243652899678*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Original Hamiltonian (rotating frame)", "Section",
 CellChangeTimes->{{3.720770537323778*^9, 3.7207705427393923`*^9}, {
  3.720777692919585*^9, 3.7207777320811033`*^9}, {3.7207816372003403`*^9, 
  3.720781655216631*^9}, {3.720787435766768*^9, 3.7207874365371943`*^9}}],

Cell["\<\
Right now I\[CloseCurlyQuote]m just interested in the case of constant drive, \
so the taylor expansion only has a constant term\
\>", "Text",
 CellChangeTimes->{{3.720787439975534*^9, 3.7207874751904593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Horig", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"H1", "/", "4"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "phi", "]"}], "*", "sx"}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "*", 
       "sy"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Delta", "/", "2"}], "*", "sz"}]}]}]], "Input",
 CellChangeTimes->{{3.720781656785536*^9, 3.720781674585722*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"taylorReplacement", "=", 
   RowBox[{"{", 
    RowBox[{"H1", "\[Rule]", 
     RowBox[{"Hd0", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "-", "t0"}], ")"}], " ", "Hd1"}]}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        SuperscriptBox["t", "2"]}], "/", "2"}], " ", "H1DD"}], "+", 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", "3"], "/", "6"}], " ", "H1DDD"}]}], "}"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", "\[Rule]", "0"}], ",", 
     RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720782341021213*^9, 3.720782408514426*^9}, {
   3.7207828174550657`*^9, 3.7207828460226517`*^9}, {3.720782879688923*^9, 
   3.720782957978816*^9}, {3.7207874199364567`*^9, 3.7207874246413527`*^9}, {
   3.721369507318478*^9, 3.7213695447896433`*^9}, {3.721369820304812*^9, 
   3.721369822823305*^9}, 3.7213698643632402`*^9, {3.721384728536125*^9, 
   3.721384731526524*^9}, {3.721640976333373*^9, 3.7216409836755543`*^9}, {
   3.722149326419242*^9, 3.72214935693607*^9}, {3.722149392031625*^9, 
   3.72214939584789*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hsimple", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Horig", "[", "t", "]"}], "/.", "taylorReplacement"}], "/.", 
   "parameters"}]}]], "Input",
 CellChangeTimes->{{3.720783050759514*^9, 3.720783101982284*^9}, 
   3.7207833240077047`*^9, {3.720783804429677*^9, 3.720783810107931*^9}, {
   3.72214936199796*^9, 3.722149365629217*^9}, {3.722149826031633*^9, 
   3.7221498273903513`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"Hd0", "+", 
    RowBox[{"Hd1", " ", 
     RowBox[{"(", 
      RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"sx", "+", 
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7222467609717712`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "Hsimple", "]"}]], "Input",
 CellChangeTimes->{{3.720783304920519*^9, 3.720783310933688*^9}, 
   3.7207838071563997`*^9, 3.722149833377084*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Effective Hamiltonians", "Section",
 CellChangeTimes->{{3.7213912625165873`*^9, 3.721391274414789*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"termHww0", "=", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
      RowBox[{"H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"32", " ", "ww"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Delta", " ", "H1", " ", "sx"}], "+", 
         RowBox[{"H1D", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"H1D", " ", "sx"}], "-", 
         RowBox[{"Delta", " ", "H1", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SuperscriptBox["ww", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"8", " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
      RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7213912768379793`*^9, 3.7213913006335983`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"termHww0", "=", 
  RowBox[{"termHww0", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"termHwwM1", "=", 
  RowBox[{"termHwwM1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"termHwwM2", "=", 
  RowBox[{"termHwwM2", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7221514345050793`*^9, 3.722151489585125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"H1", " ", "sx"}], "4"]], "Output",
 CellChangeTimes->{3.7222467639397087`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
   RowBox[{"4", " ", "H1D", " ", "sy", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["H1", "2"], " ", "sz", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
   RowBox[{"4", " ", "H1D", " ", "sx", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], 
  RowBox[{"32", " ", "ww"}]]], "Output",
 CellChangeTimes->{3.722246763946361*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["H1", "3"], " ", "sx"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7222467639535837`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.7213917280023413`*^9, 3.721391729772744*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Heff", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"termHww0", "+", "termHwwM1", "+", "termHwwM2"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H1", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}], " ", "Hd1"}]}], ")"}]}], ",", 
      RowBox[{"H1D", "\[Rule]", "Hd1"}], ",", 
      RowBox[{"H1DD", "\[Rule]", "0"}], ",", 
      RowBox[{"H1DDD", "\[Rule]", "0"}]}], "}"}]}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.721391303644435*^9, 3.7213913745294228`*^9}, {
   3.7213917000477457`*^9, 3.7213917011961613`*^9}, {3.721453944575795*^9, 
   3.7214539816917553`*^9}, {3.721454459164365*^9, 3.721454497947255*^9}, {
   3.722149808128591*^9, 3.722149811967021*^9}, {3.722150720936048*^9, 
   3.722150727695092*^9}, 3.722151465569895*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "256"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"64", " ", "sx", " ", 
     RowBox[{"(", 
      RowBox[{"Hd0", "+", 
       RowBox[{"Hd1", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "ww"], 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sz", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{"4", " ", "Hd1", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sz", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
        RowBox[{"4", " ", "Hd1", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "sx", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", "t"}], "-", 
           RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"]}], "+", 
       RowBox[{"2", " ", "sx", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
       RowBox[{"sx", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", "t"}], "-", 
           RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"Hd0", "+", 
          RowBox[{"Hd1", " ", "t"}], "-", 
          RowBox[{"Hd1", " ", "t0"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"12", " ", "Hd1", " ", "sz"}], "+", 
          RowBox[{"sy", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", "t"}], "-", 
              RowBox[{"Hd1", " ", "t0"}]}], ")"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
       RowBox[{"sy", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", "t"}], "-", 
           RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7222467984691257`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.72139167843118*^9, 3.721391681812262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion for real Hamiltonian", "Section",
 CellChangeTimes->{{3.72149984456395*^9, 3.721499852290381*^9}, {
  3.7221626431366787`*^9, 3.722162649199335*^9}}],

Cell[BoxData[
 RowBox[{"Remove", "[", "\[CapitalOmega]\[CapitalOmega]simple", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7214719822626133`*^9, 3.7214719896931877`*^9}, {
  3.721472353514744*^9, 3.721472354111644*^9}, {3.721499877011467*^9, 
  3.72149987735284*^9}, {3.721583163400134*^9, 3.721583163642398*^9}, {
  3.721641028958159*^9, 3.721641030924942*^9}, {3.722149838537915*^9, 
  3.722149850484721*^9}, {3.722150373418338*^9, 3.7221503811862926`*^9}, {
  3.7221625841509542`*^9, 3.722162584886582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.721471594711541*^9, 3.721471612498687*^9}, {
   3.72147171132694*^9, 3.7214717650563602`*^9}, {3.721471818875194*^9, 
   3.7214718577305*^9}, {3.721471992456099*^9, 3.7214719926053867`*^9}, {
   3.72147478029744*^9, 3.721474782400672*^9}, {3.721475070506382*^9, 
   3.721475072657221*^9}, {3.7214754970412693`*^9, 3.721475497382984*^9}, {
   3.721481730665987*^9, 3.721481730729863*^9}, {3.7214998793351593`*^9, 
   3.721499879586091*^9}, {3.721583167493902*^9, 3.721583169356577*^9}, 
   3.7215836919134483`*^9, {3.7216252926059504`*^9, 3.721625303081492*^9}, {
   3.721641015366444*^9, 3.7216410342436657`*^9}, 3.7221498543218822`*^9, {
   3.722150249015389*^9, 3.722150249597885*^9}, {3.722150365347493*^9, 
   3.7221503657301064`*^9}, {3.722150826924828*^9, 3.722150827962327*^9}, {
   3.722151143487228*^9, 3.7221511439973087`*^9}, {3.72215139675976*^9, 
   3.722151397413951*^9}, {3.7222436972986317`*^9, 3.722243698478166*^9}, 
   3.7222438058638077`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MI", "=", 
   RowBox[{"JesseGetMagnusIntegrands", "[", 
    RowBox[{"h", ",", "\[CapitalOmega]\[CapitalOmega]simple", ",", "max"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MI", "=", 
   RowBox[{"MI", "/.", 
    RowBox[{"h", "\[Rule]", 
     RowBox[{"Hsimple", "[", "t", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.721471594711541*^9, 3.721471612498687*^9}, {
   3.72147171132694*^9, 3.7214717650563602`*^9}, {3.721471818875194*^9, 
   3.7214718577305*^9}, {3.721471992456099*^9, 3.7214719926053867`*^9}, {
   3.72147478029744*^9, 3.721474782400672*^9}, {3.721475070506382*^9, 
   3.721475072657221*^9}, {3.7214754970412693`*^9, 3.721475497382984*^9}, {
   3.721481730665987*^9, 3.721481730729863*^9}, {3.7214998793351593`*^9, 
   3.721499879586091*^9}, {3.721583167493902*^9, 3.721583169356577*^9}, 
   3.7215836919134483`*^9, {3.7216252926059504`*^9, 3.721625303081492*^9}, {
   3.721641015366444*^9, 3.7216410342436657`*^9}, 3.7221498543218822`*^9, {
   3.722150249015389*^9, 3.722150249597885*^9}, {3.722150365347493*^9, 
   3.7221503657301064`*^9}, {3.722150826924828*^9, 3.722150827962327*^9}, {
   3.722151143487228*^9, 3.7221511439973087`*^9}, {3.72215139675976*^9, 
   3.722151397413951*^9}, {3.7222436972986317`*^9, 3.722243698478166*^9}, 
   3.7222438058638077`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
       RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
      RowBox[{"JesseDoMagnusIntegration", "[", 
       RowBox[{
        RowBox[{"MI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        SubscriptBox["WWeff", "i"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.721499891942844*^9, {3.721583174720359*^9, 3.72158317504136*^9}, {
   3.721583823315545*^9, 3.72158384151307*^9}, {3.721583901018448*^9, 
   3.7215839042305737`*^9}, 3.7216270486445513`*^9, 3.7216410377051992`*^9, 
   3.722149857373662*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", "/", "tc"}], " ", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
     RowBox[{
      RowBox[{"ta", "+", "tc"}], ",", "ta"}], "]"}]}], "//", "FS"}], "//", 
  "CWW"}]], "Input",
 CellChangeTimes->{{3.721641265824979*^9, 3.721641273206327*^9}, {
   3.721643572709309*^9, 3.721643576643758*^9}, {3.721643630264494*^9, 
   3.721643661719714*^9}, 3.7221502772472057`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]simple"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.721499946855296*^9, 3.721499973780986*^9}, {
   3.721583179773501*^9, 3.721583184528266*^9}, 3.722149725724958*^9, 
   3.7221502705228167`*^9, {3.72215038604436*^9, 3.722150392675001*^9}, {
   3.722160249165916*^9, 3.722160255243806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hlinbar", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.721499989961666*^9, 3.721499999299775*^9}, {
  3.721535505319736*^9, 3.721535512229414*^9}, {3.7215831887963543`*^9, 
  3.721583193637969*^9}, {3.722150329187159*^9, 3.722150334340963*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Hlinbar"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721499995856163*^9, 3.721500001564535*^9}, {
   3.721583205626096*^9, 3.721583224744295*^9}, {3.721583259957012*^9, 
   3.721583260242675*^9}, 3.722149728125202*^9, {3.7221503373302927`*^9, 
   3.722150339218555*^9}, {3.7221503965733967`*^9, 3.7221504006992083`*^9}, {
   3.722160258549572*^9, 3.722160262464308*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
        RowBox[{"tb", ",", "ta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.722173497816763*^9, 3.722173504817401*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion for effective Hamiltonian", "Section",
 CellChangeTimes->{{3.722162662772456*^9, 3.722162681096442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\[CapitalOmega]\[CapitalOmega]eff", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722162683579185*^9, 3.7221627113242483`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{"JesseGetMagnusIntegrands", "[", 
   RowBox[{"h", ",", "\[CapitalOmega]\[CapitalOmega]eff", ",", "max"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{"MI", "/.", 
   RowBox[{"h", "\[Rule]", 
    RowBox[{"Heff", "[", "t", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.722162714722845*^9, 3.7221627508366327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
       RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
      RowBox[{"JesseDoMagnusIntegration", "[", 
       RowBox[{
        RowBox[{"MI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        SubscriptBox["WWeff", "i"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.7221627329169493`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]eff"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.722162789261259*^9, 3.7221627894681168`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", "/", "tc"}], " ", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
     RowBox[{
      RowBox[{"ta", "+", "tc"}], ",", "ta"}], "]"}]}], "//", "FS"}], "//", 
  "CWW"}]], "Input",
 CellChangeTimes->{{3.722162832046605*^9, 3.722162832325976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hlineffbar", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.72216280735779*^9, 3.722162812191296*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Hlineffbar"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
        RowBox[{"tb", ",", "ta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", 
   "S"}]}]}], "Input",
 CellChangeTimes->{
  3.722162821039257*^9, {3.7221734342700043`*^9, 3.7221734711991568`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7222437063727922`*^9, 3.7222437170699797`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load results", "Section",
 CellChangeTimes->{{3.7222437418447638`*^9, 3.72224374667692*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.722243747785515*^9, 3.722243759334203*^9}, {
  3.7222468243855333`*^9, 3.7222468269445267`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
    RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", "S"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.722243780695854*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
    RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", "S"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.722243826448124*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking results", "Section",
 CellChangeTimes->{{3.7213922110718603`*^9, 3.7213922150841417`*^9}, {
  3.721392917805194*^9, 3.7213929303153143`*^9}, {3.722151071374181*^9, 
  3.722151077938756*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hlinbar", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "FS"}], "//", 
   "CWW"}]}]], "Input",
 CellChangeTimes->{{3.7221510798933992`*^9, 3.722151106347843*^9}, {
  3.7221512958929567`*^9, 3.7221512977393*^9}, {3.722163173961741*^9, 
  3.7221631750883703`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Hd0", " ", "sx"}], "4"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sx"}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}]}], 
   RowBox[{"256", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
     RowBox[{"8", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.722246803680173*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hlineffbar", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "FS"}], "//", 
   "CWW"}]}]], "Input",
 CellChangeTimes->{{3.7221631279601*^9, 3.722163128182786*^9}, {
  3.722163178843224*^9, 3.722163180297141*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Hd0", " ", "sx"}], "4"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sx"}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], 
   RowBox[{"256", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
     RowBox[{"8", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.722246807645203*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"test2", "-", "test1"}], "/.", 
  RowBox[{"{", 
   RowBox[{"t0", "\[Rule]", 
    RowBox[{"\[Alpha]0", "/", "ww"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7221631861997843`*^9, 3.722163215569655*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722246807730174*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jump operators", "Section",
 CellChangeTimes->{{3.72216218339668*^9, 3.722162197273571*^9}}],

Cell[TextData[{
 "We consider the case of a jump in the driving envelope at time tj between \
one linear drive envelope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for t < tj and another linear drive envelope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for t > tj. We allow for discontinuities in both the envelope value and \
the first derivative. We Taylor expand the driving envelopes around tj. The \
relevant parameters describing the drive envelope are then \n\nt < tj\t\t\t\t\
t > tj\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]]],
 "(tj)\t\tEmd0\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(tj)\t\tEpd0\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "t"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(tj)\t\tEmd1\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "t"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(tj)\t\tEpd1\n\nRelevant time evolution operators (in exponent form):\nA\t\
Hmeff(tj) -> Heffm(t0+ktc)\nB\tHmreal(t0+ktc) -> Hmreal(tj)\nC\tHpreal(tj) -> \
Hpreal(t0+(k+1)tc)\nD\tHpeff(t0+(k+1)tc) -> Hpeff(tj)"
}], "Text",
 CellChangeTimes->{{3.722162201642559*^9, 3.722162368367354*^9}, {
  3.7221625236287193`*^9, 3.722162571485042*^9}, {3.7221632329004307`*^9, 
  3.722163344159778*^9}, {3.722164504325034*^9, 3.722164525651071*^9}, {
  3.722165000148678*^9, 3.722165060739952*^9}, {3.722165119451817*^9, 
  3.722165304643661*^9}, {3.7221662505640697`*^9, 3.7221662885776577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]A", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
       RowBox[{"t0", ",", "tj"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", "\[Rule]", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
        RowBox[{"tj", "\[Rule]", 
         RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hd0", "\[Rule]", "Emd0"}], ",", 
       RowBox[{"Hd1", "\[Rule]", "Emd1"}]}], "}"}]}], "//", "FS"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722165346513688*^9, 3.722165366270275*^9}, {
  3.722166146415406*^9, 3.722166171590048*^9}, {3.722166241552552*^9, 
  3.722166245080381*^9}, {3.722166301916195*^9, 3.722166302417989*^9}, {
  3.722167052649054*^9, 3.722167074665103*^9}, {3.722167632951058*^9, 
  3.7221676410180883`*^9}, {3.722168725842442*^9, 3.722168727553561*^9}, {
  3.72217372443112*^9, 3.722173769639975*^9}, {3.722243983865851*^9, 
  3.7222440297930927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]B", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
       RowBox[{"t0", ",", "tj"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t0", "\[Rule]", 
        RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
       RowBox[{"tj", "\[Rule]", 
        RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Hd0", "\[Rule]", "Emd0"}], ",", 
      RowBox[{"Hd1", "\[Rule]", "Emd1"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.722166425224987*^9, 3.722166447722316*^9}, {
   3.722167000945086*^9, 3.722167009689746*^9}, {3.722167078169743*^9, 
   3.722167091193595*^9}, 3.7221676463817177`*^9, {3.72216769034193*^9, 
   3.72216771103909*^9}, {3.722173781768188*^9, 3.72217380423955*^9}, {
   3.7222440077608547`*^9, 3.722244033052853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]C", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
       RowBox[{
        RowBox[{"t0", "+", "tc"}], ",", "tj"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", "\[Rule]", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
        RowBox[{"tj", "\[Rule]", 
         RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hd0", "\[Rule]", "Epd0"}], ",", 
       RowBox[{"Hd1", "\[Rule]", "Epd1"}]}], "}"}]}], "//", "S"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722167019705962*^9, 3.722167032424327*^9}, {
   3.7221673901970463`*^9, 3.7221674359406357`*^9}, 3.722167647628875*^9, 
   3.722173836812299*^9, {3.722244009630838*^9, 3.722244037569263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]D", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
        RowBox[{
         RowBox[{"t0", "+", "tc"}], ",", "tj"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", "\[Rule]", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], ",", 
        RowBox[{"tj", "\[Rule]", 
         RowBox[{"\[Alpha]j", "/", "ww"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hd0", "\[Rule]", "Epd0"}], ",", 
       RowBox[{"Hd1", "\[Rule]", "Epd1"}]}], "}"}]}], "//", "FS"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722167800464551*^9, 3.722167881986027*^9}, {
  3.722173871685955*^9, 3.722173879242647*^9}, {3.722244011622781*^9, 
  3.722244039801837*^9}}],

Cell["\<\
Intermezzo: let\[CloseCurlyQuote]s look at the 1/ww^0 terms of these little \
friends and check if they correspond to the rotating wave approximation of \
the problem. In particular, the sum of all these coefficients come out to \
zero in the RWA.\
\>", "Text",
 CellChangeTimes->{{3.7221683156712313`*^9, 3.722168382826825*^9}, {
  3.72216846800807*^9, 3.7221684680541477`*^9}, {3.7221687909478273`*^9, 
  3.722168822530778*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ww0A", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]A", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0B", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]B", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0C", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]C", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0D", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]D", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7221684766451597`*^9, 3.7221685168557587`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7222468078844423`*^9, 3.722246917717321*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7222468078844423`*^9, 3.722246917732445*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7222468078844423`*^9, 3.722246917801804*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7222468078844423`*^9, 3.7222469178134747`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ww0A", "+", "ww0B", "+", "ww0C", "+", "ww0D"}], "//", 
  "FS"}]], "Input",
 CellChangeTimes->{{3.7221684948786907`*^9, 3.722168495038825*^9}, {
  3.722168691833044*^9, 3.722168702358116*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7222468079801702`*^9, 3.7222469178809*^9}]
}, Open  ]],

Cell["\<\
Now, we\[CloseCurlyQuote]re interested in calculating
exp[D] exp[C] exp[B] exp[A]
up to the order 1/ww^k using the BCH formula\
\>", "Text",
 CellChangeTimes->{{3.722168152176427*^9, 3.722168185835939*^9}, {
  3.7221682195011463`*^9, 3.722168244397887*^9}, {3.722169010340488*^9, 
  3.722169014097417*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"jumpOrder", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factors", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[CapitalOmega]D", ",", "\[CapitalOmega]C", ",", "\[CapitalOmega]B", ",",
      "\[CapitalOmega]A"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722234457236*^9, 3.722234490304687*^9}, {
  3.7222440518004637`*^9, 3.7222441552504063`*^9}, {3.722244489831881*^9, 
  3.722244546951318*^9}, {3.722244603458599*^9, 3.722244604353558*^9}, {
  3.7222448689571257`*^9, 3.722244918998105*^9}, {3.722244949648678*^9, 
  3.72224503118594*^9}, {3.7222461068384867`*^9, 3.722246137817358*^9}, {
  3.722246547217857*^9, 3.722246547542665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"combineExponent", "[", 
    RowBox[{"A_", ",", "B_", ",", "o_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"BCHFormula", "[", 
        RowBox[{"A", ",", "B", ",", "o"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<BCH formule up to order \>\"", ",", "o", ",", "\"\<, done:  \>\"",
         ",", 
        RowBox[{
         RowBox[{"Date", "[", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"JesseGrim", "[", 
        RowBox[{"result", ",", 
         RowBox[{"{", 
          RowBox[{"1", "/", "ww"}], "}"}], ",", "o", ",", "Simplify", ",", 
         "Identity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Trimming done:  \>\"", ",", " ", 
        RowBox[{
         RowBox[{"Date", "[", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"4", ";;", "5"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.722245270369453*^9, 3.722245274010118*^9}, {
  3.722245526995511*^9, 3.7222457355529337`*^9}, {3.722247382138583*^9, 
  3.722247406354499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"intmProduct", "[", "1", "]"}], "=", 
   RowBox[{"First", "[", "factors", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idx", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factorsToGo", "=", 
   RowBox[{"Rest", "[", "factors", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "factorsToGo", "]"}], ">", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Working on \>\"", ",", "idx"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nextFactor", "=", 
      RowBox[{"First", "[", "factorsToGo", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"factorsToGo", "=", 
      RowBox[{"Rest", "[", "factorsToGo", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"intmProduct", "[", 
       RowBox[{"idx", "+", "1"}], "]"}], "=", 
      RowBox[{"combineExponent", "[", 
       RowBox[{
        RowBox[{"intmProduct", "[", "idx", "]"}], ",", "nextFactor", ",", 
        "jumpOrder"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"idx", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalProduct", "=", 
   RowBox[{"intmProduct", "[", "idx", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.722234457236*^9, 3.722234490304687*^9}, {
  3.7222440518004637`*^9, 3.7222441552504063`*^9}, {3.722244489831881*^9, 
  3.722244546951318*^9}, {3.722244603458599*^9, 3.722244604353558*^9}, {
  3.7222448689571257`*^9, 3.722244918998105*^9}, {3.722244949648678*^9, 
  3.722245012177392*^9}, {3.722246175298983*^9, 3.722246208257749*^9}, {
  3.7222462436932583`*^9, 3.72224625238801*^9}, {3.722246285635899*^9, 
  3.722246360303728*^9}, {3.722246393458109*^9, 3.7222465446850557`*^9}, {
  3.722247167950688*^9, 3.722247168630262*^9}, {3.72224723378367*^9, 
  3.722247244524581*^9}, {3.7222473207764807`*^9, 3.72224732735128*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working on \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Working on ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247408238737*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BCH formule up to order \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["BCH formule up to order ", 2, ", done:  ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247408650548*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {14, 36}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.7222474096396713`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.7222474096544247`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["Trimming done:  ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.7222474096670313`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working on \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Working on ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247409679081*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BCH formule up to order \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["BCH formule up to order ", 2, ", done:  ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247409940894*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {14, 36}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247410086257*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247410101886*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["Trimming done:  ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247410115375*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Working on \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Working on ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247410127561*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"BCH formule up to order \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\", done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["BCH formule up to order ", 2, ", done:  ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.7222474102674093`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {14, 36}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.72224741048319*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247410499794*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"14", ",", "36"}], "}"}]}],
  SequenceForm["Trimming done:  ", {14, 36}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72224720773652*^9, 3.722247249803611*^9, 3.722247328321162*^9, {
   3.7222473892908154`*^9, 3.722247410508048*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jlin", "=", "finalProduct"}]], "Input",
 CellChangeTimes->{{3.7221746694512987`*^9, 3.722174673641407*^9}, {
  3.722235173023079*^9, 3.722235173430215*^9}, {3.722247312937896*^9, 
  3.722247334870063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Emd0", "2"], "-", 
          SuperscriptBox["Epd0", "2"]}], ")"}]}], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "Emd1", " ", "sy"}], "+", 
         RowBox[{"4", " ", "Epd1", " ", "sy"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["Emd0", "2"], " ", "sz"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["Epd0", "2"], " ", "sz"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Emd1"}], "+", "Epd1"}], ")"}], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{3.722247414779376*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jlin", "//", "CWW"}]], "Input",
 CellChangeTimes->{{3.722174742800955*^9, 3.722174746429471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Emd0", "2"], "-", 
          SuperscriptBox["Epd0", "2"]}], ")"}]}], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "Emd1", " ", "sy"}], "+", 
         RowBox[{"4", " ", "Epd1", " ", "sy"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["Emd0", "2"], " ", "sz"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["Epd0", "2"], " ", "sz"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Emd1"}], "+", "Epd1"}], ")"}], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{3.7222474179945097`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722247461431122*^9, 3.72224746958881*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722247469790976*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722174801258543*^9, 3.722174825950988*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.722247421062048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7222474332200203`*^9, 3.722247433547275*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]0", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Alpha]j", "]"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]j", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sy", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
       RowBox[{"sx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.72224744087724*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results for order 2", "Section",
 CellChangeTimes->{{3.7222474758766603`*^9, 3.722247481636539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722247461431122*^9, 3.72224746958881*^9}}],

Cell[BoxData["0"], "Input",
 CellChangeTimes->{{3.722247485717783*^9, 3.722247486420767*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722174801258543*^9, 3.722174825950988*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.722247487612586*^9, 3.7222474880048923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7222474332200203`*^9, 3.722247433547275*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]0", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Alpha]j", "]"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]j", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"Emd1", "-", "Epd1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sy", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
       RowBox[{"sx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.722247490580701*^9, 3.722247491181348*^9}}]
}, Open  ]]
},
WindowSize->{808, 819},
WindowMargins->{{-939, Automatic}, {-21, Automatic}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 70, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[653, 26, 95, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[773, 31, 285, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[1083, 41, 135, 2, 22, "Print"],
Cell[1221, 45, 224, 5, 22, "Print"],
Cell[1448, 52, 136, 2, 22, "Print"],
Cell[1587, 56, 1270, 49, 665, "Print"]
}, Open  ]]
}, Open  ]],
Cell[2884, 109, 962, 23, 63, "Input"],
Cell[3849, 134, 370, 8, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4256, 147, 274, 3, 64, "Section"],
Cell[4533, 152, 220, 4, 30, "Text"],
Cell[4756, 158, 745, 23, 46, "Input"],
Cell[5504, 183, 1266, 33, 51, "Input"],
Cell[CellGroupData[{
Cell[6795, 220, 437, 10, 28, "Input"],
Cell[7235, 232, 507, 16, 47, "Output"]
}, Open  ]],
Cell[7757, 251, 192, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7986, 259, 109, 1, 64, "Section"],
Cell[8098, 262, 4486, 124, 282, "Input"],
Cell[CellGroupData[{
Cell[12609, 390, 694, 19, 63, "Input"],
Cell[13306, 411, 117, 3, 47, "Output"],
Cell[13426, 416, 574, 16, 50, "Output"],
Cell[14003, 434, 1267, 35, 73, "Output"]
}, Open  ]],
Cell[15285, 472, 129, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[15439, 478, 927, 22, 63, "Input"],
Cell[16369, 502, 3182, 92, 166, "Output"]
}, Open  ]],
Cell[19566, 597, 138, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19741, 604, 182, 2, 64, "Section"],
Cell[19926, 608, 507, 8, 28, "Input"],
Cell[20436, 618, 1054, 16, 28, "Input"],
Cell[21493, 636, 1439, 27, 63, "Input"],
Cell[22935, 665, 1030, 28, 98, "Input"],
Cell[23968, 695, 471, 12, 31, "Input"],
Cell[24442, 709, 550, 13, 28, "Input"],
Cell[24995, 724, 773, 21, 31, "Input"],
Cell[25771, 747, 597, 13, 28, "Input"],
Cell[26371, 762, 544, 15, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26952, 782, 137, 1, 64, "Section"],
Cell[27092, 785, 180, 4, 28, "Input"],
Cell[27275, 791, 544, 14, 80, "Input"],
Cell[27822, 807, 806, 24, 97, "Input"],
Cell[28631, 833, 351, 9, 28, "Input"],
Cell[28985, 844, 344, 10, 28, "Input"],
Cell[29332, 856, 626, 19, 28, "Input"],
Cell[29961, 877, 832, 24, 46, "Input"],
Cell[30796, 903, 96, 1, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30929, 909, 98, 1, 64, "Section"],
Cell[31030, 912, 341, 9, 46, "Input"],
Cell[31374, 923, 549, 16, 31, "Input"],
Cell[31926, 941, 545, 16, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32508, 962, 205, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[32738, 969, 369, 10, 28, "Input"],
Cell[33110, 981, 1988, 52, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35135, 1038, 317, 9, 28, "Input"],
Cell[35455, 1049, 1952, 52, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37444, 1106, 237, 6, 28, "Input"],
Cell[37684, 1114, 70, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37803, 1121, 98, 1, 64, "Section"],
Cell[37904, 1124, 1901, 50, 291, "Text"],
Cell[39808, 1176, 1052, 25, 28, "Input"],
Cell[40863, 1203, 913, 22, 28, "Input"],
Cell[41779, 1227, 841, 22, 28, "Input"],
Cell[42623, 1251, 816, 23, 28, "Input"],
Cell[43442, 1276, 440, 8, 49, "Text"],
Cell[CellGroupData[{
Cell[43907, 1288, 735, 17, 80, "Input"],
Cell[44645, 1307, 94, 1, 28, "Output"],
Cell[44742, 1310, 94, 1, 28, "Output"],
Cell[44839, 1313, 94, 1, 28, "Output"],
Cell[44936, 1316, 96, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45069, 1322, 226, 5, 28, "Input"],
Cell[45298, 1329, 92, 1, 28, "Output"]
}, Open  ]],
Cell[45405, 1333, 316, 7, 68, "Text"],
Cell[45724, 1342, 738, 16, 63, "Input"],
Cell[46465, 1360, 1506, 39, 131, "Input"],
Cell[CellGroupData[{
Cell[47996, 1403, 2013, 45, 199, "Input"],
Cell[CellGroupData[{
Cell[50034, 1452, 298, 7, 22, "Print"],
Cell[50335, 1461, 470, 10, 22, "Print"],
Cell[50808, 1473, 529, 13, 22, "Print"],
Cell[51340, 1488, 428, 10, 22, "Print"],
Cell[51771, 1500, 368, 9, 22, "Print"],
Cell[52142, 1511, 298, 7, 22, "Print"],
Cell[52443, 1520, 470, 10, 22, "Print"],
Cell[52916, 1532, 527, 13, 22, "Print"],
Cell[53446, 1547, 426, 10, 22, "Print"],
Cell[53875, 1559, 366, 9, 22, "Print"],
Cell[54244, 1570, 298, 7, 22, "Print"],
Cell[54545, 1579, 472, 10, 22, "Print"],
Cell[55020, 1591, 526, 13, 22, "Print"],
Cell[55549, 1606, 426, 10, 22, "Print"],
Cell[55978, 1618, 366, 9, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56393, 1633, 229, 4, 28, "Input"],
Cell[56625, 1639, 1803, 52, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58465, 1696, 121, 2, 28, "Input"],
Cell[58589, 1700, 1805, 52, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60431, 1757, 217, 5, 28, "Input"],
Cell[60651, 1764, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60758, 1770, 218, 5, 28, "Input"],
Cell[60979, 1777, 529, 15, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61545, 1797, 220, 5, 28, "Input"],
Cell[61768, 1804, 1094, 32, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62911, 1842, 106, 1, 64, "Section"],
Cell[63020, 1845, 217, 5, 28, "Input"],
Cell[63240, 1852, 93, 1, 28, InheritFromParent],
Cell[63336, 1855, 218, 5, 28, "Input"],
Cell[63557, 1862, 554, 15, 48, InheritFromParent],
Cell[64114, 1879, 220, 5, 28, "Input"],
Cell[64337, 1886, 1118, 32, 86, InheritFromParent]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
