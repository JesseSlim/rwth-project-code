(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    217191,       5784]
NotebookOptionsPosition[    208625,       5515]
NotebookOutlinePosition[    208984,       5531]
CellTagsIndexPosition[    208941,       5528]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.720865999487705*^9, 3.720866008214306*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<MagnusFuncs.m\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.720770458697122*^9, 3.7207704760425997`*^9}, {
   3.7207705082294483`*^9, 3.720770515291053*^9}, 3.721499805021591*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721369495998665*^9, 3.7213815946147614`*^9, 3.721386294611224*^9, 
   3.721386435016584*^9, 3.7213935854696207`*^9, 3.721394311268981*^9, 
   3.721394379806443*^9, 3.7213945456116943`*^9, 3.721394716671728*^9, {
   3.721394991457971*^9, 3.7213950184842*^9}, 3.7213954643184223`*^9, 
   3.7213959488889523`*^9, 3.7214536846755257`*^9, 3.721454949070096*^9, 
   3.721455087471856*^9, 3.721455546146496*^9, 3.721455964357521*^9, 
   3.7214561828840723`*^9, 3.7214563140045633`*^9, 3.721461683426783*^9, 
   3.7214998137988367`*^9, 3.721499927093918*^9, 3.721543616948702*^9, 
   3.721543673817564*^9, 3.721583117784651*^9, 3.7215834679719257`*^9, 
   3.7215837972705917`*^9, 3.721583934793434*^9, 3.72158418790961*^9, 
   3.721625189608335*^9, 3.721625279359377*^9, 3.721625485798307*^9, 
   3.721625515835574*^9, 3.7216257014633837`*^9, 3.721626148801009*^9, 
   3.7216267259401827`*^9, 3.7216270695049133`*^9, 3.721641004484518*^9, 
   3.721642334487461*^9, 3.721642394399837*^9, 3.721642551202677*^9, 
   3.721642811303051*^9, {3.7221492838985977`*^9, 3.722149308533965*^9}, 
   3.722149717923691*^9, 3.72214986801091*^9, 3.7221514165892563`*^9, 
   3.72215148322532*^9, 3.7222309288708344`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/jesse/NC/\"\>"}],
  SequenceForm["  ", "/Users/jesse/NC/"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721369495998665*^9, 3.7213815946147614`*^9, 3.721386294611224*^9, 
   3.721386435016584*^9, 3.7213935854696207`*^9, 3.721394311268981*^9, 
   3.721394379806443*^9, 3.7213945456116943`*^9, 3.721394716671728*^9, {
   3.721394991457971*^9, 3.7213950184842*^9}, 3.7213954643184223`*^9, 
   3.7213959488889523`*^9, 3.7214536846755257`*^9, 3.721454949070096*^9, 
   3.721455087471856*^9, 3.721455546146496*^9, 3.721455964357521*^9, 
   3.7214561828840723`*^9, 3.7214563140045633`*^9, 3.721461683426783*^9, 
   3.7214998137988367`*^9, 3.721499927093918*^9, 3.721543616948702*^9, 
   3.721543673817564*^9, 3.721583117784651*^9, 3.7215834679719257`*^9, 
   3.7215837972705917`*^9, 3.721583934793434*^9, 3.72158418790961*^9, 
   3.721625189608335*^9, 3.721625279359377*^9, 3.721625485798307*^9, 
   3.721625515835574*^9, 3.7216257014633837`*^9, 3.721626148801009*^9, 
   3.7216267259401827`*^9, 3.7216270695049133`*^9, 3.721641004484518*^9, 
   3.721642334487461*^9, 3.721642394399837*^9, 3.721642551202677*^9, 
   3.721642811303051*^9, {3.7221492838985977`*^9, 3.722149308533965*^9}, 
   3.722149717923691*^9, 3.72214986801091*^9, 3.7221514165892563`*^9, 
   3.72215148322532*^9, 3.722230928880145*^9}],

Cell[BoxData["\<\"You can now use \\\"<< NCAlgebra`\\\" to load \
NCAlgebra.\"\>"], "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721369495998665*^9, 3.7213815946147614`*^9, 3.721386294611224*^9, 
   3.721386435016584*^9, 3.7213935854696207`*^9, 3.721394311268981*^9, 
   3.721394379806443*^9, 3.7213945456116943`*^9, 3.721394716671728*^9, {
   3.721394991457971*^9, 3.7213950184842*^9}, 3.7213954643184223`*^9, 
   3.7213959488889523`*^9, 3.7214536846755257`*^9, 3.721454949070096*^9, 
   3.721455087471856*^9, 3.721455546146496*^9, 3.721455964357521*^9, 
   3.7214561828840723`*^9, 3.7214563140045633`*^9, 3.721461683426783*^9, 
   3.7214998137988367`*^9, 3.721499927093918*^9, 3.721543616948702*^9, 
   3.721543673817564*^9, 3.721583117784651*^9, 3.7215834679719257`*^9, 
   3.7215837972705917`*^9, 3.721583934793434*^9, 3.72158418790961*^9, 
   3.721625189608335*^9, 3.721625279359377*^9, 3.721625485798307*^9, 
   3.721625515835574*^9, 3.7216257014633837`*^9, 3.721626148801009*^9, 
   3.7216267259401827`*^9, 3.7216270695049133`*^9, 3.721641004484518*^9, 
   3.721642334487461*^9, 3.721642394399837*^9, 3.721642551202677*^9, 
   3.721642811303051*^9, {3.7221492838985977`*^9, 3.722149308533965*^9}, 
   3.722149717923691*^9, 3.72214986801091*^9, 3.7221514165892563`*^9, 
   3.72215148322532*^9, 3.722230928893125*^9}],

Cell["\<\
------------------------------------------------------------
NCAlgebra - Version 5.0.3
Compatible with Mathematica Version 10 and above

Authors:

  J. William Helton*
  Mauricio de Oliveira&

* Math, UCSD, La Jolla, CA
& MAE, UCSD, La Jolla, CA

with major earlier contributions by:

  Mark Stankus$ 
  Robert L. Miller#

$ Math, Cal Poly San Luis Obispo
# General Atomics Corp

Copyright: 
  Helton and de Oliveira 2017
  Helton 2002
  Helton and Miller June 1991
  All rights reserved.

The program was written by the authors and by:
  David Hurst, Daniel Lamm, Orlando Merino, Robert Obar,
  Henry Pfister, Mike Walker, John Wavrik, Lois Yu,
  J. Camino, J. Griffin, J. Ovall, T. Shaheen, John Shopple. 
  The beginnings of the program come from eran@slac.
  Considerable recent help came from Igor Klep.

Current primary support is from the 
  NSF Division of Mathematical Sciences.
  
This program was written with support from 
  AFOSR, NSF, ONR, Lab for Math and Statistics at UCSD,
  UCSD Faculty Mentor Program,
  and US Department of Education.

For NCAlgebra updates see:

  www.github.com/NCAlgebra/NC
  www.math.ucsd.edu/~ncalg

------------------------------------------------------------\
\>", "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721369495998665*^9, 3.7213815946147614`*^9, 3.721386294611224*^9, 
   3.721386435016584*^9, 3.7213935854696207`*^9, 3.721394311268981*^9, 
   3.721394379806443*^9, 3.7213945456116943`*^9, 3.721394716671728*^9, {
   3.721394991457971*^9, 3.7213950184842*^9}, 3.7213954643184223`*^9, 
   3.7213959488889523`*^9, 3.7214536846755257`*^9, 3.721454949070096*^9, 
   3.721455087471856*^9, 3.721455546146496*^9, 3.721455964357521*^9, 
   3.7214561828840723`*^9, 3.7214563140045633`*^9, 3.721461683426783*^9, 
   3.7214998137988367`*^9, 3.721499927093918*^9, 3.721543616948702*^9, 
   3.721543673817564*^9, 3.721583117784651*^9, 3.7215834679719257`*^9, 
   3.7215837972705917`*^9, 3.721583934793434*^9, 3.72158418790961*^9, 
   3.721625189608335*^9, 3.721625279359377*^9, 3.721625485798307*^9, 
   3.721625515835574*^9, 3.7216257014633837`*^9, 3.721626148801009*^9, 
   3.7216267259401827`*^9, 3.7216270695049133`*^9, 3.721641004484518*^9, 
   3.721642334487461*^9, 3.721642394399837*^9, 3.721642551202677*^9, 
   3.721642811303051*^9, {3.7221492838985977`*^9, 3.722149308533965*^9}, 
   3.722149717923691*^9, 3.72214986801091*^9, 3.7221514165892563`*^9, 
   3.72215148322532*^9, 3.7222309289085217`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"MatrixExp", "::", "eivn"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCommutative", "[", 
   RowBox[{"t", ",", "td0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ww", ">", "0"}], ",", 
     RowBox[{"phi1", ">", "0"}], ",", 
     RowBox[{"t", ">", "0"}], ",", 
     RowBox[{"t0", ">", "0"}], ",", 
     RowBox[{"H1", ">", "0"}], ",", 
     RowBox[{"phi10", ">", "0"}], ",", 
     RowBox[{"tp", ">", "0"}], ",", 
     RowBox[{"xz", ">", "0"}], ",", 
     RowBox[{"t", ">", "t0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7213698094964457`*^9, 3.721369813997707*^9}, {
  3.72214943501926*^9, 3.722149443585431*^9}, {3.72214955434289*^9, 
  3.722149568429648*^9}, {3.722149686466992*^9, 3.722149712930354*^9}, {
  3.722162588045642*^9, 3.722162595126998*^9}, {3.7222309498527403`*^9, 
  3.7222309723199244`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"saveResult", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"saveFile", "=", "\"\<jump_ops_linear_drive_noDeltaPhi_v2.wl\>\""}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.722162597655137*^9, 3.7221625980629597`*^9}, {
  3.722230969754139*^9, 3.722230970217848*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Original Hamiltonian (rotating frame)", "Section",
 CellChangeTimes->{{3.720770537323778*^9, 3.7207705427393923`*^9}, {
  3.720777692919585*^9, 3.7207777320811033`*^9}, {3.7207816372003403`*^9, 
  3.720781655216631*^9}, {3.720787435766768*^9, 3.7207874365371943`*^9}}],

Cell["\<\
Right now I\[CloseCurlyQuote]m just interested in the case of constant drive, \
so the taylor expansion only has a constant term\
\>", "Text",
 CellChangeTimes->{{3.720787439975534*^9, 3.7207874751904593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Horig", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"H1", "/", "4"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "phi", "]"}], "*", "sx"}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "*", 
       "sy"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Delta", "/", "2"}], "*", "sz"}]}]}]], "Input",
 CellChangeTimes->{{3.720781656785536*^9, 3.720781674585722*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"taylorReplacement", "=", 
   RowBox[{"{", 
    RowBox[{"H1", "\[Rule]", 
     RowBox[{"Hd0", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "-", "t0"}], ")"}], " ", "Hd1"}]}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        SuperscriptBox["t", "2"]}], "/", "2"}], " ", "H1DD"}], "+", 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", "3"], "/", "6"}], " ", "H1DDD"}]}], "}"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", "\[Rule]", "0"}], ",", 
     RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720782341021213*^9, 3.720782408514426*^9}, {
   3.7207828174550657`*^9, 3.7207828460226517`*^9}, {3.720782879688923*^9, 
   3.720782957978816*^9}, {3.7207874199364567`*^9, 3.7207874246413527`*^9}, {
   3.721369507318478*^9, 3.7213695447896433`*^9}, {3.721369820304812*^9, 
   3.721369822823305*^9}, 3.7213698643632402`*^9, {3.721384728536125*^9, 
   3.721384731526524*^9}, {3.721640976333373*^9, 3.7216409836755543`*^9}, {
   3.722149326419242*^9, 3.72214935693607*^9}, {3.722149392031625*^9, 
   3.72214939584789*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hsimple", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Horig", "[", "t", "]"}], "/.", "taylorReplacement"}], "/.", 
   "parameters"}]}]], "Input",
 CellChangeTimes->{{3.720783050759514*^9, 3.720783101982284*^9}, 
   3.7207833240077047`*^9, {3.720783804429677*^9, 3.720783810107931*^9}, {
   3.72214936199796*^9, 3.722149365629217*^9}, {3.722149826031633*^9, 
   3.7221498273903513`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"Hd0", "+", 
    RowBox[{"Hd1", " ", 
     RowBox[{"(", 
      RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"sx", "+", 
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.720783324643635*^9, 3.720783601770975*^9, {3.720783810987912*^9, 
   3.72078382816864*^9}, 3.7207874822820883`*^9, 3.720787514449429*^9, {
   3.7208545940031424`*^9, 3.720854601630086*^9}, 3.7208613579247704`*^9, 
   3.7208711617338953`*^9, 3.720934886856452*^9, 3.720935085964275*^9, {
   3.720942882438242*^9, 3.720942897332395*^9}, 3.7209429450840893`*^9, 
   3.720943012117515*^9, 3.7209433984189663`*^9, 3.720943433879809*^9, {
   3.7209495979769917`*^9, 3.720949621456032*^9}, 3.7209499629823523`*^9, 
   3.721034600606432*^9, {3.721369841434807*^9, 3.7213698674636497`*^9}, 
   3.72138161201311*^9, 3.7213847354601994`*^9, 3.721386295123302*^9, 
   3.7213864354342747`*^9, 3.721395004425582*^9, 3.721499824003375*^9, 
   3.721499930654374*^9, 3.7215436348314047`*^9, 3.7215436770303593`*^9, 
   3.721641010125864*^9, 3.721642338326498*^9, 3.72164240064508*^9, 
   3.72164256669506*^9, 3.7216428158408957`*^9, {3.722149399272449*^9, 
   3.722149402527884*^9}, 3.722149819021014*^9, 3.722150837120495*^9, 
   3.722151421723791*^9, 3.7221520573098497`*^9, 3.7222309325666037`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "Hsimple", "]"}]], "Input",
 CellChangeTimes->{{3.720783304920519*^9, 3.720783310933688*^9}, 
   3.7207838071563997`*^9, 3.722149833377084*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Effective Hamiltonians", "Section",
 CellChangeTimes->{{3.7213912625165873`*^9, 3.721391274414789*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"termHww0", "=", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
      RowBox[{"H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"32", " ", "ww"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Delta", " ", "H1", " ", "sx"}], "+", 
         RowBox[{"H1D", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"H1D", " ", "sx"}], "-", 
         RowBox[{"Delta", " ", "H1", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"256", " ", 
      SuperscriptBox["ww", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"8", " ", "Delta", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
      RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
      RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", 
         RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7213912768379793`*^9, 3.7213913006335983`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"termHww0", "=", 
  RowBox[{"termHww0", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"termHwwM1", "=", 
  RowBox[{"termHwwM1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"termHwwM2", "=", 
  RowBox[{"termHwwM2", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.7221514345050793`*^9, 3.722151489585125*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"H1", " ", "sx"}], "4"]], "Output",
 CellChangeTimes->{{3.722151470227449*^9, 3.722151492194216*^9}, 
   3.7222309351426163`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["H1", "2"], " ", "sz"}], "+", 
   RowBox[{"4", " ", "H1D", " ", "sy", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["H1", "2"], " ", "sz", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
   RowBox[{"4", " ", "H1D", " ", "sx", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], 
  RowBox[{"32", " ", "ww"}]]], "Output",
 CellChangeTimes->{{3.722151470227449*^9, 3.722151492194216*^9}, 
   3.722230935152697*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["H1", "3"], " ", "sx"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["H1", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.722151470227449*^9, 3.722151492194216*^9}, 
   3.7222309351608973`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.7213917280023413`*^9, 3.721391729772744*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Heff", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"termHww0", "+", "termHwwM1", "+", "termHwwM2"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"H1", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}], " ", "Hd1"}]}], ")"}]}], ",", 
      RowBox[{"H1D", "\[Rule]", "Hd1"}], ",", 
      RowBox[{"H1DD", "\[Rule]", "0"}], ",", 
      RowBox[{"H1DDD", "\[Rule]", "0"}]}], "}"}]}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.721391303644435*^9, 3.7213913745294228`*^9}, {
   3.7213917000477457`*^9, 3.7213917011961613`*^9}, {3.721453944575795*^9, 
   3.7214539816917553`*^9}, {3.721454459164365*^9, 3.721454497947255*^9}, {
   3.722149808128591*^9, 3.722149811967021*^9}, {3.722150720936048*^9, 
   3.722150727695092*^9}, 3.722151465569895*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "256"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"64", " ", "sx", " ", 
     RowBox[{"(", 
      RowBox[{"Hd0", "+", 
       RowBox[{"Hd1", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "ww"], 
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sz", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"]}], "+", 
        RowBox[{"4", " ", "Hd1", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sz", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
        RowBox[{"4", " ", "Hd1", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "sx", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", "t"}], "-", 
           RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"]}], "+", 
       RowBox[{"2", " ", "sx", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
       RowBox[{"sx", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", "t"}], "-", 
           RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"Hd0", "+", 
          RowBox[{"Hd1", " ", "t"}], "-", 
          RowBox[{"Hd1", " ", "t0"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"12", " ", "Hd1", " ", "sz"}], "+", 
          RowBox[{"sy", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", "t"}], "-", 
              RowBox[{"Hd1", " ", "t0"}]}], ")"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
       RowBox[{"sy", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Hd0", "+", 
           RowBox[{"Hd1", " ", "t"}], "-", 
           RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.721391357204774*^9, 3.72139137029011*^9}, 
   3.721391407299758*^9, 3.721391722049994*^9, 3.721391752790473*^9, 
   3.721393609067251*^9, 3.721394331840238*^9, 3.721394403281458*^9, 
   3.72139456614291*^9, 3.721394742426331*^9, 3.721395039820836*^9, 
   3.721395485356585*^9, 3.721395972160295*^9, 3.721453999493925*^9, 
   3.721454572731985*^9, 3.721455005523571*^9, 3.7214554959194603`*^9, 
   3.721455599174521*^9, 3.721456014848342*^9, 3.721456228972624*^9, 
   3.721456362267864*^9, 3.72158316719845*^9, 3.7215835145272083`*^9, 
   3.721583845299436*^9, 3.7215839811002417`*^9, 3.721584230747492*^9, 
   3.721625237066875*^9, 3.721625339607917*^9, 3.721625572866763*^9, 
   3.721625751627285*^9, 3.721626211206676*^9, 3.7216267739495173`*^9, 
   3.721627123559272*^9, 3.722150697768116*^9, 3.7221508062361917`*^9, 
   3.722151476368804*^9, 3.7221515191106443`*^9, 3.72223096427557*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.72139167843118*^9, 3.721391681812262*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion for real Hamiltonian", "Section",
 CellChangeTimes->{{3.72149984456395*^9, 3.721499852290381*^9}, {
  3.7221626431366787`*^9, 3.722162649199335*^9}}],

Cell[BoxData[
 RowBox[{"Remove", "[", "\[CapitalOmega]\[CapitalOmega]simple", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7214719822626133`*^9, 3.7214719896931877`*^9}, {
  3.721472353514744*^9, 3.721472354111644*^9}, {3.721499877011467*^9, 
  3.72149987735284*^9}, {3.721583163400134*^9, 3.721583163642398*^9}, {
  3.721641028958159*^9, 3.721641030924942*^9}, {3.722149838537915*^9, 
  3.722149850484721*^9}, {3.722150373418338*^9, 3.7221503811862926`*^9}, {
  3.7221625841509542`*^9, 3.722162584886582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{"JesseGetMagnusIntegrands", "[", 
   RowBox[{"h", ",", "\[CapitalOmega]\[CapitalOmega]simple", ",", "max"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{"MI", "/.", 
   RowBox[{"h", "\[Rule]", 
    RowBox[{"Hsimple", "[", "t", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.721471594711541*^9, 3.721471612498687*^9}, {
   3.72147171132694*^9, 3.7214717650563602`*^9}, {3.721471818875194*^9, 
   3.7214718577305*^9}, {3.721471992456099*^9, 3.7214719926053867`*^9}, {
   3.72147478029744*^9, 3.721474782400672*^9}, {3.721475070506382*^9, 
   3.721475072657221*^9}, {3.7214754970412693`*^9, 3.721475497382984*^9}, {
   3.721481730665987*^9, 3.721481730729863*^9}, {3.7214998793351593`*^9, 
   3.721499879586091*^9}, {3.721583167493902*^9, 3.721583169356577*^9}, 
   3.7215836919134483`*^9, {3.7216252926059504`*^9, 3.721625303081492*^9}, {
   3.721641015366444*^9, 3.7216410342436657`*^9}, 3.7221498543218822`*^9, {
   3.722150249015389*^9, 3.722150249597885*^9}, {3.722150365347493*^9, 
   3.7221503657301064`*^9}, {3.722150826924828*^9, 3.722150827962327*^9}, {
   3.722151143487228*^9, 3.7221511439973087`*^9}, {3.72215139675976*^9, 
   3.722151397413951*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", "h"}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"Commutator", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
       RowBox[{"t", ",", "t0"}], "]"}], ",", "h"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], ",", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "h"}], "]"}]}], "]"}]}], "+", 
    
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "2"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], ",", "h"}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.721625461729014*^9, 3.72162566618536*^9, 3.721625751895653*^9, 
   3.721626231903812*^9, 3.72162682270074*^9, 3.721627123727347*^9, 
   3.721641059666903*^9, 3.721641662738881*^9, 3.721642404828063*^9, 
   3.721642572100339*^9, 3.721642820841197*^9, 3.721643456746017*^9, {
   3.722150817414171*^9, 3.72215084495643*^9}, 3.722151146612533*^9, 
   3.722151398914836*^9, {3.72215204343572*^9, 3.722152061225918*^9}, 
   3.722230978802224*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"Hd0", "+", 
      RowBox[{"Hd1", " ", 
       RowBox[{"(", 
        RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"sx", "+", 
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"Hd0", "+", 
      RowBox[{"Hd1", " ", 
       RowBox[{"(", 
        RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Commutator", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
         RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "48"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"Hd0", "+", 
       RowBox[{"Hd1", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
            RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
           RowBox[{"t", ",", "t0"}], "]"}], ",", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "]"}], 
        " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
           RowBox[{"t", ",", "t0"}], "]"}], ",", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}]}], "]"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"Hd0", "+", 
       RowBox[{"Hd1", " ", 
        RowBox[{"(", 
         RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "2"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], "+", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "2"], "[", 
           RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Commutator", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "2"], "[", 
           RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "t", " ", "ww"}], "]"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.721625461729014*^9, 3.72162566618536*^9, 3.721625751895653*^9, 
   3.721626231903812*^9, 3.72162682270074*^9, 3.721627123727347*^9, 
   3.721641059666903*^9, 3.721641662738881*^9, 3.721642404828063*^9, 
   3.721642572100339*^9, 3.721642820841197*^9, 3.721643456746017*^9, {
   3.722150817414171*^9, 3.72215084495643*^9}, 3.722151146612533*^9, 
   3.722151398914836*^9, {3.72215204343572*^9, 3.722152061225918*^9}, 
   3.7222309788157454`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
       RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
      RowBox[{"JesseDoMagnusIntegration", "[", 
       RowBox[{
        RowBox[{"MI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        SubscriptBox["WWeff", "i"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.721499891942844*^9, {3.721583174720359*^9, 3.72158317504136*^9}, {
   3.721583823315545*^9, 3.72158384151307*^9}, {3.721583901018448*^9, 
   3.7215839042305737`*^9}, 3.7216270486445513`*^9, 3.7216410377051992`*^9, 
   3.722149857373662*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "10", ",", "2"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 10, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722230978882102*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "2"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722230978890924*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 2}, "  trimmed coeffs:  ", 0],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722230978983609*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "2"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.7222309793788853`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "2"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722230979390744*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.7222310237782393`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 3}, "  trimmed coeffs:  ", 0],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.72223102411099*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231033523243*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231033537428*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "10", ",", "3"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 10, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231033614902*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231033629615*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 3}, "  trimmed coeffs:  ", 0],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231034367675*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "4"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.72223104428927*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "4"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231044304782*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231109422687*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "9"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 5}, "  trimmed coeffs:  ", 9],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231109964066*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231131524605*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231131536203*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "10", ",", "5"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231131583181*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231131631117*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "24"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 5}, "  trimmed coeffs:  ", 24],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231146175044*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "13"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 13}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231613336955*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "13"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 13}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231613350191*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "16"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 16}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.7222318022464943`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "16"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "9"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 16}, "  trimmed coeffs:  ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722231804747592*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "23"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 23}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.7222321986176233`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "23"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 23}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.721583848409161*^9, 3.721583911800089*^9, 3.7215839864508753`*^9, 
   3.7215842321811943`*^9, 3.721625249682579*^9, 3.721625461782709*^9, 
   3.721625666334155*^9, 3.721625752142682*^9, 3.721626232050668*^9, 
   3.721626824539298*^9, 3.721627123889007*^9, 3.721641067380924*^9, 
   3.7216416642707567`*^9, 3.721642404894804*^9, 3.721642572165024*^9, 
   3.721642820906042*^9, 3.7216430976522703`*^9, 3.72164314350362*^9, 
   3.721643423900679*^9, 3.721643458881384*^9, {3.722150817489787*^9, 
   3.722150845023341*^9}, 3.722151146699718*^9, {3.7221520435028276`*^9, 
   3.722152061312758*^9}, 3.722232198627923*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", "/", "tc"}], " ", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "1"], "[", 
     RowBox[{
      RowBox[{"ta", "+", "tc"}], ",", "ta"}], "]"}]}], "//", "FS"}], "//", 
  "CWW"}]], "Input",
 CellChangeTimes->{{3.721641265824979*^9, 3.721641273206327*^9}, {
   3.721643572709309*^9, 3.721643576643758*^9}, {3.721643630264494*^9, 
   3.721643661719714*^9}, 3.7221502772472057`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Hd0", " ", "sx"}], "4"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Hd1", " ", "\[Pi]", " ", "sx"}], "+", 
    RowBox[{"Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
    RowBox[{"Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}]}], 
   RowBox[{"8", " ", "ww"}]]}]], "Output",
 CellChangeTimes->{
  3.72164127365403*^9, 3.7216427578617067`*^9, 3.7216429895010977`*^9, {
   3.721643569536502*^9, 3.7216435779658127`*^9}, {3.721643631463893*^9, 
   3.721643662221423*^9}, {3.7221508181453323`*^9, 3.722150830801269*^9}, 
   3.722150900178267*^9, 3.722151254809969*^9, 3.722152044242087*^9, 
   3.722153140207065*^9, 3.722232199471262*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]simple"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.721499946855296*^9, 3.721499973780986*^9}, {
   3.721583179773501*^9, 3.721583184528266*^9}, 3.722149725724958*^9, 
   3.7221502705228167`*^9, {3.72215038604436*^9, 3.722150392675001*^9}, {
   3.722160249165916*^9, 3.722160255243806*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hlinbar", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.721499989961666*^9, 3.721499999299775*^9}, {
  3.721535505319736*^9, 3.721535512229414*^9}, {3.7215831887963543`*^9, 
  3.721583193637969*^9}, {3.722150329187159*^9, 3.722150334340963*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"3072", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
     SuperscriptBox["ww", "3"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"48", " ", "Hd0", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "Hd1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "Hd1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"3", " ", "Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Hd0"}], "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "Hd0"}], "+", 
              RowBox[{"5", " ", "Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], 
               "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"384", " ", "ww", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            "ww"}], "+", 
           RowBox[{"Hd1", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
           RowBox[{"Hd1", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Hd1"}], " ", "sy"}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sx", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Hd1", " ", "sx"}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sy", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}]}], ")"}]}],
      "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"15", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         SuperscriptBox["ta", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"16", " ", "sy", " ", "ta", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         SuperscriptBox["tb", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"3", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "-", 
             RowBox[{"2", " ", "tb"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"12", " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
           RowBox[{"sy", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "15"}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], "2"], " ", 
               SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "sy"}], "+", 
           RowBox[{"2", " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], ")"}], 
         " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
           "ww"}], "]"}]}], "+", 
        RowBox[{"8", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
          ")"}]}], "+", 
        RowBox[{"8", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{"9", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"3", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "-", 
             RowBox[{"2", " ", "tb"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{"9", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"3", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
           "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "+", 
        RowBox[{"8", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.721512125180172*^9, 3.721536689714835*^9, 3.721565056588085*^9, 
   3.721583736652565*^9, 3.721584576198666*^9, 3.7216252559481363`*^9, 
   3.721625467461611*^9, 3.721627596710229*^9, 3.721642757936268*^9, 
   3.721642989567616*^9, {3.722150818292035*^9, 3.7221508309535103`*^9}, 
   3.7221509007787533`*^9, 3.7221512641116667`*^9, 3.722152044378376*^9, 
   3.722153217254322*^9, 3.722232307829605*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Hlinbar"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721499995856163*^9, 3.721500001564535*^9}, {
   3.721583205626096*^9, 3.721583224744295*^9}, {3.721583259957012*^9, 
   3.721583260242675*^9}, 3.722149728125202*^9, {3.7221503373302927`*^9, 
   3.722150339218555*^9}, {3.7221503965733967`*^9, 3.7221504006992083`*^9}, {
   3.722160258549572*^9, 3.722160262464308*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]simple", "i"], "[", 
        RowBox[{"tb", ",", "ta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.722173497816763*^9, 3.722173504817401*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"3072", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"48", " ", "Hd0", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "Hd1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "Hd1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"3", " ", "Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Hd0"}], "+", 
           RowBox[{"Hd1", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "Hd0"}], "+", 
              RowBox[{"5", " ", "Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], 
               "]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"384", " ", "ww", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Hd0"}], "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
            "ww"}], "+", 
           RowBox[{"Hd1", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
           RowBox[{"Hd1", " ", "sx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Hd1"}], " ", "sy"}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sx", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Hd1", " ", "sx"}], "+", 
           RowBox[{"2", " ", "Hd0", " ", "sy", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}]}], ")"}]}],
      "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"15", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         SuperscriptBox["ta", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"16", " ", "sy", " ", "ta", " ", "tb", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         SuperscriptBox["tb", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"3", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "-", 
             RowBox[{"2", " ", "tb"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"12", " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
           RowBox[{"sy", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "15"}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"ta", "-", "tb"}], ")"}], "2"], " ", 
               SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "sy"}], "+", 
           RowBox[{"2", " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], ")"}], 
         " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
           "ww"}], "]"}]}], "+", 
        RowBox[{"8", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
          ")"}]}], "+", 
        RowBox[{"8", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{"9", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"3", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "-", 
             RowBox[{"2", " ", "tb"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{"9", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"3", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
           "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "+", 
        RowBox[{"8", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7221735686565723`*^9, 3.722232395811903*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion for effective Hamiltonian", "Section",
 CellChangeTimes->{{3.722162662772456*^9, 3.722162681096442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\[CapitalOmega]\[CapitalOmega]eff", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722162683579185*^9, 3.7221627113242483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{"JesseGetMagnusIntegrands", "[", 
   RowBox[{"h", ",", "\[CapitalOmega]\[CapitalOmega]eff", ",", "max"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{"MI", "/.", 
   RowBox[{"h", "\[Rule]", 
    RowBox[{"Heff", "[", "t", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.722162714722845*^9, 3.7221627508366327`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", "h"}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"Commutator", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
       RowBox[{"t", ",", "t0"}], "]"}], ",", "h"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", 
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], ",", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "h"}], "]"}]}], "]"}]}], "+", 
    
    RowBox[{
     FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], ",", "h"}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.722162844004499*^9, 3.722232396018928*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "256"]}], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"64", " ", "sx", " ", 
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "ww"], 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sz", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"]}], "+", 
          RowBox[{"4", " ", "Hd1", " ", "sy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
          RowBox[{"2", " ", "sz", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
          RowBox[{"4", " ", "Hd1", " ", "sx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "+", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["ww", "2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "sx", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"]}], "+", 
         RowBox[{"2", " ", "sx", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", 
              RowBox[{"(", 
               RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
         RowBox[{"sx", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", "t"}], "-", 
            RowBox[{"Hd1", " ", "t0"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"12", " ", "Hd1", " ", "sz"}], "+", 
            RowBox[{"sy", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Hd0", "+", 
                RowBox[{"Hd1", " ", "t"}], "-", 
                RowBox[{"Hd1", " ", "t0"}]}], ")"}], "2"]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
         RowBox[{"sy", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   ",", 
   RowBox[{
    FractionBox["1", "512"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"64", " ", 
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "ww"], 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}], "+", 
          RowBox[{"4", " ", "Hd1", " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
          RowBox[{"4", " ", "Hd1", " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "+", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["ww", "2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", 
              RowBox[{"(", 
               RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", "t"}], "-", 
            RowBox[{"Hd1", " ", "t0"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Hd0", "+", 
                RowBox[{"Hd1", " ", "t"}], "-", 
                RowBox[{"Hd1", " ", "t0"}]}], ")"}], "2"], " ", 
             RowBox[{"Commutator", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}]}], "+", 
            RowBox[{"12", " ", "Hd1", " ", 
             RowBox[{"Commutator", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}]}], 
           ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", "3072"], 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"64", " ", 
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", 
            RowBox[{"Commutator", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
               RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "]"}]}],
          "+", 
         RowBox[{
          FractionBox["1", "ww"], 
          RowBox[{"8", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Hd0", "+", 
                 RowBox[{"Hd1", " ", 
                  RowBox[{"(", 
                   RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
              RowBox[{"Commutator", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", 
                RowBox[{"Commutator", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                   "[", 
                   RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}], 
               "]"}]}], "+", 
             RowBox[{"4", " ", "Hd1", " ", 
              RowBox[{"Commutator", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", 
                RowBox[{"Commutator", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                   "[", 
                   RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}]}], 
               "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Hd0", "+", 
                 RowBox[{"Hd1", " ", 
                  RowBox[{"(", 
                   RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
              RowBox[{"Commutator", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", 
                RowBox[{"Commutator", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                   "[", 
                   RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}], 
               "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
             RowBox[{"4", " ", "Hd1", " ", 
              RowBox[{"Commutator", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", 
                RowBox[{"Commutator", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                   "[", 
                   RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], 
               "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["ww", "2"]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Hd0", "+", 
                RowBox[{"Hd1", " ", "t"}], "-", 
                RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
             RowBox[{"Commutator", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}], ",", 
               RowBox[{"Commutator", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                  RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], 
              "]"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Hd0", "+", 
                RowBox[{"Hd1", " ", 
                 RowBox[{"(", 
                  RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
             RowBox[{"Commutator", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}], ",", 
               RowBox[{"Commutator", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                  RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], 
              "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Hd0", "+", 
                RowBox[{"Hd1", " ", "t"}], "-", 
                RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
             RowBox[{"Commutator", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}], ",", 
               RowBox[{"Commutator", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                  RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], 
              "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"Hd0", "+", 
               RowBox[{"Hd1", " ", "t"}], "-", 
               RowBox[{"Hd1", " ", "t0"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"Hd0", "+", 
                   RowBox[{"Hd1", " ", "t"}], "-", 
                   RowBox[{"Hd1", " ", "t0"}]}], ")"}], "2"], " ", 
                RowBox[{"Commutator", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                   "[", 
                   RowBox[{"t", ",", "t0"}], "]"}], ",", 
                  RowBox[{"Commutator", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                    "[", 
                    RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}]}], 
                 "]"}]}], "+", 
               RowBox[{"12", " ", "Hd1", " ", 
                RowBox[{"Commutator", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                   "[", 
                   RowBox[{"t", ",", "t0"}], "]"}], ",", 
                  RowBox[{"Commutator", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], 
                    "[", 
                    RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}], 
                 "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Hd0", "+", 
                RowBox[{"Hd1", " ", "t"}], "-", 
                RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
             RowBox[{"Commutator", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                RowBox[{"t", ",", "t0"}], "]"}], ",", 
               RowBox[{"Commutator", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
                  RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}]}], 
              "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], 
        ")"}]}]}]}], "+", 
    RowBox[{
     FractionBox["1", "512"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"64", " ", 
        RowBox[{"(", 
         RowBox[{"Hd0", "+", 
          RowBox[{"Hd1", " ", 
           RowBox[{"(", 
            RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"Commutator", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
           RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "ww"], 
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Hd0", "+", 
               RowBox[{"Hd1", " ", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
            RowBox[{"Commutator", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
               RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}], "+", 
           RowBox[{"4", " ", "Hd1", " ", 
            RowBox[{"Commutator", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
               RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Hd0", "+", 
               RowBox[{"Hd1", " ", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "2"], " ", 
            RowBox[{"Commutator", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
               RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
           RowBox[{"4", " ", "Hd1", " ", 
            RowBox[{"Commutator", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
               RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "+", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["ww", "2"]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", "t"}], "-", 
              RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "t0"}], ")"}]}]}], ")"}], "3"], " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", "t"}], "-", 
              RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"Hd0", "+", 
             RowBox[{"Hd1", " ", "t"}], "-", 
             RowBox[{"Hd1", " ", "t0"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Hd0", "+", 
                 RowBox[{"Hd1", " ", "t"}], "-", 
                 RowBox[{"Hd1", " ", "t0"}]}], ")"}], "2"], " ", 
              RowBox[{"Commutator", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
                 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}]}], "+", 
             RowBox[{"12", " ", "Hd1", " ", 
              RowBox[{"Commutator", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
                 
                 RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}]}], 
            ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Hd0", "+", 
              RowBox[{"Hd1", " ", "t"}], "-", 
              RowBox[{"Hd1", " ", "t0"}]}], ")"}], "3"], " ", 
           RowBox[{"Commutator", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "2"], "[", 
              RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.722162844004499*^9, 3.722232396069468*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
       RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
      RowBox[{"JesseDoMagnusIntegration", "[", 
       RowBox[{
        RowBox[{"MI", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        SubscriptBox["WWeff", "i"], "[", 
        RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.7221627329169493`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "10", ",", "26"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 10, 26}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232396270553*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "26"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 26}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232396305922*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "26"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "7"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 26}, "  trimmed coeffs:  ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.72223239687475*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232429406557*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232429424097*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324481091623`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "7"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 27}, "  trimmed coeffs:  ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.72223244871262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232462657012*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.72223246267091*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "10", ",", "27"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232463207655*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232463256989*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "31"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 27}, "  trimmed coeffs:  ", 
   31],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232463558042*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232464168106*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232464207303*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324660071077`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "4"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 27}, "  trimmed coeffs:  ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232466025166*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232466064397*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232466118683*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "14", ",", "10", ",", "27"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 14, 10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324665766993`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232466722978*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "30"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 27}, "  trimmed coeffs:  ", 
   30],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.72223246820684*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324682229557`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324682601557`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324682714577`*^9}],

Cell[BoxData["\<\"    > starting trim with empty coefficient list\"\>"], \
"Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232468306142*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 27}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232468317047*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.7222324683273077`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "27"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 27}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722162844152095*^9, 3.722232468362211*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "\[CapitalOmega]\[CapitalOmega]eff"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.722162789261259*^9, 3.7221627894681168`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", "/", "tc"}], " ", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "1"], "[", 
     RowBox[{
      RowBox[{"ta", "+", "tc"}], ",", "ta"}], "]"}]}], "//", "FS"}], "//", 
  "CWW"}]], "Input",
 CellChangeTimes->{{3.722162832046605*^9, 3.722162832325976*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Hd0", " ", "sx"}], "4"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sx"}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], 
   RowBox[{"256", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
     RowBox[{"8", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7221629146279593`*^9, 3.722232474757372*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hlineffbar", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.72216280735779*^9, 3.722162812191296*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
    RowBox[{"8", " ", "Hd0", " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{"Hd0", "+", 
       RowBox[{"Hd1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", "ww"}], 
    "+", 
    RowBox[{"32", " ", "sx", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Hd0"}], "+", 
       RowBox[{"Hd1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["ww", "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
       RowBox[{"16", " ", "Hd1", " ", "sy", " ", "ww"}], "-", 
       RowBox[{"8", " ", "Hd0", " ", "sz", " ", 
        RowBox[{"(", 
         RowBox[{"Hd0", "+", 
          RowBox[{"Hd1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
        "ww"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["Hd0", "3"], " ", "sy"}], "+", 
       RowBox[{"12", " ", "Hd0", " ", "Hd1", " ", "sz"}], "+", 
       RowBox[{"16", " ", "Hd1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.722162916407804*^9, 3.722232475918831*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"saveResult", ",", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "saveFile"}], ",", 
      "Hlineffbar"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Plus", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalOmega]\[CapitalOmega]eff", "i"], "[", 
        RowBox[{"tb", ",", "ta"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}], "//", 
   "S"}]}]}], "Input",
 CellChangeTimes->{
  3.722162821039257*^9, {3.7221734342700043`*^9, 3.7221734711991568`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
      RowBox[{"8", " ", "Hd0", " ", "sz", " ", 
       RowBox[{"(", 
        RowBox[{"Hd0", "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", "ww"}], 
      "+", 
      RowBox[{"32", " ", "sx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Hd0"}], "+", 
         RowBox[{"Hd1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox["ww", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
         RowBox[{"16", " ", "Hd1", " ", "sy", " ", "ww"}], "-", 
         RowBox[{"8", " ", "Hd0", " ", "sz", " ", 
          RowBox[{"(", 
           RowBox[{"Hd0", "+", 
            RowBox[{"Hd1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
          "ww"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Hd0", "3"], " ", "sy"}], "+", 
         RowBox[{"12", " ", "Hd0", " ", "Hd1", " ", "sz"}], "+", 
         RowBox[{"16", " ", "Hd1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.7221734755755463`*^9, 3.722232476857697*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking results", "Section",
 CellChangeTimes->{{3.7213922110718603`*^9, 3.7213922150841417`*^9}, {
  3.721392917805194*^9, 3.7213929303153143`*^9}, {3.722151071374181*^9, 
  3.722151077938756*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hlinbar", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "FS"}], "//", 
   "CWW"}]}]], "Input",
 CellChangeTimes->{{3.7221510798933992`*^9, 3.722151106347843*^9}, {
  3.7221512958929567`*^9, 3.7221512977393*^9}, {3.722163173961741*^9, 
  3.7221631750883703`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Hd0", " ", "sx"}], "4"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sx"}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}]}], 
   RowBox[{"256", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
     RowBox[{"8", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.722151100559236*^9, 3.7221511070706244`*^9}, {
   3.7221512916017227`*^9, 3.722151297979307*^9}, 3.722160294161028*^9, 
   3.7221631824190607`*^9, 3.722234033250651*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hlineffbar", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "t0"}], "]"}], "//", "FS"}], "//", 
   "CWW"}]}]], "Input",
 CellChangeTimes->{{3.7221631279601*^9, 3.722163128182786*^9}, {
  3.722163178843224*^9, 3.722163180297141*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Hd0", " ", "sx"}], "4"], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"32", " ", "Hd1", " ", "\[Pi]", " ", "sx"}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz"}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sy", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["Hd0", "2"], " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"32", " ", "Hd1", " ", "sx", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}]}], 
   RowBox[{"256", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx"}], "+", 
     RowBox[{"8", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Hd0", " ", "Hd1", " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24", " ", "Hd0", " ", "Hd1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Hd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.722163131933634*^9, 3.722163184965001*^9, 
  3.722234039313642*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"test2", "-", "test1"}], "/.", 
  RowBox[{"{", 
   RowBox[{"t0", "\[Rule]", 
    RowBox[{"\[Alpha]0", "/", "ww"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7221631861997843`*^9, 3.722163215569655*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.722163220545313*^9, 3.722234039430532*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jump operators", "Section",
 CellChangeTimes->{{3.72216218339668*^9, 3.722162197273571*^9}}],

Cell[TextData[{
 "We consider the case of a jump in the driving envelope at time tj between \
one linear drive envelope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for t < tj and another linear drive envelope ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for t > tj. We allow for discontinuities in both the envelope value and \
the first derivative. We Taylor expand the driving envelopes around tj. The \
relevant parameters describing the drive envelope are then \n\nt < tj\t\t\t\t\
t > tj\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]]],
 "(tj)\t\tEmd0\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(tj)\t\tEpd0\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "t"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "m"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(tj)\t\tEmd1\t\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", "t"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "p"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(tj)\t\tEpd1\n\nRelevant time evolution operators (in exponent form):\nA\t\
Hmeff(tj) -> Heffm(t0+ktc)\nB\tHmreal(t0+ktc) -> Hmreal(tj)\nC\tHpreal(tj) -> \
Hpreal(t0+(k+1)tc)\nD\tHpeff(t0+(k+1)tc) -> Hpeff(tj)"
}], "Text",
 CellChangeTimes->{{3.722162201642559*^9, 3.722162368367354*^9}, {
  3.7221625236287193`*^9, 3.722162571485042*^9}, {3.7221632329004307`*^9, 
  3.722163344159778*^9}, {3.722164504325034*^9, 3.722164525651071*^9}, {
  3.722165000148678*^9, 3.722165060739952*^9}, {3.722165119451817*^9, 
  3.722165304643661*^9}, {3.7221662505640697`*^9, 3.7221662885776577`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalOmega]A", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
     RowBox[{"t0", ",", "tj"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Hd0", "\[Rule]", "Emd0"}], ",", 
      RowBox[{"Hd1", "\[Rule]", "Emd1"}]}], "}"}]}], "//", "FS"}]}]], "Input",\

 CellChangeTimes->{{3.722165346513688*^9, 3.722165366270275*^9}, {
  3.722166146415406*^9, 3.722166171590048*^9}, {3.722166241552552*^9, 
  3.722166245080381*^9}, {3.722166301916195*^9, 3.722166302417989*^9}, {
  3.722167052649054*^9, 3.722167074665103*^9}, {3.722167632951058*^9, 
  3.7221676410180883`*^9}, {3.722168725842442*^9, 3.722168727553561*^9}, {
  3.72217372443112*^9, 3.722173769639975*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"t0", "-", "tj"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["Emd0", "3"], " ", "sx"}], "+", 
      RowBox[{"8", " ", "Emd0", " ", "sz", " ", 
       RowBox[{"(", 
        RowBox[{"Emd0", "+", 
         RowBox[{"Emd1", " ", "t0"}], "-", 
         RowBox[{"Emd1", " ", "tj"}]}], ")"}], " ", "ww"}], "+", 
      RowBox[{"32", " ", "sx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Emd0"}], "+", 
         RowBox[{"Emd1", " ", "t0"}], "-", 
         RowBox[{"Emd1", " ", "tj"}]}], ")"}], " ", 
       SuperscriptBox["ww", "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Emd0", "3"], " ", "sx"}], "+", 
         RowBox[{"16", " ", "Emd1", " ", "sy", " ", "ww"}], "-", 
         RowBox[{"8", " ", "Emd0", " ", "sz", " ", 
          RowBox[{"(", 
           RowBox[{"Emd0", "+", 
            RowBox[{"Emd1", " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}]}]}], ")"}], " ", "ww"}]}], 
        ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["Emd0", "3"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Emd0", "3"], " ", "sy"}], "+", 
         RowBox[{"12", " ", "Emd0", " ", "Emd1", " ", "sz"}], "+", 
         RowBox[{"16", " ", "Emd1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["Emd0", "3"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.7221737900769176`*^9, 3.722234154024601*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalOmega]B", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
     RowBox[{"t0", ",", "tj"}], "]"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Hd0", "\[Rule]", "Emd0"}], ",", 
     RowBox[{"Hd1", "\[Rule]", "Emd1"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.722166425224987*^9, 3.722166447722316*^9}, {
   3.722167000945086*^9, 3.722167009689746*^9}, {3.722167078169743*^9, 
   3.722167091193595*^9}, 3.7221676463817177`*^9, {3.72216769034193*^9, 
   3.72216771103909*^9}, {3.722173781768188*^9, 3.72217380423955*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"3072", " ", 
     SuperscriptBox["ww", "3"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"48", " ", "Emd0", " ", "sz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "Emd1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Emd0"}], "+", 
               RowBox[{"3", " ", "Emd1", " ", 
                RowBox[{"(", 
                 RowBox[{"t0", "-", "tj"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}], " ", 
             SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "Emd1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Emd0"}], "+", 
               RowBox[{"Emd1", " ", 
                RowBox[{"(", 
                 RowBox[{"t0", "-", "tj"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}], " ", 
             SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"ww", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "Emd0"}], "+", 
               RowBox[{"5", " ", "Emd1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "t0"}], "+", "tj"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Emd0", "+", 
               RowBox[{"Emd1", " ", 
                RowBox[{"(", 
                 RowBox[{"t0", "-", "tj"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "t0"}], "+", "tj"}], ")"}], " ", "ww"}], "+", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Emd0"}], "+", 
            RowBox[{"Emd1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "t0"}], "+", "tj"}], ")"}]}]}], ")"}], " ", "ww", 
          " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"384", " ", "ww", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Emd0"}], "+", 
               RowBox[{"Emd1", " ", 
                RowBox[{"(", 
                 RowBox[{"t0", "-", "tj"}], ")"}]}]}], ")"}], " ", "ww"}], 
            "+", 
            RowBox[{"Emd1", " ", "sy", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
            RowBox[{"Emd1", " ", "sx", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Emd1"}], " ", "sy"}], "+", 
            RowBox[{"2", " ", "Emd0", " ", "sx", " ", "ww"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Emd1", " ", "sx"}], "+", 
            RowBox[{"2", " ", "Emd0", " ", "sy", " ", "ww"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], 
        ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["Emd0", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"12", " ", "sx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "t0"}], "+", "tj"}], ")"}], " ", "ww"}], "+", 
            RowBox[{"sy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "15"}], "+", 
               RowBox[{"8", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "t0"}], "+", "tj"}], ")"}], "2"], " ", 
                SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "sy"}], "+", 
            RowBox[{"2", " ", "sx", " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "-", 
              RowBox[{"2", " ", "tj"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
         RowBox[{"8", " ", "sx", " ", 
          RowBox[{"(", 
           RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], 
           ")"}]}], "+", 
         RowBox[{"15", " ", "sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sx", " ", "t0", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sx", " ", "tj", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"8", " ", "sy", " ", 
          SuperscriptBox["t0", "2"], " ", 
          SuperscriptBox["ww", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"16", " ", "sy", " ", "t0", " ", "tj", " ", 
          SuperscriptBox["ww", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"8", " ", "sy", " ", 
          SuperscriptBox["tj", "2"], " ", 
          SuperscriptBox["ww", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"3", " ", "sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"2", " ", "sx", " ", "t0", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", "sx", " ", "tj", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "t0"}], "+", "tj"}], ")"}], " ", 
            "ww"}], "]"}]}], "+", 
         RowBox[{"8", " ", "sx", " ", 
          RowBox[{"(", 
           RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
         RowBox[{"9", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sy", " ", "t0", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sy", " ", "tj", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"3", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", "sy", " ", "t0", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"2", " ", "sy", " ", "tj", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "-", 
              RowBox[{"2", " ", "tj"}]}], ")"}], " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
         RowBox[{"9", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sy", " ", "t0", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sy", " ", "tj", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"3", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", "sy", " ", "t0", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"2", " ", "sy", " ", "tj", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "t0"}], "+", "tj"}], ")"}], " ", 
            "ww"}], "]"}]}], "+", 
         RowBox[{"8", " ", "sy", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "t0"}], "+", "tj"}], ")"}], " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.7221669953715467`*^9, 3.7221670126394453`*^9}, 
   3.722167093050021*^9, 3.72216766071357*^9, 3.722167786676305*^9, 
   3.722173814616227*^9, 3.722234154411138*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalOmega]C", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalOmega]\[CapitalOmega]realsum", "[", 
     RowBox[{
      RowBox[{"t0", "+", "tc"}], ",", "tj"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Hd0", "\[Rule]", "Epd0"}], ",", 
      RowBox[{"Hd1", "\[Rule]", "Epd1"}]}], "}"}]}], "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.722167019705962*^9, 3.722167032424327*^9}, {
   3.7221673901970463`*^9, 3.7221674359406357`*^9}, 3.722167647628875*^9, 
   3.722173836812299*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"3072", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"48", " ", "Epd0", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "Epd1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Epd0", " ", "ww"}], "+", 
              RowBox[{"3", " ", "Epd1", " ", 
               RowBox[{"(", 
                RowBox[{"\[Pi]", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}],
              ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "Epd1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Epd0", " ", "ww"}], "+", 
              RowBox[{"Epd1", " ", 
               RowBox[{"(", 
                RowBox[{"\[Pi]", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}],
              ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Epd0", " ", "ww"}], "+", 
           RowBox[{"5", " ", "Epd1", " ", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Epd0", " ", "ww"}], "+", 
           RowBox[{"Epd1", " ", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], ")"}]}],
         "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Epd0", " ", "ww"}], "-", 
           RowBox[{"Epd1", " ", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"384", " ", "ww", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Epd1", " ", "sy", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
           RowBox[{"sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "Epd0", " ", "ww"}], "+", 
              RowBox[{"Epd1", " ", 
               RowBox[{"(", 
                RowBox[{"\[Pi]", "+", 
                 RowBox[{"t0", " ", "ww"}], "-", 
                 RowBox[{"tj", " ", "ww"}]}], ")"}]}], "+", 
              RowBox[{"Epd1", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Epd1"}], " ", "sy"}], "+", 
           RowBox[{"2", " ", "Epd0", " ", "sx", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Epd1", " ", "sx"}], "+", 
           RowBox[{"2", " ", "Epd0", " ", "sy", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], ")"}]}],
      "+", 
     RowBox[{
      SuperscriptBox["Epd0", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "12"}], " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}], "+", 
           RowBox[{"sy", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "15"}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Pi]", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], 
                "2"]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Pi]", " ", "sx"}], "-", 
           RowBox[{"3", " ", "sy"}], "+", 
           RowBox[{"2", " ", "sx", " ", 
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"t0", "-", 
             RowBox[{"2", " ", "tj"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{"8", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], ")"}]}],
         "+", 
        RowBox[{"15", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sx", " ", "tj", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         SuperscriptBox["tj", "2"], " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"16", " ", "sy", " ", "tj", " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Pi]", "+", 
            RowBox[{"t0", " ", "ww"}]}], ")"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"3", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sx", " ", "tj", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"8", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"4", " ", "t0", " ", "ww"}], "-", 
           RowBox[{"2", " ", "tj", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"9", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sy", " ", "tj", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"3", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sy", " ", "tj", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"t0", "-", 
             RowBox[{"2", " ", "tj"}]}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{"9", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"12", " ", "sy", " ", "tj", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"12", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"3", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"2", " ", "sy", " ", "tj", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{"t0", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"8", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"4", " ", "t0", " ", "ww"}], "-", 
           RowBox[{"2", " ", "tj", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.7221674663920794`*^9, 3.72216768147828*^9, 
  3.7221677923102083`*^9, 3.722173870665699*^9, 3.722234195544085*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalOmega]D", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[CapitalOmega]\[CapitalOmega]effsum", "[", 
      RowBox[{
       RowBox[{"t0", "+", "tc"}], ",", "tj"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Hd0", "\[Rule]", "Epd0"}], ",", 
      RowBox[{"Hd1", "\[Rule]", "Epd1"}]}], "}"}]}], "//", "FS"}]}]], "Input",\

 CellChangeTimes->{{3.722167800464551*^9, 3.722167881986027*^9}, {
  3.722173871685955*^9, 3.722173879242647*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "3"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Epd0", "3"], " ", "sx"}], "+", 
     RowBox[{"8", " ", "Epd0", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Epd0", " ", "ww"}], "+", 
        RowBox[{"Epd1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"32", " ", "sx", " ", "ww", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Epd0", " ", "ww"}], "+", 
        RowBox[{"Epd1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Pi]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["Epd0", "3"], " ", "sx"}], "+", 
        RowBox[{"16", " ", "Epd1", " ", "sy", " ", "ww"}], "-", 
        RowBox[{"8", " ", "Epd0", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Epd0", " ", "ww"}], "+", 
           RowBox[{"Epd1", " ", 
            RowBox[{"(", 
             RowBox[{"\[Pi]", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Epd0", "3"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["Epd0", "3"], " ", "sy"}], "+", 
        RowBox[{"12", " ", "Epd0", " ", "Epd1", " ", "sz"}], "+", 
        RowBox[{"16", " ", "Epd1", " ", "sx", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Epd0", "3"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.722167942148494*^9, 3.7221739449566517`*^9, 
  3.722234263959569*^9}]
}, Open  ]],

Cell["\<\
Intermezzo: let\[CloseCurlyQuote]s look at the 1/ww^0 terms of these little \
friends and check if they correspond to the rotating wave approximation of \
the problem. In particular, the sum of all these coefficients come out to \
zero in the RWA.\
\>", "Text",
 CellChangeTimes->{{3.7221683156712313`*^9, 3.722168382826825*^9}, {
  3.72216846800807*^9, 3.7221684680541477`*^9}, {3.7221687909478273`*^9, 
  3.722168822530778*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ww0A", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]A", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0B", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]B", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0C", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]C", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ww0D", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"\[CapitalOmega]D", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7221684766451597`*^9, 3.7221685168557587`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "256"]}], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"t0", "-", "tj"}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"64", " ", "Emd0", " ", "sx"}], "+", 
    RowBox[{"32", " ", "Emd1", " ", "sx", " ", "t0"}], "-", 
    RowBox[{"32", " ", "Emd1", " ", "sx", " ", "tj"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7221684921392603`*^9, 3.722168518422386*^9}, 
   3.722168665577197*^9, 3.7221687495512877`*^9, 3.722173972729033*^9, 
   3.7222344468687363`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "768"}], " ", "Emd0", " ", "sx", " ", "t0"}], "-", 
      RowBox[{"384", " ", "Emd1", " ", "sx", " ", 
       SuperscriptBox["t0", "2"]}], "+", 
      RowBox[{"768", " ", "Emd0", " ", "sx", " ", "tj"}], "+", 
      RowBox[{"768", " ", "Emd1", " ", "sx", " ", "t0", " ", "tj"}], "-", 
      RowBox[{"384", " ", "Emd1", " ", "sx", " ", 
       SuperscriptBox["tj", "2"]}]}], ")"}]}], "3072"]}]], "Output",
 CellChangeTimes->{{3.7221684921392603`*^9, 3.722168518422386*^9}, 
   3.722168665577197*^9, 3.7221687495512877`*^9, 3.722173972729033*^9, 
   3.722234446881423*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "768"}], " ", "Epd0", " ", "sx", " ", "t0"}], "-", 
     RowBox[{"384", " ", "Epd1", " ", "sx", " ", 
      SuperscriptBox["t0", "2"]}], "+", 
     RowBox[{"768", " ", "Epd0", " ", "sx", " ", "tj"}], "+", 
     RowBox[{"768", " ", "Epd1", " ", "sx", " ", "t0", " ", "tj"}], "-", 
     RowBox[{"384", " ", "Epd1", " ", "sx", " ", 
      SuperscriptBox["tj", "2"]}]}], ")"}]}], "3072"]], "Output",
 CellChangeTimes->{{3.7221684921392603`*^9, 3.722168518422386*^9}, 
   3.722168665577197*^9, 3.7221687495512877`*^9, 3.722173972729033*^9, 
   3.7222344468900127`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "256"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"64", " ", "Epd0", " ", "sx", " ", "t0"}], "+", 
    RowBox[{"32", " ", "Epd1", " ", "sx", " ", 
     SuperscriptBox["t0", "2"]}], "-", 
    RowBox[{"64", " ", "Epd0", " ", "sx", " ", "tj"}], "-", 
    RowBox[{"64", " ", "Epd1", " ", "sx", " ", "t0", " ", "tj"}], "+", 
    RowBox[{"32", " ", "Epd1", " ", "sx", " ", 
     SuperscriptBox["tj", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7221684921392603`*^9, 3.722168518422386*^9}, 
   3.722168665577197*^9, 3.7221687495512877`*^9, 3.722173972729033*^9, 
   3.722234446900728*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ww0A", "+", "ww0B", "+", "ww0C", "+", "ww0D"}], "//", 
  "FS"}]], "Input",
 CellChangeTimes->{{3.7221684948786907`*^9, 3.722168495038825*^9}, {
  3.722168691833044*^9, 3.722168702358116*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.722168699366507*^9, 3.722168702639131*^9}, 
   3.722168752440289*^9, 3.722173975897114*^9, 3.722234449525591*^9}]
}, Open  ]],

Cell["\<\
Now, we\[CloseCurlyQuote]re interested in calculating
exp[D] exp[C] exp[B] exp[A]
up to the order 1/ww^k using the BCH formula\
\>", "Text",
 CellChangeTimes->{{3.722168152176427*^9, 3.722168185835939*^9}, {
  3.7221682195011463`*^9, 3.722168244397887*^9}, {3.722169010340488*^9, 
  3.722169014097417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"jumpOrder", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.722234457236*^9, 3.722234490304687*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intm1", "=", 
   RowBox[{"BCHFormula", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]B", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]0", "\[Rule]", 
        RowBox[{"ww", " ", "t0"}]}], "}"}]}], ",", 
     RowBox[{"\[CapitalOmega]A", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]0", "\[Rule]", 
        RowBox[{"ww", " ", "t0"}]}], "}"}]}], ",", "jumpOrder"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.722173302156135*^9, 3.7221733089856577`*^9}, {
   3.722174252182576*^9, 3.722174255557392*^9}, 3.722174401833724*^9, 
   3.7222344678103733`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intm1aa", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{"intm1", ",", 
     RowBox[{"{", 
      RowBox[{"ww", ",", "t0", ",", "tj"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7221690359664183`*^9, 3.7221690841480827`*^9}, {
   3.722170326867598*^9, 3.7221703587814827`*^9}, {3.722171843198648*^9, 
   3.722171864397112*^9}, {3.72217243948855*^9, 3.72217246088835*^9}, {
   3.722172830228812*^9, 3.7221728338029633`*^9}, {3.7221732897940483`*^9, 
   3.722173338490316*^9}, {3.7221740192887573`*^9, 3.72217403246246*^9}, 
   3.722174403409802*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"intm1a", "=", " ", 
   RowBox[{"JesseGrim", "[", 
    RowBox[{"intm1aa", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "ww"}], ",", "t0", ",", "tj"}], "}"}], ",", 
     "jumpOrder", ",", "Simplify", ",", "Identity"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.722169079031921*^9, 3.722169079867082*^9}, {
   3.722169218904085*^9, 3.722169241961361*^9}, {3.722169419592195*^9, 
   3.722169422175951*^9}, {3.722169776347947*^9, 3.722169803602852*^9}, {
   3.722169937096436*^9, 3.722169940222554*^9}, {3.722170116406246*^9, 
   3.722170121764971*^9}, {3.722170175016096*^9, 3.72217017844672*^9}, {
   3.722170252130224*^9, 3.722170274915612*^9}, {3.722170347294766*^9, 
   3.7221703670168877`*^9}, {3.722170506730535*^9, 3.722170507771306*^9}, {
   3.7221713083157387`*^9, 3.7221713319573603`*^9}, {3.722171489803194*^9, 
   3.722171513402014*^9}, 3.7221715812538*^9, {3.722171818004698*^9, 
   3.7221718213232*^9}, {3.722171876839099*^9, 3.722171878395033*^9}, {
   3.722172416737348*^9, 3.722172421047756*^9}, {3.7221724627709827`*^9, 
   3.722172463312025*^9}, {3.722172617143289*^9, 3.7221726373874607`*^9}, {
   3.722172720247501*^9, 3.7221727211589317`*^9}, {3.722172823036716*^9, 
   3.722172852699176*^9}, {3.7221733234826193`*^9, 3.7221733236273603`*^9}, {
   3.722174286150304*^9, 3.722174286886235*^9}, 3.7222344695145617`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"11", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "38"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {11, 2}, "  trimmed coeffs:  ", 38],
  Editable->False]], "Print",
 CellChangeTimes->{3.722174288360156*^9, 3.722234573875639*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"11", ",", "2"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {11, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722174288360156*^9, 3.7222345738870153`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["intm1a"], "Input",
 CellChangeTimes->{{3.7221744708046703`*^9, 3.7221744722925997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"3072", " ", 
     SuperscriptBox["ww", "3"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "Emd0", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", " ", 
          SuperscriptBox["Emd0", "2"], " ", "sy"}], "+", 
         RowBox[{"48", " ", "Emd1", " ", "sz"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["Emd0", "2"], " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"t0", "-", 
           RowBox[{"2", " ", "tj"}]}], ")"}], " ", "ww"}], "]"}]}], "-", 
      RowBox[{"15", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"144", " ", "Emd1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["Emd0", "2"], " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "t0"}], "+", "tj"}], ")"}], " ", "ww"}], 
        "]"}]}], "-", 
      RowBox[{"9", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"4", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"t0", "-", 
           RowBox[{"2", " ", "tj"}]}], ")"}], " ", "ww"}], "]"}]}], "+", 
      RowBox[{"12", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"4", " ", "tj", " ", "ww"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["Emd0", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "t0"}], "+", "tj"}], ")"}], " ", "ww"}], 
        "]"}]}]}], ")"}]}]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "Emd0", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"64", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"8", " ", "Emd1", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"8", " ", "Emd1", " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.722174472495718*^9, 3.72223457777359*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"intm2", "=", 
   RowBox[{"BCHFormula", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]C", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]0", "\[Rule]", 
        RowBox[{"ww", " ", "t0"}]}], "}"}]}], ",", "intm1a", ",", 
     "jumpOrder"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7221726771231728`*^9, 3.722172754560417*^9}, {
   3.722174392508253*^9, 3.722174423130657*^9}, 3.722234473698429*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intm2aa", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{"intm2", ",", 
     RowBox[{"{", 
      RowBox[{"ww", ",", "t0", ",", "tj"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.722174426177133*^9, 3.72217444408445*^9}, {
  3.722234688607121*^9, 3.7222346892858973`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"intm2a", "=", 
   RowBox[{"JesseGrim", "[", 
    RowBox[{"intm2aa", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "ww"}], ",", "t0", ",", "tj"}], "}"}], ",", 
     "jumpOrder", ",", "Simplify", ",", "Identity"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.722172725693432*^9, 3.722172742631916*^9}, {
   3.7221744482286367`*^9, 3.722174457975864*^9}, {3.7221745360549297`*^9, 
   3.722174538037299*^9}, 3.722234475417832*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"11", ",", "6"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "29"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {11, 6}, "  trimmed coeffs:  ", 29],
  Editable->False]], "Print",
 CellChangeTimes->{3.722172743292438*^9, 3.7221744842877607`*^9, 
  3.722234810187305*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"11", ",", "6"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {11, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722172743292438*^9, 3.7221744842877607`*^9, 
  3.722234810202497*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intm2b", "=", 
  RowBox[{"intm2a", "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.722172746518795*^9, 3.722172748832035*^9}, {
  3.722174501159768*^9, 3.7221745025082808`*^9}, {3.7221745392298*^9, 
  3.722174547910725*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.722172749717474*^9, {3.722174488340127*^9, 3.7221745110211773`*^9}, 
   3.72217454826047*^9, 3.7222355701604958`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"intm3", "=", 
   RowBox[{"BCHFormula", "[", 
    RowBox[{
     RowBox[{"\[CapitalOmega]D", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]0", "\[Rule]", 
        RowBox[{"ww", " ", "t0"}]}], "}"}]}], ",", "intm2b", ",", 
     "jumpOrder"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.722174551880616*^9, 3.722174595920012*^9}, 
   3.722234478234276*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"intm3aa", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{"intm3", ",", 
     RowBox[{"{", 
      RowBox[{"ww", ",", "t0", ",", "tj"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.722174601656261*^9, 3.722174615623949*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"intm3a", "=", 
   RowBox[{"JesseGrim", "[", 
    RowBox[{"intm3aa", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "ww"}], ",", "t0", ",", "tj"}], "}"}], ",", 
     "jumpOrder", ",", "Simplify", ",", "Identity"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.722174618319051*^9, 3.722174638969968*^9}, 
   3.722234479562789*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"18", ",", "24"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "13"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {18, 24}, "  trimmed coeffs:  ", 
   13],
  Editable->False]], "Print",
 CellChangeTimes->{3.7221746407706337`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and FULL simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"18", ",", "24"}], "}"}]}],
  SequenceForm["    > assembling and FULL simplifying done: ", {18, 24}],
  Editable->False]], "Print",
 CellChangeTimes->{3.722174640773364*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intm3b", "=", 
  RowBox[{"intm3a", "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.722174646424939*^9, 3.722174654840432*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["Epd0", "2"], " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"8", " ", "Emd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
     RowBox[{"8", " ", "Epd1", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["Epd0", "2"], " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["Emd0", "2"], " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["Epd0", "2"], " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"8", " ", "Emd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
     RowBox[{"8", " ", "Epd1", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      RowBox[{"(", 
       RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", "ww", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
        RowBox[{"sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.722174657490871*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jlin", "=", "intm3b"}]], "Input",
 CellChangeTimes->{{3.7221746694512987`*^9, 3.722174673641407*^9}, {
  3.722235173023079*^9, 3.722235173430215*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Emd1", " ", "sx"}], "-", 
        RowBox[{"2", " ", "Epd1", " ", "sx"}], "+", 
        RowBox[{
         SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", "sz"}], "+", 
        RowBox[{"4", " ", "Emd0", " ", "sy", " ", "ww"}], "-", 
        RowBox[{"4", " ", "Epd0", " ", "sy", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "t0", " ", "ww"}], "]"}], "-", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], ")"}]}], "-", 
     RowBox[{"sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}], "-", 
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Emd1", " ", "sy"}], "-", 
        RowBox[{"Epd1", " ", "sy"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Emd0"}], "+", "Epd0"}], ")"}], " ", "sx", " ", 
         "ww"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "t0", " ", "ww"}], "]"}], "-", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.722174695550111*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jlin", "//", "CWW"}]], "Input",
 CellChangeTimes->{{3.722174742800955*^9, 3.722174746429471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"64", " ", "ww"}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Emd0", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"8", " ", "Epd0", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"8", " ", "Emd0", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"8", " ", "Epd0", " ", "sy", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Emd0"}], "+", "Epd0"}], ")"}], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"8", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "Emd0"}], "+", "Epd0"}], ")"}], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}]}], ")"}]}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"64", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "Emd1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Epd1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Emd1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Epd1", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Emd1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Epd1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"sz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["Epd0", "2"], " ", "\[Pi]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"Emd0", "+", "Epd0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "t0", " ", "ww"}], "]"}]}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"4", " ", "Emd1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Epd1", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "tj", " ", "ww"}], "]"}]}]}], ")"}]}]}]}]], "Output",\

 CellChangeTimes->{3.722174746972005*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jlin", ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.722174801258543*^9, 3.722174825950988*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"Emd0", "-", "Epd0"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t0", "-", "tj"}], ")"}], " ", "ww"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t0", "+", "tj"}], ")"}], " ", "ww"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.722174809305271*^9, 3.722174826640809*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Emd0", "\[Rule]", "0"}], ",", 
    RowBox[{"tj", "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.722174844006703*^9, 3.7221748751358232`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "Epd0", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"t0", " ", "ww"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"t0", " ", "ww"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"t0", " ", "ww"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.722174885347927*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 819},
WindowMargins->{{-939, Automatic}, {-21, Automatic}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 70, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[653, 26, 95, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[773, 31, 285, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[1083, 41, 1944, 27, 22, "Print"],
Cell[3030, 70, 2029, 30, 22, "Print"],
Cell[5062, 102, 1941, 27, 22, "Print"],
Cell[7006, 131, 3079, 74, 665, "Print"]
}, Open  ]]
}, Open  ]],
Cell[10112, 209, 962, 23, 63, "Input"],
Cell[11077, 234, 321, 7, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11435, 246, 274, 3, 64, "Section"],
Cell[11712, 251, 220, 4, 30, "Text"],
Cell[11935, 257, 745, 23, 46, "Input"],
Cell[12683, 282, 1266, 33, 51, "Input"],
Cell[CellGroupData[{
Cell[13974, 319, 437, 10, 28, "Input"],
Cell[14414, 331, 1572, 31, 47, "Output"]
}, Open  ]],
Cell[16001, 365, 192, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16230, 373, 109, 1, 64, "Section"],
Cell[16342, 376, 4486, 124, 282, "Input"],
Cell[CellGroupData[{
Cell[20853, 504, 694, 19, 63, "Input"],
Cell[21550, 525, 167, 4, 47, "Output"],
Cell[21720, 531, 624, 17, 50, "Output"],
Cell[22347, 550, 1317, 36, 73, "Output"]
}, Open  ]],
Cell[23679, 589, 129, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[23833, 595, 927, 22, 63, "Input"],
Cell[24763, 619, 4052, 104, 166, "Output"]
}, Open  ]],
Cell[28830, 726, 138, 2, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29005, 733, 182, 2, 64, "Section"],
Cell[29190, 737, 507, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[29722, 749, 1391, 26, 80, "Input"],
Cell[31116, 777, 1647, 42, 121, "Output"],
Cell[32766, 821, 5108, 136, 224, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37911, 962, 1030, 28, 98, "Input"],
Cell[CellGroupData[{
Cell[38966, 994, 1023, 19, 38, "Print"],
Cell[39992, 1015, 874, 16, 22, "Print"],
Cell[40869, 1033, 1028, 21, 22, "Print"],
Cell[41900, 1056, 926, 17, 22, "Print"],
Cell[42829, 1075, 864, 16, 22, "Print"],
Cell[43696, 1093, 906, 16, 22, "Print"],
Cell[44605, 1111, 1027, 21, 22, "Print"],
Cell[45635, 1134, 924, 17, 22, "Print"],
Cell[46562, 1153, 890, 16, 22, "Print"],
Cell[47455, 1171, 1023, 19, 38, "Print"],
Cell[48481, 1192, 874, 16, 22, "Print"],
Cell[49358, 1210, 1028, 21, 22, "Print"],
Cell[50389, 1233, 923, 17, 22, "Print"],
Cell[51315, 1252, 864, 16, 22, "Print"],
Cell[52182, 1270, 904, 16, 22, "Print"],
Cell[53089, 1288, 1028, 21, 22, "Print"],
Cell[54120, 1311, 924, 17, 22, "Print"],
Cell[55047, 1330, 890, 16, 22, "Print"],
Cell[55940, 1348, 1023, 19, 38, "Print"],
Cell[56966, 1369, 874, 16, 22, "Print"],
Cell[57843, 1387, 1027, 20, 22, "Print"],
Cell[58873, 1409, 926, 17, 22, "Print"],
Cell[59802, 1428, 866, 16, 22, "Print"],
Cell[60671, 1446, 908, 16, 22, "Print"],
Cell[61582, 1464, 1027, 20, 22, "Print"],
Cell[62612, 1486, 928, 17, 22, "Print"],
Cell[63543, 1505, 892, 16, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64484, 1527, 471, 12, 31, "Input"],
Cell[64958, 1541, 800, 19, 48, "Output"]
}, Open  ]],
Cell[65773, 1563, 550, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[66348, 1580, 773, 21, 31, "Input"],
Cell[67124, 1603, 12043, 316, 364, "Output"]
}, Open  ]],
Cell[79182, 1922, 597, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[79804, 1939, 544, 15, 31, "Input"],
Cell[80351, 1956, 11608, 307, 362, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92008, 2269, 137, 1, 64, "Section"],
Cell[92148, 2272, 180, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[92353, 2280, 544, 14, 80, "Input"],
Cell[92900, 2296, 1234, 35, 121, "Output"],
Cell[94137, 2333, 24395, 618, 1025, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118569, 2956, 806, 24, 97, "Input"],
Cell[CellGroupData[{
Cell[119400, 2984, 449, 10, 38, "Print"],
Cell[119852, 2996, 300, 7, 22, "Print"],
Cell[120155, 3005, 450, 11, 22, "Print"],
Cell[120608, 3018, 350, 8, 22, "Print"],
Cell[120961, 3028, 290, 7, 22, "Print"],
Cell[121254, 3037, 332, 7, 22, "Print"],
Cell[121589, 3046, 450, 11, 22, "Print"],
Cell[122042, 3059, 350, 8, 22, "Print"],
Cell[122395, 3069, 315, 7, 22, "Print"],
Cell[122713, 3078, 449, 10, 38, "Print"],
Cell[123165, 3090, 300, 7, 22, "Print"],
Cell[123468, 3099, 457, 12, 22, "Print"],
Cell[123928, 3113, 350, 8, 22, "Print"],
Cell[124281, 3123, 290, 7, 22, "Print"],
Cell[124574, 3132, 332, 7, 22, "Print"],
Cell[124909, 3141, 451, 11, 22, "Print"],
Cell[125363, 3154, 350, 8, 22, "Print"],
Cell[125716, 3164, 316, 7, 22, "Print"],
Cell[126035, 3173, 451, 10, 38, "Print"],
Cell[126489, 3185, 300, 7, 22, "Print"],
Cell[126792, 3194, 456, 12, 22, "Print"],
Cell[127251, 3208, 352, 8, 22, "Print"],
Cell[127606, 3218, 292, 7, 22, "Print"],
Cell[127901, 3227, 332, 7, 22, "Print"],
Cell[128236, 3236, 147, 2, 22, "Print"],
Cell[128386, 3240, 451, 11, 22, "Print"],
Cell[128840, 3253, 352, 8, 22, "Print"],
Cell[129195, 3263, 316, 7, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[129538, 3274, 351, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[129914, 3287, 344, 10, 28, "Input"],
Cell[130261, 3299, 2066, 54, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132364, 3358, 626, 19, 28, "Input"],
Cell[132993, 3379, 2018, 60, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135048, 3444, 832, 24, 46, "Input"],
Cell[135883, 3470, 2272, 65, 117, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138204, 3541, 205, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[138434, 3548, 369, 10, 28, "Input"],
Cell[138806, 3560, 2138, 54, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140981, 3619, 317, 9, 28, "Input"],
Cell[141301, 3630, 1999, 53, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143337, 3688, 237, 6, 28, "Input"],
Cell[143577, 3696, 92, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[143718, 3703, 98, 1, 64, "Section"],
Cell[143819, 3706, 1901, 50, 291, "Text"],
Cell[CellGroupData[{
Cell[145745, 3760, 740, 16, 28, "Input"],
Cell[146488, 3778, 2131, 58, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148656, 3841, 607, 13, 28, "Input"],
Cell[149266, 3856, 11776, 299, 376, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161079, 4160, 530, 13, 28, "Input"],
Cell[161612, 4175, 13226, 352, 423, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174875, 4532, 502, 14, 28, "Input"],
Cell[175380, 4548, 2571, 75, 111, "Output"]
}, Open  ]],
Cell[177966, 4626, 440, 8, 49, "Text"],
Cell[CellGroupData[{
Cell[178431, 4638, 735, 17, 80, "Input"],
Cell[179169, 4657, 540, 13, 48, "Output"],
Cell[179712, 4672, 714, 16, 52, "Output"],
Cell[180429, 4690, 687, 15, 52, "Output"],
Cell[181119, 4707, 658, 14, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181814, 4726, 226, 5, 28, "Input"],
Cell[182043, 4733, 164, 2, 28, "Output"]
}, Open  ]],
Cell[182222, 4738, 316, 7, 68, "Text"],
Cell[182541, 4747, 138, 3, 28, "Input"],
Cell[182682, 4752, 607, 16, 28, "Input"],
Cell[183292, 4770, 597, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[183914, 4787, 1398, 24, 28, "Input"],
Cell[CellGroupData[{
Cell[185337, 4815, 451, 11, 22, "Print"],
Cell[185791, 4828, 350, 8, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186190, 4842, 102, 1, 28, "Input"],
Cell[186295, 4845, 5160, 145, 274, "Output"]
}, Open  ]],
Cell[191470, 4993, 445, 11, 28, "Input"],
Cell[191918, 5006, 320, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[192263, 5019, 486, 12, 28, "Input"],
Cell[CellGroupData[{
Cell[192774, 5035, 478, 12, 22, "Print"],
Cell[193255, 5049, 375, 9, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193679, 5064, 247, 5, 28, "Input"],
Cell[193929, 5071, 177, 3, 28, "Output"]
}, Open  ]],
Cell[194121, 5077, 397, 11, 28, "Input"],
Cell[194521, 5090, 270, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[194816, 5102, 386, 11, 28, "Input"],
Cell[CellGroupData[{
Cell[195227, 5117, 437, 12, 22, "Print"],
Cell[195667, 5131, 328, 8, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196044, 5145, 149, 3, 28, "Input"],
Cell[196196, 5150, 3950, 111, 168, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200183, 5266, 174, 3, 28, "Input"],
Cell[200360, 5271, 2464, 69, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202861, 5345, 121, 2, 28, "Input"],
Cell[202985, 5349, 3944, 101, 212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206966, 5455, 218, 5, 28, "Input"],
Cell[207187, 5462, 683, 22, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207907, 5489, 231, 6, 28, "Input"],
Cell[208141, 5497, 456, 14, 47, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
