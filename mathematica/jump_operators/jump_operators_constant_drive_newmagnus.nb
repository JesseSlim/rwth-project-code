(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    265329,       6953]
NotebookOptionsPosition[    257455,       6690]
NotebookOutlinePosition[    257811,       6706]
CellTagsIndexPosition[    257768,       6703]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721472451911327*^9, 3.721472453483366*^9}}],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.720865999487705*^9, 3.720866008214306*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<MagnusFuncs.m\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.720770458697122*^9, 3.7207704760425997`*^9}, {
  3.7207705082294483`*^9, 3.720770515291053*^9}, {3.721469443088065*^9, 
  3.721469444805542*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721469388398675*^9, 3.721471143685837*^9, 3.721471488172016*^9, 
   3.721471554226787*^9, 3.7214722045228863`*^9, 3.7214724576911697`*^9, {
   3.7214725877609863`*^9, 3.721472601279207*^9}, 3.72147295994503*^9, 
   3.72147457049748*^9, {3.721475033892288*^9, 3.721475057287026*^9}, {
   3.721475752845089*^9, 3.7214757908285933`*^9}, 3.721480196401658*^9, 
   3.721481741929146*^9, 3.721490571415863*^9, 3.721539052635227*^9, {
   3.721540637525652*^9, 3.721540669251054*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/jesse/NC/\"\>"}],
  SequenceForm["  ", "/Users/jesse/NC/"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721469388398675*^9, 3.721471143685837*^9, 3.721471488172016*^9, 
   3.721471554226787*^9, 3.7214722045228863`*^9, 3.7214724576911697`*^9, {
   3.7214725877609863`*^9, 3.721472601279207*^9}, 3.72147295994503*^9, 
   3.72147457049748*^9, {3.721475033892288*^9, 3.721475057287026*^9}, {
   3.721475752845089*^9, 3.7214757908285933`*^9}, 3.721480196401658*^9, 
   3.721481741929146*^9, 3.721490571415863*^9, 3.721539052635227*^9, {
   3.721540637525652*^9, 3.7215406692628193`*^9}}],

Cell[BoxData["\<\"You can now use \\\"<< NCAlgebra`\\\" to load \
NCAlgebra.\"\>"], "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721469388398675*^9, 3.721471143685837*^9, 3.721471488172016*^9, 
   3.721471554226787*^9, 3.7214722045228863`*^9, 3.7214724576911697`*^9, {
   3.7214725877609863`*^9, 3.721472601279207*^9}, 3.72147295994503*^9, 
   3.72147457049748*^9, {3.721475033892288*^9, 3.721475057287026*^9}, {
   3.721475752845089*^9, 3.7214757908285933`*^9}, 3.721480196401658*^9, 
   3.721481741929146*^9, 3.721490571415863*^9, 3.721539052635227*^9, {
   3.721540637525652*^9, 3.721540669277151*^9}}],

Cell["\<\
------------------------------------------------------------
NCAlgebra - Version 5.0.3
Compatible with Mathematica Version 10 and above

Authors:

  J. William Helton*
  Mauricio de Oliveira&

* Math, UCSD, La Jolla, CA
& MAE, UCSD, La Jolla, CA

with major earlier contributions by:

  Mark Stankus$ 
  Robert L. Miller#

$ Math, Cal Poly San Luis Obispo
# General Atomics Corp

Copyright: 
  Helton and de Oliveira 2017
  Helton 2002
  Helton and Miller June 1991
  All rights reserved.

The program was written by the authors and by:
  David Hurst, Daniel Lamm, Orlando Merino, Robert Obar,
  Henry Pfister, Mike Walker, John Wavrik, Lois Yu,
  J. Camino, J. Griffin, J. Ovall, T. Shaheen, John Shopple. 
  The beginnings of the program come from eran@slac.
  Considerable recent help came from Igor Klep.

Current primary support is from the 
  NSF Division of Mathematical Sciences.
  
This program was written with support from 
  AFOSR, NSF, ONR, Lab for Math and Statistics at UCSD,
  UCSD Faculty Mentor Program,
  and US Department of Education.

For NCAlgebra updates see:

  www.github.com/NCAlgebra/NC
  www.math.ucsd.edu/~ncalg

------------------------------------------------------------\
\>", "Print",
 CellChangeTimes->{{3.720783274470357*^9, 3.72078327790257*^9}, 
   3.7207835950970078`*^9, 3.7207874289077387`*^9, 3.72078751345186*^9, 
   3.7208531907114573`*^9, 3.720854583813143*^9, 3.7208613513915033`*^9, 
   3.7208637490120783`*^9, {3.720865995758613*^9, 3.720866013002262*^9}, 
   3.7208711520173407`*^9, 3.7209348821458597`*^9, 3.720935080332457*^9, 
   3.720942711063615*^9, {3.7209428236143637`*^9, 3.720942839774078*^9}, 
   3.720942878385007*^9, 3.7209429417696333`*^9, 3.7209430075568666`*^9, 
   3.720943396084112*^9, 3.720943430759391*^9, 3.720949618048312*^9, 
   3.720949956344659*^9, 3.7210345954196167`*^9, 3.721121148850236*^9, 
   3.721469388398675*^9, 3.721471143685837*^9, 3.721471488172016*^9, 
   3.721471554226787*^9, 3.7214722045228863`*^9, 3.7214724576911697`*^9, {
   3.7214725877609863`*^9, 3.721472601279207*^9}, 3.72147295994503*^9, 
   3.72147457049748*^9, {3.721475033892288*^9, 3.721475057287026*^9}, {
   3.721475752845089*^9, 3.7214757908285933`*^9}, 3.721480196401658*^9, 
   3.721481741929146*^9, 3.721490571415863*^9, 3.721539052635227*^9, {
   3.721540637525652*^9, 3.721540669289585*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"MatrixExp", "::", "eivn"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCommutative", "[", "t", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ww", ">", "0"}], ",", 
     RowBox[{"phi1", ">", "0"}], ",", 
     RowBox[{"t", ">", "0"}], ",", 
     RowBox[{"t0", ">", "0"}], ",", 
     RowBox[{"H1", ">", "0"}], ",", 
     RowBox[{"phi10", ">", "0"}], ",", 
     RowBox[{"tp", ">", "0"}], ",", 
     RowBox[{"xz", ">", "0"}], ",", 
     RowBox[{"t", ">", "t0"}]}], "}"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Original Hamiltonian (rotating frame)", "Section",
 CellChangeTimes->{{3.720770537323778*^9, 3.7207705427393923`*^9}, {
  3.720777692919585*^9, 3.7207777320811033`*^9}, {3.7207816372003403`*^9, 
  3.720781655216631*^9}, {3.720787435766768*^9, 3.7207874365371943`*^9}}],

Cell["\<\
Right now I\[CloseCurlyQuote]m just interested in the case of constant drive, \
so the taylor expansion only has a constant term\
\>", "Text",
 CellChangeTimes->{{3.720787439975534*^9, 3.7207874751904593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Horig", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"H1", "/", "4"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "phi", "]"}], "*", "sx"}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "*", 
       "sy"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Delta", "/", "2"}], "*", "sz"}]}]}]], "Input",
 CellChangeTimes->{{3.720781656785536*^9, 3.720781674585722*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"taylorReplacement", "=", 
  RowBox[{"{", 
   RowBox[{"H1", "\[Rule]", "H1"}], "}"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"+", "t"}], " ", "H1D"}], "+", 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", "2"], "/", "2"}], " ", "H1DD"}], "+", 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", "3"], "/", "6"}], " ", "H1DDD"}]}], "}"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.720782341021213*^9, 3.720782408514426*^9}, {
  3.7207828174550657`*^9, 3.7207828460226517`*^9}, {3.720782879688923*^9, 
  3.720782957978816*^9}, {3.7207874199364567`*^9, 3.7207874246413527`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"H1", "\[Rule]", "H1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7207829584087973`*^9, 3.720783043476697*^9, 3.7207835999653463`*^9, 
   3.7207874803216667`*^9, 3.7207875144242783`*^9, 3.72085459203509*^9, 
   3.720861357872882*^9, 3.720871161676505*^9, 3.720934886760285*^9, 
   3.72093508587922*^9, {3.7209428823842993`*^9, 3.720942897272138*^9}, 
   3.7209429450205393`*^9, 3.7209430120730953`*^9, 3.720943398354259*^9, 
   3.7209434338194942`*^9, {3.720949597933078*^9, 3.720949621405003*^9}, 
   3.7209499629042377`*^9, 3.721034600562011*^9, 3.7214693932363033`*^9, 
   3.721471556925144*^9, 3.721472207330167*^9, 3.7214724604811974`*^9, 
   3.721472605451943*^9, 3.721472962048737*^9, 3.721474574374804*^9, {
   3.721475037697901*^9, 3.721475060807652*^9}, {3.721475774018339*^9, 
   3.72147579359746*^9}, 3.7214801996841917`*^9, 3.721481745218554*^9, 
   3.721490577184104*^9, 3.7215390567483883`*^9, {3.721540646264346*^9, 
   3.721540671645111*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "[", "t_", "]"}], "=", 
  RowBox[{
   RowBox[{"Horig", "[", "t", "]"}], "/.", "taylorReplacement"}]}]], "Input",
 CellChangeTimes->{{3.720783050759514*^9, 3.720783101982284*^9}, 
   3.7207833240077047`*^9, {3.720783804429677*^9, 3.720783810107931*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"Delta", " ", "sz"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "H1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sx", " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"sy", " ", 
      RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
     RowBox[{"sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{
  3.720783324643635*^9, 3.720783601770975*^9, {3.720783810987912*^9, 
   3.72078382816864*^9}, 3.7207874822820883`*^9, 3.720787514449429*^9, {
   3.7208545940031424`*^9, 3.720854601630086*^9}, 3.7208613579247704`*^9, 
   3.7208711617338953`*^9, 3.720934886856452*^9, 3.720935085964275*^9, {
   3.720942882438242*^9, 3.720942897332395*^9}, 3.7209429450840893`*^9, 
   3.720943012117515*^9, 3.7209433984189663`*^9, 3.720943433879809*^9, {
   3.7209495979769917`*^9, 3.720949621456032*^9}, 3.7209499629823523`*^9, 
   3.721034600606432*^9, 3.721469393263982*^9, 3.721471556972028*^9, 
   3.7214722073734837`*^9, 3.721472460530641*^9, 3.721472605479631*^9, 
   3.721472962095388*^9, 3.7214745744243317`*^9, {3.721475037739843*^9, 
   3.721475060858289*^9}, {3.721475774047736*^9, 3.7214757936334*^9}, 
   3.721480199714467*^9, 3.7214817452857447`*^9, 3.7214905772331877`*^9, 
   3.721539056783402*^9, {3.721540646332458*^9, 3.721540671688673*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SetNonCommutative", "[", "H", "]"}]], "Input",
 CellChangeTimes->{{3.720783304920519*^9, 3.720783310933688*^9}, 
   3.7207838071563997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate Magnus expansion", "Section",
 CellChangeTimes->{{3.720783354968416*^9, 3.720783362374469*^9}}],

Cell[BoxData[
 RowBox[{"Remove", "[", "WW", "]"}]], "Input",
 CellChangeTimes->{{3.7214719822626133`*^9, 3.7214719896931877`*^9}, {
  3.721472353514744*^9, 3.721472354111644*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNonCommutative", "[", "h", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MI", "=", 
  RowBox[{
   RowBox[{"JesseGetMagnusIntegrands", "[", 
    RowBox[{"h", ",", "WW", ",", "max"}], "]"}], "/.", 
   RowBox[{"h", "\[Rule]", 
    RowBox[{"H", "[", "t", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.721471594711541*^9, 3.721471612498687*^9}, {
  3.72147171132694*^9, 3.7214717650563602`*^9}, {3.721471818875194*^9, 
  3.7214718577305*^9}, {3.721471992456099*^9, 3.7214719926053867`*^9}, {
  3.72147478029744*^9, 3.721474782400672*^9}, {3.721475070506382*^9, 
  3.721475072657221*^9}, {3.7214754970412693`*^9, 3.721475497382984*^9}, {
  3.721481730665987*^9, 3.721481730729863*^9}, {3.7215406731983128`*^9, 
  3.721540673525198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"Delta", " ", "sz"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "H1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sx", " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
         RowBox[{"sx", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", 
            RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
         RowBox[{"sy", " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
         RowBox[{"sy", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", 
            RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
     ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "Delta", " ", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["WW", "1"], "[", 
          RowBox[{"t", ",", "t0"}], "]"}], ",", "sz"}], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "H1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["WW", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["WW", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sx"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", 
            RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["WW", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Commutator", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["WW", "1"], "[", 
             RowBox[{"t", ",", "t0"}], "]"}], ",", "sy"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", 
            RowBox[{"2", " ", "t", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
     ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.721471819592935*^9, 3.7214718604455767`*^9, 3.721471993632432*^9, 
   3.721472209581884*^9, {3.7214723605963287`*^9, 3.721472366073391*^9}, 
   3.721472463463744*^9, 3.7214726092179127`*^9, 3.721472696032097*^9, 
   3.7214729649109993`*^9, 3.721473035000784*^9, 3.721474585607342*^9, {
   3.721475041777315*^9, 3.721475076101795*^9}, 3.721475501750808*^9, {
   3.721475759610976*^9, 3.7214757988342047`*^9}, 3.721481782822221*^9, 
   3.721490595572892*^9, {3.721540651979224*^9, 3.721540678097896*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["WW", "i"], "[", 
      RowBox[{"t_", ",", "t0_"}], "]"}], "=", 
     RowBox[{"JesseDoMagnusIntegration", "[", 
      RowBox[{
       RowBox[{"MI", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", " ", "max"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
       SubscriptBox["WW", "i"], "[", 
       RowBox[{"t", ",", "t0"}], "]"}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "max"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 CellChangeTimes->{{3.721471906199483*^9, 3.721472048647009*^9}, {
  3.7214726552507133`*^9, 3.721472663241584*^9}, {3.721472948756036*^9, 
  3.721472951858494*^9}, {3.721473027294292*^9, 3.721473027972562*^9}, {
  3.721475005145536*^9, 3.7214750088080597`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "6", ",", "10", ",", "17"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 6, 10, 17}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, {3.7215406520488863`*^9, 3.721540678147079*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "17"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 17}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, {3.7215406520488863`*^9, 3.721540678155087*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "17"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 17}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, {3.7215406520488863`*^9, 3.7215406782791986`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "17"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 17}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, {3.7215406520488863`*^9, 3.721540678325823*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "17"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 17}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, {3.7215406520488863`*^9, 3.7215406783336573`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540688920824*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 18}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.7215406890647373`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540689628262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540689639777*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n* Begin integrating the next Magnus integrand, at date and \
time \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2017", ",", "12", ",", "6", ",", "10", ",", "18"}], "}"}]}],
  SequenceForm[
  "\n* Begin integrating the next Magnus integrand, at date and time ", {2017,
    12, 6, 10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540689649387*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SigmaComRules Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}],
  SequenceForm["SigmaComRules Done:  ", {10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540689659251*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 18}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540690397502*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540694146689*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Trimming Done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}],
  SequenceForm["Trimming Done:  ", {10, 18}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540694160821*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Integration from `t0' to `t' done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "19"}], "}"}]}],
  SequenceForm["Integration from `t0' to `t' done:  ", {10, 19}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.7215407474819317`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > picking and simplifying done:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "19"}], "}"}], 
   "\[InvisibleSpace]", "\<\"  trimmed coeffs:  \"\>", "\[InvisibleSpace]", 
   "0"}],
  SequenceForm[
  "    > picking and simplifying done:  ", {10, 19}, "  trimmed coeffs:  ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540749528936*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    > assembling and simplifying done: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "19"}], "}"}]}],
  SequenceForm["    > assembling and simplifying done: ", {10, 19}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540753463306*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Post-integration trim done:  \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"10", ",", "19"}], "}"}]}],
  SequenceForm["Post-integration trim done:  ", {10, 19}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.72147205194693*^9, 3.721472209637184*^9, 3.721472366125989*^9, 
   3.72147246351299*^9, 3.721472609266872*^9, 3.721472701302825*^9, 
   3.721472964968527*^9, 3.721473039013467*^9, 3.721474585698103*^9, 
   3.7214750418203497`*^9, 3.721475088041272*^9, 3.7214755059058247`*^9, {
   3.7214757596819696`*^9, 3.721475801132496*^9}, 3.721481782906496*^9, 
   3.72149059567013*^9, 3.7215406520488863`*^9, 3.721540753472048*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<newmag_oldcoeff_HrealME.wl\>\""}], ",", "WW"}], "]"}]], "Input",
 CellChangeTimes->{{3.721481698583378*^9, 3.7214817100267143`*^9}, 
   3.721490536052533*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hbarnewmag", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"I", "/", 
     RowBox[{"(", 
      RowBox[{"tb", "-", "ta"}], ")"}]}], "*", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["WW", "i"], "[", 
         RowBox[{"tb", ",", "ta"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "max"}], "}"}]}], "]"}]}], "]"}]}], "//", 
   "S"}]}]], "Input",
 CellChangeTimes->{{3.721473537976053*^9, 3.7214736450878572`*^9}, 
   3.721481694408527*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "ta"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
          RowBox[{"H1", " ", "sx", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"H1", " ", "sy", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"tb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
          RowBox[{"H1", " ", "sx", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"H1", " ", "sy", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{"H1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}], "ww"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"H1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "H1", " ", "sz", " ", "ta", " ", "ww"}], 
        "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", "tb", " ", "ww"}], "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ta"}], "-", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", 
         RowBox[{"(", 
          RowBox[{"sy", "+", 
           RowBox[{"sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
            "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "H1", " ", "sz", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "phi"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
       ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.721473885225087*^9, 3.721474764315686*^9, 3.7214749399612017`*^9, {
   3.721475747870556*^9, 3.721475763378502*^9}, 3.721476034535531*^9, 
   3.721485001595685*^9, 3.7214935818907957`*^9, 3.7215407717324057`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<newmag_oldcoeff_HrealME.wl\>\""}], ",", "Hbarnewmag"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.721481717725861*^9, {3.721490520410359*^9, 3.721490522793827*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Hbarconst", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{"Hbarnewmag", "[", 
   RowBox[{"tb", ",", "ta"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.721540789304097*^9, 3.721540802440816*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "ta"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
          RowBox[{"H1", " ", "sx", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"H1", " ", "sy", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"tb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
          RowBox[{"H1", " ", "sx", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"H1", " ", "sy", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{"H1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{"sy", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
          ")"}]}], "ww"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["ww", "2"]], 
     RowBox[{"H1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "H1", " ", "sz", " ", "ta", " ", "ww"}], 
        "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", "tb", " ", "ww"}], "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ta"}], "-", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", 
         RowBox[{"(", 
          RowBox[{"sy", "+", 
           RowBox[{"sx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
            "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sy", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", "sx", " ", "tb", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        "-", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "Delta", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", "sy", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sx", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "Delta", " ", "sy", " ", "tb", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"8", " ", "Delta", " ", "sx", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"4", " ", "H1", " ", "sz", " ", "ta", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"2", " ", "phi"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
       ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.721540802785771*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Results of ME", "Section",
 CellChangeTimes->{{3.72087119692407*^9, 3.7208712027487373`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HbarconstFS", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"64", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["H1", "2"], "-", 
        RowBox[{"16", " ", "Delta", " ", "ww"}]}], ")"}]}], "+", 
     RowBox[{"16", " ", "H1", " ", "sx", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}], " ", 
      SuperscriptBox["ww", "2"], " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["H1", "2"], " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
     RowBox[{"H1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "sy", " ", "ww"}], "+", 
           RowBox[{"Delta", " ", 
            RowBox[{"(", 
             RowBox[{"sy", "+", 
              RowBox[{"sx", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], 
             ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"phi", "+", 
                RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "sy", " ", "ww"}], "+", 
               RowBox[{"Delta", " ", 
                RowBox[{"(", 
                 RowBox[{"sy", "+", 
                  RowBox[{"sx", " ", 
                   RowBox[{"(", 
                    RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}]}], 
                 ")"}]}]}], ")"}]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{"4", " ", "sy", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", 
            SuperscriptBox["ww", "2"], " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "sx", " ", "ww"}], "+", 
              RowBox[{"Delta", " ", 
               RowBox[{"(", 
                RowBox[{"sx", "+", 
                 RowBox[{"sy", " ", 
                  RowBox[{"(", 
                   RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}]}], ")"}]}]}],
              ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "sx", " ", "ww"}], "+", 
              RowBox[{"Delta", " ", 
               RowBox[{"(", 
                RowBox[{"sx", "+", 
                 RowBox[{"sy", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], 
                ")"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.720789234698084*^9, 3.720789262819499*^9}, {
   3.720855284435265*^9, 3.720855296570122*^9}, 3.720861687487381*^9, 
   3.720877138257842*^9, {3.720934278151165*^9, 3.720934280799333*^9}, {
   3.7209535435677767`*^9, 3.720953560365953*^9}, {3.72103471961904*^9, 
   3.721034719726914*^9}, {3.72147613833211*^9, 3.7214761438397293`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}], " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["H1", "2"], "-", 
       RowBox[{"16", " ", "Delta", " ", "ww"}]}], ")"}]}], "+", 
    RowBox[{"16", " ", "H1", " ", "sx", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", 
     SuperscriptBox["ww", "2"], " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"phi", "+", 
         RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"H1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "sy", " ", "ww"}], "+", 
          RowBox[{"Delta", " ", 
           RowBox[{"(", 
            RowBox[{"sy", "+", 
             RowBox[{"sx", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], 
            ")"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "H1", " ", "sz", " ", 
        RowBox[{"(", 
         RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", 
            RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
       RowBox[{"H1", " ", "sz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "+", 
               RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"phi", "+", 
               RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}]}], ")"}]}], "+", 
       
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "sy", " ", "ww"}], "-", 
             RowBox[{"Delta", " ", 
              RowBox[{"(", 
               RowBox[{"sy", "+", 
                RowBox[{"sx", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
            ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
          RowBox[{"4", " ", "sy", " ", 
           RowBox[{"(", 
            RowBox[{"ta", "-", "tb"}], ")"}], " ", 
           SuperscriptBox["ww", "2"], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "sx", " ", "ww"}], "+", 
             RowBox[{"Delta", " ", 
              RowBox[{"(", 
               RowBox[{"sx", "+", 
                RowBox[{"sy", " ", 
                 RowBox[{"(", 
                  RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}]}], ")"}]}]}], 
            ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "sx", " ", "ww"}], "+", 
             RowBox[{"Delta", " ", 
              RowBox[{"(", 
               RowBox[{"sx", "+", 
                RowBox[{"sy", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], 
               ")"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"phi", "+", 
             RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.721476150978114*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hbarconst", "[", 
    RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
   RowBox[{"HbarconstFS", "[", 
    RowBox[{"tb", ",", "ta"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7210347243079576`*^9, 3.721034748742676*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.720863961223625*^9, 3.720863968306385*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Play with the results", "Section",
 CellChangeTimes->{{3.7208613725835047`*^9, 3.72086137711768*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.720953568353541*^9, 3.7209535979833117`*^9}, {
   3.720953645793765*^9, 3.720953742076748*^9}, {3.720953794263063*^9, 
   3.720953795165957*^9}, 3.7214761596150923`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721476161189095*^9, 3.721476161194602*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hbarconst", "[", 
    RowBox[{"tb", ",", "ta"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.7208771714939938`*^9, 3.720877198947023*^9}, {
  3.7209342936493607`*^9, 3.7209343012335033`*^9}, {3.7209343399859943`*^9, 
  3.7209343434087553`*^9}, {3.720934375347744*^9, 3.720934394485937*^9}, {
  3.7209344247252007`*^9, 3.720934427228166*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}], " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"H1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "H1", " ", "sz", " ", "ta", " ", "ww"}], "+", 
     RowBox[{"2", " ", "H1", " ", "sz", " ", "tb", " ", "ww"}], "+", 
     RowBox[{"16", " ", "sx", " ", "ta", " ", 
      SuperscriptBox["ww", "2"]}], "-", 
     RowBox[{"16", " ", "sx", " ", "tb", " ", 
      SuperscriptBox["ww", "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "sy"}], "+", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", "ww", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "sy"}], "+", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", "ww", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"2", " ", "H1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"8", " ", "sx", " ", "ww", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"H1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
     RowBox[{"2", " ", "H1", " ", "sz", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"8", " ", "sx", " ", "ww", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.720877190120945*^9, 3.720877242367165*^9, {3.720934294342058*^9, 
   3.720934301639738*^9}, 3.720934343797735*^9, {3.72093437834229*^9, 
   3.720934396889049*^9}, 3.720934468248405*^9, 3.720953883550015*^9, 
   3.721476165288477*^9}]
}, Open  ]],

Cell["Order of 1/ww^0", "Text",
 CellChangeTimes->{{3.7208532053561068`*^9, 3.720853226716598*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Hbarconst", "[", 
     RowBox[{"tb", ",", "ta"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.720853229344388*^9, 3.720853293502438*^9}, {
  3.720853443061034*^9, 3.720853453259568*^9}, {3.7208553686348*^9, 
  3.720855373833898*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
    RowBox[{"H1", " ", "sx", " ", 
     RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
    RowBox[{"H1", " ", "sy", " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7208532715660667`*^9, 3.720853294332395*^9}, 
   3.720853454159131*^9, 3.720855418161128*^9, 3.720861700133127*^9, 
   3.720954219700397*^9, 3.721476192076146*^9}]
}, Open  ]],

Cell["Order of 1/ww^1", "Text",
 CellChangeTimes->{{3.720855462413796*^9, 3.720855472141616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Hbarconst", "[", 
     RowBox[{"tb", ",", "ta"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.720855480654662*^9, 3.720855481478545*^9}, {
  3.7209544167021503`*^9, 3.720954418642538*^9}, {3.72095445938395*^9, 
  3.720954461150475*^9}, {3.720954549785367*^9, 3.7209545606402617`*^9}, {
  3.720954609040989*^9, 3.720954610488755*^9}, {3.721476201233432*^9, 
  3.721476203408264*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"32", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}]}]], 
  RowBox[{"H1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"H1", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}], "+", 
     RowBox[{"H1", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "sy"}], "+", 
        RowBox[{"Delta", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"H1", " ", "sz", " ", "ta", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
     RowBox[{"H1", " ", "sz", " ", "tb", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
     RowBox[{"4", " ", "sy", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", "Delta", " ", "sx", " ", "ta", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "Delta", " ", "sx", " ", "tb", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"4", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "Delta", " ", "sy", " ", "ta", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", "Delta", " ", "sy", " ", "tb", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "ta", " ", "ww"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "sx"}], "+", 
        RowBox[{"Delta", " ", "sy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"2", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{
  3.7208554966921597`*^9, 3.7208617221609364`*^9, {3.720954415179386*^9, 
   3.72095441904408*^9}, 3.720954461758127*^9, {3.720954553167008*^9, 
   3.7209545619284887`*^9}, 3.720954676296269*^9, {3.721476194827229*^9, 
   3.72147622259951*^9}}]
}, Open  ]],

Cell["Order of 1/ww^2", "Text",
 CellChangeTimes->{{3.720855589675488*^9, 3.720855593904673*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Hbarconst", "[", 
     RowBox[{"tb", ",", "ta"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.720855601746234*^9, 3.720855602281726*^9}, 
   3.720954688574737*^9, 3.721476204174226*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}]}]], 
  RowBox[{"H1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"H1", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"ta", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"tb", " ", "ww"}]}], ")"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"8", " ", "Delta", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}]}], "]"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.720855602850478*^9, 3.7208617350645742`*^9, 
  3.7209548271214333`*^9, 3.72147623119154*^9}]
}, Open  ]],

Cell[BoxData["\.10"], "Input",
 CellChangeTimes->{3.7214762262716846`*^9}],

Cell["Order of 1/ww^3", "Text",
 CellChangeTimes->{{3.720861751800288*^9, 3.720861760857315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Hbarconst", "[", 
     RowBox[{"tb", ",", "ta"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "3"}], "]"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.72086176496964*^9, 3.720861765299285*^9}, 
   3.7209548679846487`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7208617657489967`*^9, 3.720954886017023*^9, 
  3.721476238219431*^9}]
}, Open  ]],

Cell["\<\
Check if the newly obtained Magnus expansion is equivalent to the old \
expression from PieceThemTogether_ww-2 with \[CapitalDelta],\[Phi] = 0\
\>", "Text",
 CellChangeTimes->{{3.720862174964752*^9, 3.72086226032865*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HbarconstnopD", "[", 
   RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Hbarconst", "[", 
    RowBox[{"tb", ",", "ta"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Delta", "\[Rule]", "0"}], ",", 
     RowBox[{"phi", "\[Rule]", "0"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.720855642059574*^9, 3.720855656107168*^9}, {
  3.720861820996745*^9, 3.720861835795833*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}], " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
    RowBox[{"16", " ", "H1", " ", "sx", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", 
     SuperscriptBox["ww", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["H1", "2"], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
    RowBox[{"H1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", "sy", " ", "ww", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
       RowBox[{"2", " ", "H1", " ", "sz", " ", 
        RowBox[{"(", 
         RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
       RowBox[{"H1", " ", "sz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "sy", " ", "ww", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
          RowBox[{"2", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
          RowBox[{"2", " ", "sx", " ", "ww", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.72085565667262*^9, 3.7208617792841473`*^9, 
  3.720861845001389*^9, 3.720955672814724*^9, 3.721476268463944*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HbarconstnopDold", "[", 
    RowBox[{"tb_", ",", "ta_"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"384", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", 
      SuperscriptBox["ww", "3"]}]], "H1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"96", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "sy"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"sx", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "ta", " ", "ww"}], "+", 
            RowBox[{"2", " ", "tb", " ", "ww"}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "]"}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], ")"}]}]}], ")"}]}],
       "-", 
      RowBox[{"24", " ", "H1", " ", "sz", " ", "ww", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "]"}], "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], 
        ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"16", " ", "sx", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}], "+", 
         RowBox[{"15", " ", "sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sx", " ", "ta", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sx", " ", "tb", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"8", " ", "sy", " ", 
          SuperscriptBox["ta", "2"], " ", 
          SuperscriptBox["ww", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"16", " ", "sy", " ", "ta", " ", "tb", " ", 
          SuperscriptBox["ww", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"8", " ", "sy", " ", 
          SuperscriptBox["tb", "2"], " ", 
          SuperscriptBox["ww", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"3", " ", "sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", "sx", " ", "ta", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"2", " ", "sx", " ", "tb", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"2", " ", "tb"}]}], ")"}], " ", "ww"}], "]"}]}], "-", 
         RowBox[{"8", " ", "sx", " ", "ta", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
         RowBox[{"8", " ", "sx", " ", "tb", " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"12", " ", "sx", " ", 
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "+", 
            RowBox[{"sy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "15"}], "+", 
               RowBox[{"8", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ta"}], "+", "tb"}], ")"}], "2"], " ", 
                SuperscriptBox["ww", "2"]}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "sy"}], "+", 
            RowBox[{"2", " ", "sx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww"}]}], ")"}], 
          " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"sy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
            "ww"}], "]"}]}], "+", 
         RowBox[{"8", " ", "sx", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ta"}], "+", "tb"}], ")"}], " ", "ww", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
         RowBox[{"9", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sy", " ", "ta", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sy", " ", "tb", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"3", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"2", " ", "sy", " ", "ta", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", "sy", " ", "tb", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "ta", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww"}], "]"}]}], "+", 
         RowBox[{"9", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"12", " ", "sy", " ", "ta", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"12", " ", "sy", " ", "tb", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"3", " ", "sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"2", " ", "sy", " ", "ta", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "-", 
         RowBox[{"2", " ", "sy", " ", "tb", " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"4", " ", "tb", " ", "ww"}], "]"}]}], "+", 
         RowBox[{"sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "ta"}], "+", "tb"}], ")"}], " ", 
            "ww"}], "]"}]}], "+", 
         RowBox[{"8", " ", "sy", " ", 
          RowBox[{"(", 
           RowBox[{"ta", "-", "tb"}], ")"}], " ", "ww", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"ta", "+", "tb"}], ")"}], " ", "ww"}], "]"}]}], "-", 
         RowBox[{"sx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "ta", " ", "ww"}], "-", 
            RowBox[{"4", " ", "tb", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.720861178811163*^9, 3.720861184186016*^9}, {
  3.72086184151266*^9, 3.720861843823244*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HbarconstnopD", "[", 
    RowBox[{
     RowBox[{"\[Alpha]0", "/", "ww"}], ",", "0"}], "]"}], "-", 
   RowBox[{"HbarconstnopDold", "[", 
    RowBox[{
     RowBox[{"\[Alpha]0", "/", "ww"}], ",", "0"}], "]"}]}], "//", 
  "S"}]], "Input",
 CellChangeTimes->{{3.720861190632551*^9, 3.720861284227046*^9}, {
  3.7208617967329884`*^9, 3.720861805454434*^9}, {3.720861864783348*^9, 
  3.7208619525592337`*^9}, {3.720955689025238*^9, 3.720955736197733*^9}, {
  3.7209558899955873`*^9, 3.720955900201524*^9}, {3.720955983901884*^9, 
  3.720955986788229*^9}, {3.7209560245445423`*^9, 3.720956079360158*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1536", " ", 
     SuperscriptBox["ww", "2"], " ", "\[Alpha]0"}]], 
   RowBox[{"H1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "63"}], " ", 
       SuperscriptBox["H1", "2"], " ", "sy"}], "-", 
      RowBox[{"192", " ", "sy", " ", 
       SuperscriptBox["ww", "2"]}], "-", 
      RowBox[{"21", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", "\[Alpha]0"}], "+", 
      RowBox[{"384", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", "\[Alpha]0"}], "+", 
      RowBox[{"28", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       SuperscriptBox["\[Alpha]0", "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "96"}], " ", "sy", " ", 
          SuperscriptBox["ww", "2"]}], "+", 
         RowBox[{"72", " ", "H1", " ", "sz", " ", "ww", " ", "\[Alpha]0"}], 
         "+", 
         RowBox[{"7", " ", 
          SuperscriptBox["H1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sx", " ", "\[Alpha]0"}], "+", 
            RowBox[{"2", " ", "sy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               SuperscriptBox["\[Alpha]0", "2"]}], ")"}]}]}], ")"}]}]}], 
        ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["H1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"sy", "-", 
         RowBox[{"sx", " ", "\[Alpha]0"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"72", " ", "H1", " ", "sz", " ", "ww", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"192", " ", "sx", " ", 
       SuperscriptBox["ww", "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"70", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", "\[Alpha]0", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", "\[Alpha]0", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"4", " ", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.7208612412449617`*^9, 3.7208612848179703`*^9}, {
   3.720861788440803*^9, 3.7208617925621567`*^9}, {3.7208618664865513`*^9, 
   3.720861878120191*^9}, {3.720861942419969*^9, 3.7208619461285677`*^9}, 
   3.720862127414012*^9, {3.72095569861129*^9, 3.7209557376811323`*^9}, {
   3.720955894615954*^9, 3.720955901644459*^9}, 3.7209559871167803`*^9, 
   3.7209560275263166`*^9, {3.720956067340233*^9, 3.720956080805249*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"HbarconstnopDold", "[", 
     RowBox[{"tb", ",", "ta"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7209561070599957`*^9, 3.720956115402092*^9}, {
  3.720956161075729*^9, 3.720956163114552*^9}, {3.72095619448628*^9, 
  3.7209562432697573`*^9}, {3.72147629026016*^9, 3.721476292522821*^9}, {
  3.7214763676120872`*^9, 3.721476367795816*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"48", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}]}]], 
  RowBox[{"H1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", "H1", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{"ta", "-", "tb"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "12"}], "+", 
           RowBox[{
            SuperscriptBox["H1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"6", " ", "H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "12"}], "+", 
           RowBox[{
            SuperscriptBox["H1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"ta", "-", "tb"}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"6", " ", "H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"12", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "-", 
     RowBox[{"12", " ", "sx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.720956164161364*^9, {3.720956196200261*^9, 3.720956243618115*^9}, 
   3.721476293248764*^9, 3.721476375198338*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"HbarconstnopD", "[", 
     RowBox[{"tb", ",", "ta"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7214763058589897`*^9, 3.72147630628969*^9}, {
  3.721476370872714*^9, 3.721476371403885*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"32", " ", 
    RowBox[{"(", 
     RowBox[{"ta", "-", "tb"}], ")"}]}]], 
  RowBox[{"H1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"H1", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ta"}], "+", "tb"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "sy"}], "+", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "ta", " ", "ww"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "sy"}], "+", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{"ta", "-", "tb"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], "+", 
     RowBox[{"4", " ", "sx", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "ta", " ", "ww"}], "]"}], "-", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "tb", " ", "ww"}], "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.721476307265929*^9, {3.7214763608670397`*^9, 3.721476377737162*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time to calculate some jump operators", "Section",
 CellChangeTimes->{{3.720864040607608*^9, 3.720864056921062*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Hbarconst", "[", 
    RowBox[{"t0", ",", 
     RowBox[{"t0", "-", "tc"}]}], "]"}], "//", "Expand"}], "//", 
  "FS"}]], "Input",
 CellChangeTimes->{{3.7208640707329807`*^9, 3.720864073626809*^9}, {
  3.7208651460297813`*^9, 3.7208651601962557`*^9}, {3.720865209439117*^9, 
  3.720865253311911*^9}, {3.7208654863445387`*^9, 3.720865491814589*^9}, {
  3.720865593314786*^9, 3.720865610883432*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"32", " ", "ww"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "sz"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["H1", "2"], "-", 
       RowBox[{"16", " ", "Delta", " ", "ww"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "H1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "sx", " ", "ww", " ", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
       RowBox[{"H1", " ", "sz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", 
            RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", "Delta", " ", "sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
       RowBox[{"4", " ", "sy", " ", "ww", " ", 
        RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
       RowBox[{"2", " ", "Delta", " ", "sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.720864074204855*^9, {3.720865152014435*^9, 3.7208651646802197`*^9}, 
   3.720865257638153*^9, 3.7208654562805157`*^9, 3.720865493233562*^9, {
   3.7208656001125517`*^9, 3.720865624738132*^9}, 3.720866066510272*^9, 
   3.7208661244559317`*^9, 3.720956342097856*^9, 3.721476464541274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "[", "t0_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"+", "I"}], 
    RowBox[{"(", "t0", ")"}], 
    RowBox[{"Hbarconst", "[", 
     RowBox[{"t0", ",", 
      RowBox[{"t0", "-", "tc"}]}], "]"}]}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.7208649843211603`*^9, 3.720865018967648*^9}, {
  3.7208661805835047`*^9, 3.720866181709629*^9}, {3.72086621448542*^9, 
  3.720866217213441*^9}, {3.7208662824711943`*^9, 3.72086628283143*^9}, {
  3.720866349482662*^9, 3.720866363379326*^9}, {3.7208664139006653`*^9, 
  3.720866423100712*^9}, {3.7208664933124647`*^9, 3.720866524782991*^9}, {
  3.720866586596311*^9, 3.720866600851713*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"32", " ", "ww"}]], 
  RowBox[{"\[ImaginaryI]", " ", "t0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sz"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["H1", "2"], "-", 
        RowBox[{"16", " ", "Delta", " ", "ww"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "H1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "sx", " ", "ww", " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
        RowBox[{"H1", " ", "sz", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", "Delta", " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"4", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"2", " ", "Delta", " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.720866529662212*^9, {3.720866597037084*^9, 3.72086660541988*^9}, 
   3.7209564382187634`*^9, 3.721476465243669*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "[", "t0_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "I"}], 
    RowBox[{"(", "t0", ")"}], 
    RowBox[{"Hbarconst", "[", 
     RowBox[{"t0", ",", "0"}], "]"}]}], "//", "S"}]}]], "Input",
 CellChangeTimes->{{3.720866534448997*^9, 3.7208665625839767`*^9}, {
  3.72086680673794*^9, 3.720866807993298*^9}, {3.72095695943259*^9, 
  3.720956964524098*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"64", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "sz", " ", "t0", " ", "ww", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["H1", "2"], "-", 
        RowBox[{"16", " ", "Delta", " ", "ww"}]}], ")"}]}], "-", 
     RowBox[{"16", " ", "H1", " ", "sx", " ", "t0", " ", 
      SuperscriptBox["ww", "2"], " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["H1", "2"], " ", "sz", " ", "t0", " ", "ww", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "phi"}], "]"}]}], "+", 
     RowBox[{"H1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "sy", " ", "ww"}], "+", 
           RowBox[{"Delta", " ", 
            RowBox[{"(", 
             RowBox[{"sy", "+", 
              RowBox[{"sx", " ", "t0", " ", "ww"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "phi", "]"}]}], "-", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", "t0", " ", "ww", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"phi", "+", 
             RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", "H1", " ", "sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"t0", " ", "ww"}], "]"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", "phi"}], "+", 
              RowBox[{"t0", " ", "ww"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t0", " ", "ww"}], "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "Delta"}], " ", "sy"}], "-", 
              RowBox[{"2", " ", "sy", " ", "ww"}], "+", 
              RowBox[{"Delta", " ", "sx", " ", "t0", " ", "ww"}]}], ")"}], 
            " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "ww", " ", 
               RowBox[{"(", 
                RowBox[{"sx", "-", 
                 RowBox[{"2", " ", "sy", " ", "t0", " ", "ww"}]}], ")"}]}], 
              "+", 
              RowBox[{"Delta", " ", 
               RowBox[{"(", 
                RowBox[{"sx", "-", 
                 RowBox[{"sy", " ", "t0", " ", "ww"}]}], ")"}]}]}], ")"}], 
            " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "sx", " ", "ww"}], "+", 
              RowBox[{"Delta", " ", 
               RowBox[{"(", 
                RowBox[{"sx", "+", 
                 RowBox[{"sy", " ", "t0", " ", "ww"}]}], ")"}]}]}], ")"}], 
            " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"phi", "+", 
              RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.720866563083921*^9, 3.720866889821659*^9, {3.720956957074628*^9, 
   3.720956960032106*^9}, 3.7209571241418257`*^9, 3.721476472479478*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Om", "[", "\[Alpha]0_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], "+", 
    RowBox[{"B", "[", 
     RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], ",", 
       RowBox[{"B", "[", 
        RowBox[{"\[Alpha]0", "/", "ww"}], "]"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "12"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], ",", 
           RowBox[{"B", "[", 
            RowBox[{"\[Alpha]0", "/", "ww"}], "]"}]}], "]"}]}], "]"}], "+", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{
           RowBox[{"B", "[", 
            RowBox[{"\[Alpha]0", "/", "ww"}], "]"}], ",", 
           RowBox[{"A", "[", 
            RowBox[{"\[Alpha]0", "/", "ww"}], "]"}]}], "]"}]}], "]"}]}], 
      ")"}]}]}], "//.", "SigmaComRules"}]}]], "Input",
 CellChangeTimes->{{3.720867036448998*^9, 3.7208670455279837`*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Alpha]0", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "sz"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["H1", "2"], "-", 
                 RowBox[{"16", " ", "Delta", " ", "ww"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", "H1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", "sx", " ", "ww", " ", 
                  RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
                 RowBox[{"H1", " ", "sz", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                    ")"}]}], "]"}]}], "-", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                 "+", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                 "+", 
                 RowBox[{"2", " ", "Delta", " ", "sy", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"phi", "+", 
                    RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], 
           RowBox[{"32", " ", 
            SuperscriptBox["ww", "2"]}]], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
             ")"}]}], 
           RowBox[{"64", " ", 
            SuperscriptBox["ww", "2"]}]], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "\[Alpha]0", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton",
                DisplayFunction->(FrameBox[
                  
                  RowBox[{
                   "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                  Background -> GrayLevel[0.75], 
                  BaseStyle -> {
                   "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                  Baseline, ContentPadding -> False, FrameMargins -> 1, 
                  FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}], 
              "+", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton",
               DisplayFunction->(FrameBox[
                 
                 RowBox[{
                  "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                 Background -> GrayLevel[0.75], 
                 BaseStyle -> {
                  "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                   ShowStringCharacters -> False}, BaselinePosition -> 
                 Baseline, ContentPadding -> False, FrameMargins -> 1, 
                 FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}], 
             ")"}]}], 
           RowBox[{"64", " ", 
            SuperscriptBox["ww", "2"]}]], "+", 
          RowBox[{
           FractionBox["1", "12"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Alpha]0", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                   RowBox[{"32", " ", 
                    SuperscriptBox["ww", "2"]}]]}], "+", 
                 RowBox[{"2", " ", "H1", " ", 
                  RowBox[{"(", 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                   ")"}]}]}], ")"}]}], 
              RowBox[{"32", " ", 
               SuperscriptBox["ww", "2"]}]], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton",
                 DisplayFunction->(FrameBox[
                   
                   RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                   Background -> GrayLevel[0.75], 
                   BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 1, 
                   FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                ")"}]}], 
              RowBox[{"64", " ", 
               SuperscriptBox["ww", "2"]}]]}], ")"}]}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{58., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{50., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 33, 25975993799395451398, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{56., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 33, 25975993799395451398, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{42., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 33, 25975993799395451398, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{74., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[33]]], "Output",
 CellChangeTimes->{3.7208669894556026`*^9, 3.72095722833324*^9, 
  3.721476486735355*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Om", "[", "\[Alpha]0", "]"}], "//", "S"}]], "Input",
 CellChangeTimes->{{3.720867047823638*^9, 3.720867054760062*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.720867329906838*^9, 3.72095785262542*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SimpOm", "[", "\[Alpha]0_", "]"}], "=", "%"}], ";"}]], "Input",
 CellChangeTimes->{{3.720867346011149*^9, 3.72086738488414*^9}, 
   3.7209575470263243`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"196608", " ", 
    SuperscriptBox["ww", "6"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "H1", " ", 
   RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["H1", "4"], " ", "\[Alpha]0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Delta", " ", "sy"}], "+", 
        RowBox[{"sy", " ", "ww"}], "+", 
        RowBox[{"2", " ", "Delta", " ", "sx", " ", "\[Alpha]0"}]}], ")"}], 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["H1", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"32", " ", 
         SuperscriptBox["Delta", "3"], " ", 
         RowBox[{"(", 
          RowBox[{"sy", "+", 
           RowBox[{"2", " ", "sx", " ", "\[Alpha]0"}], "-", 
           RowBox[{"sy", " ", 
            SuperscriptBox["\[Alpha]0", "2"]}]}], ")"}]}], "-", 
        RowBox[{"32", " ", 
         SuperscriptBox["Delta", "2"], " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"11", " ", "sx", " ", "\[Alpha]0"}], "+", 
           RowBox[{"sy", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["\[Alpha]0", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
        
        RowBox[{"2", " ", "ww", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"256", " ", "sy", " ", 
            SuperscriptBox["ww", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["H1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "sy"}], "+", 
              RowBox[{"20", " ", "sx", " ", "\[Alpha]0"}], "+", 
              RowBox[{"8", " ", "sy", " ", 
               SuperscriptBox["\[Alpha]0", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{"Delta", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"64", " ", 
            SuperscriptBox["ww", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"7", " ", "sy"}], "+", 
              RowBox[{"2", " ", "sx", " ", "\[Alpha]0"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["H1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"11", " ", "sy"}], "+", 
              RowBox[{"36", " ", "sx", " ", "\[Alpha]0"}], "+", 
              RowBox[{"16", " ", "sy", " ", 
               SuperscriptBox["\[Alpha]0", "2"]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"48", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"8", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"6144", " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "4"], " ", 
      RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"1024", " ", 
      SuperscriptBox["Delta", "3"], " ", "H1", " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"1024", " ", 
      SuperscriptBox["Delta", "2"], " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24576", " ", "Delta", " ", "sx", " ", 
      SuperscriptBox["ww", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"49152", " ", "sx", " ", 
      SuperscriptBox["ww", "5"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"9", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"256", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"12288", " ", 
      SuperscriptBox["Delta", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"12", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"4096", " ", 
      SuperscriptBox["Delta", "3"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"4096", " ", 
      SuperscriptBox["Delta", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"384", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4096", " ", 
      SuperscriptBox["Delta", "3"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"1024", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"8", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"1280", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"640", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"12288", " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2048", " ", 
      SuperscriptBox["Delta", "2"], " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"256", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2048", " ", "Delta", " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"10", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"1792", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"14", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"32", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"12", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"40", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"64", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"160", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"6", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"192", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"128", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"28", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"12", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"48", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"64", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"320", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "\[Alpha]0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"6", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"224", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"10", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"320", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"160", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"40", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"48", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"8", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"4", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "-", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "-", 
     RowBox[{"512", " ", 
      SuperscriptBox["Delta", "3"], " ", "H1", " ", "sz", " ", "ww", " ", 
      "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"48", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "-", 
     RowBox[{"1024", " ", 
      SuperscriptBox["Delta", "2"], " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"4096", " ", "Delta", " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"512", " ", 
      SuperscriptBox["Delta", "3"], " ", "H1", " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"64", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"24576", " ", "Delta", " ", "sy", " ", 
      SuperscriptBox["ww", "4"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"49152", " ", "sy", " ", 
      SuperscriptBox["ww", "5"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"9", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"384", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"10", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"512", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"12288", " ", 
      SuperscriptBox["Delta", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"44", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"512", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"40", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4096", " ", 
      SuperscriptBox["Delta", "3"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"1408", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4096", " ", 
      SuperscriptBox["Delta", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"60", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"640", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"48", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4096", " ", 
      SuperscriptBox["Delta", "3"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"1024", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"1280", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"16", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"56", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
     RowBox[{"640", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"5", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"6144", " ", "Delta", " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"2048", " ", 
      SuperscriptBox["Delta", "2"], " ", "H1", " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"6", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"1280", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "3"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"2", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"128", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "2"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"512", " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["ww", "3"], " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"20", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"32", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
     RowBox[{"32", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"5", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"160", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"192", " ", "Delta", " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"128", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "2"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", 
      SuperscriptBox["Delta", "3"], " ", 
      SuperscriptBox["H1", "2"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"12", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"80", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"96", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox["Delta", "2"], " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"32", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"64", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", 
      SuperscriptBox["ww", "2"], " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"96", " ", "Delta", " ", 
      SuperscriptBox["H1", "3"], " ", "sz", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"4", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", 
      SuperscriptBox["\[Alpha]0", "3"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"5", " ", "phi"}], "+", 
        RowBox[{"3", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
     RowBox[{"Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "\[Alpha]0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["H1", "4"], " ", "sx", " ", "ww", " ", "\[Alpha]0", " ", 
      
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
     RowBox[{"6", " ", "Delta", " ", 
      SuperscriptBox["H1", "4"], " ", "sy", " ", 
      SuperscriptBox["\[Alpha]0", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", 
        RowBox[{"5", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.720867385912022*^9}]
}, Open  ]],

Cell["This should be more or less the jump operator...", "Text",
 CellChangeTimes->{{3.720867436407712*^9, 3.720867447063282*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OmC0", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Om", "[", "\[Alpha]0", "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.720867399924611*^9, 3.720867421542143*^9}, {
  3.720867536171629*^9, 3.7208675399942093`*^9}, {3.720957858854309*^9, 
  3.720957859642709*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.720867424579363*^9, 3.720867540618483*^9, 
  3.72095786759441*^9, 3.721476502610084*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OmC1", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"Om", "[", "\[Alpha]0", "]"}], ",", 
     RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.7208674748732853`*^9, 3.720867485256216*^9}, {
   3.720867543834499*^9, 3.720867546626062*^9}, {3.720867962253252*^9, 
   3.720867964933278*^9}, 3.7208680215680313`*^9, {3.720957861042966*^9, 
   3.7209578614667387`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", "H1", " ", 
  RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "sx"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7208674787191753`*^9, 3.720867486340013*^9}, 
   3.7208675474021893`*^9, 3.720867965552021*^9, 3.720868022724043*^9, 
   3.720957872829886*^9, 3.721476505742384*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OmC2", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"Om", "[", "\[Alpha]0", "]"}], ",", 
     RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.720867516322619*^9, 3.720867516649356*^9}, {
  3.720867549850483*^9, 3.720867551164095*^9}, {3.7208679984612627`*^9, 
  3.720868010941503*^9}, {3.720957862589233*^9, 3.72095786308104*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "32"]}], " ", "\[ImaginaryI]", " ", "H1", " ", 
  RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "Delta", " ", 
     RowBox[{"(", 
      RowBox[{"sx", "-", 
       RowBox[{"2", " ", "sy", " ", "\[Alpha]0"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"4", " ", "Delta", " ", 
     RowBox[{"(", 
      RowBox[{"sy", "+", 
       RowBox[{"2", " ", "sx", " ", "\[Alpha]0"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"H1", " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]0", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
       RowBox[{"4", " ", "\[Alpha]0", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{
  3.7208675183229313`*^9, 3.720867552530661*^9, {3.720868003254739*^9, 
   3.720868012782805*^9}, 3.720957881067081*^9, 3.721476575076414*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", "H1", " ", 
     RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"H1", " ", "sz", " ", 
        RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "+", 
       RowBox[{"4", " ", "Delta", " ", "sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
       RowBox[{"2", " ", "H1", " ", "sz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
       RowBox[{"4", " ", "Delta", " ", "sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}], ")"}], "-", 
   "OmC2"}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7214767059296303`*^9, 3.72147672391185*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", "\[ImaginaryI]", " ", "H1", " ", 
  RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "Delta", " ", 
     RowBox[{"(", 
      RowBox[{"sx", "-", 
       RowBox[{"sy", " ", "\[Alpha]0"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"4", " ", "Delta", " ", 
     RowBox[{"(", 
      RowBox[{"sy", "+", 
       RowBox[{"sx", " ", "\[Alpha]0"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "+", 
    RowBox[{"H1", " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]0", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "+", 
       RowBox[{"2", " ", "\[Alpha]0", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{{3.721476714719634*^9, 3.721476725706397*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jump operator for arbitrary time", "Section",
 CellChangeTimes->{{3.7210417309565487`*^9, 3.721041736560299*^9}, {
  3.721108546072587*^9, 3.721108547785759*^9}}],

Cell["\<\
Here I define the jump operator from the real trajectory to the approximate \
one. We calculate it by moving forward along the real trajectory from t_jump \
to t_0 using operator Bf and backwards along the approximate trajectory using \
Af.

The jump operator should only depend on time mod t_c. Furthermore we \
introduce angle-like offset \[Alpha]0 = \[Omega] t0 and \[Alpha]j = \[Omega] \
tj. It is given by

exp[ Jf ] = exp[ Af ] exp [ Bf ]

with 
\tAf = -M[Heff, t_final, t_lc] = -M[Heff, \[Alpha]f / \[Omega], \[Alpha]0 / \
\[Omega]] = + i (\[Alpha]f - \[Alpha]0) / \[Omega] Hbar[t0 + tc, t0] (we can \
do this because Heff is constant, so commutes with itself at all times)
\tBf = M[Hreal, t_final, t_lc] = M[Hreal, \[Alpha]f / \[Omega], \[Alpha]0 / \
\[Omega]] = - i (\[Alpha]f - \[Alpha]0) / \[Omega] Hbar[\[Alpha]f / \[Omega], \
t0]
\t
We then use our friend the BCH formula to get Jf up to finite order in 1/\
\[Omega]\
\>", "Text",
 CellChangeTimes->{{3.721041740468033*^9, 3.721041849484087*^9}, {
  3.7210425696784678`*^9, 3.7210426011100817`*^9}, {3.7210428638064537`*^9, 
  3.721043083349186*^9}, {3.7210432284444523`*^9, 3.721043235778962*^9}, {
  3.721043270488702*^9, 3.721043381278957*^9}, {3.721043412543993*^9, 
  3.721043647884041*^9}, {3.721043834375695*^9, 3.721043868879127*^9}, {
  3.72104423358696*^9, 3.721044239283183*^9}, {3.721044371552451*^9, 
  3.721044383151898*^9}, {3.721050660429391*^9, 3.7210506616205063`*^9}, {
  3.721051301309803*^9, 3.721051305225431*^9}, {3.7210513515563507`*^9, 
  3.721051438045792*^9}, {3.721051666783565*^9, 3.721051674989048*^9}, {
  3.721108449545342*^9, 3.7211085293554497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Af", "[", 
   RowBox[{"tj_", ",", "t0_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"+", "I"}], "*", 
    RowBox[{"(", 
     RowBox[{"t0", "-", "tj"}], ")"}], "*", 
    RowBox[{"Hbarconst", "[", 
     RowBox[{"t0", ",", 
      RowBox[{"t0", "-", "tc"}]}], "]"}]}], " ", "//", " ", "FS"}]}]], "Input",\

 CellChangeTimes->{{3.721043805984293*^9, 3.721043847966692*^9}, {
  3.7210441112719297`*^9, 3.721044172451117*^9}, {3.7210442078181973`*^9, 
  3.7210442690622997`*^9}, {3.72105116595357*^9, 3.721051210577022*^9}, {
  3.721051502687686*^9, 3.721051505983576*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"256", " ", 
    SuperscriptBox["ww", "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"t0", "-", "tj"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Delta"}], " ", 
         SuperscriptBox["H1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["H1", "2"], " ", "ww"}], "+", 
        RowBox[{"16", " ", "Delta", " ", 
         SuperscriptBox["ww", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "H1", " ", "sx", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["H1", "2"], "-", 
        RowBox[{"32", " ", 
         SuperscriptBox["ww", "2"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["H1", "2"], " ", "sz", " ", 
      RowBox[{"(", 
       RowBox[{"Delta", "-", 
        RowBox[{"2", " ", "ww"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"phi", "+", 
          RowBox[{"t0", " ", "ww"}]}], ")"}]}], "]"}]}], "+", 
     RowBox[{"H1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "16"}], " ", "Delta", " ", "sx", " ", 
         RowBox[{"(", 
          RowBox[{"Delta", "-", 
           RowBox[{"2", " ", "ww"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "2"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["H1", "2"], " ", "sx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "2"], " ", "sy", " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"64", " ", "sy", " ", 
         SuperscriptBox["ww", "2"], " ", 
         RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox["Delta", "2"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "-", 
        RowBox[{"32", " ", "Delta", " ", "sy", " ", "ww", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"phi", "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["H1", "2"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"2", " ", "t0", " ", "ww"}]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["H1", "2"], " ", "sy", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"3", " ", "phi"}], "+", 
           RowBox[{"4", " ", "t0", " ", "ww"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.72104428689825*^9, 3.721051528384952*^9, 
  3.7210526819692793`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"simplifying", " ", "this", " ", 
    RowBox[{"doesn", "'"}], "t", " ", "work", " ", "as", " ", "its", " ", 
    "the", " ", "general", " ", "form"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Bf", "[", 
     RowBox[{"tj_", ",", "t0_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"(", 
      RowBox[{"t0", "-", "tj"}], ")"}], "*", 
     RowBox[{"Hbarconst", "[", 
      RowBox[{"t0", ",", "tj"}], "]"}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.721044175157539*^9, 3.721044204755074*^9}, 
   3.721044334575451*^9, 3.721044366409321*^9, {3.721044454947535*^9, 
   3.721044485931843*^9}, {3.7210511732700167`*^9, 3.721051174388728*^9}, {
   3.721051474255281*^9, 3.721051501131967*^9}, {3.721051573637787*^9, 
   3.721051578258939*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Jf", "[", 
   RowBox[{"\[Alpha]j_", ",", "\[Alpha]0_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Af", "[", 
     RowBox[{
      RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
      RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], "+", 
    RowBox[{"Bf", "[", 
     RowBox[{
      RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
      RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Commutator", "[", 
      RowBox[{
       RowBox[{"Af", "[", 
        RowBox[{
         RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], ",", 
       RowBox[{"Bf", "[", 
        RowBox[{
         RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
         RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "12"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{"Af", "[", 
          RowBox[{
           RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
           RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{
           RowBox[{"Af", "[", 
            RowBox[{
             RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
             RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], ",", 
           RowBox[{"Bf", "[", 
            RowBox[{
             RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
             RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}]}], "]"}]}], "]"}], "+", 
       RowBox[{"Commutator", "[", 
        RowBox[{
         RowBox[{"Bf", "[", 
          RowBox[{
           RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
           RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{
           RowBox[{"Bf", "[", 
            RowBox[{
             RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
             RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}], ",", 
           RowBox[{"Af", "[", 
            RowBox[{
             RowBox[{"\[Alpha]j", "/", "ww"}], ",", 
             RowBox[{"\[Alpha]0", "/", "ww"}]}], "]"}]}], "]"}]}], "]"}]}], 
      ")"}]}]}], "//.", "SigmaComRules"}]}]], "Input",
 CellChangeTimes->{{3.721044389432254*^9, 3.7210444458141527`*^9}, {
   3.721047279794282*^9, 3.721047351369906*^9}, 3.7210474943813143`*^9, {
   3.721052374894273*^9, 3.721052436181465*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"256", " ", 
             SuperscriptBox["ww", "2"]}]], "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton",
             DisplayFunction->(FrameBox[
               
               RowBox[{
                "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
               Background -> GrayLevel[0.75], 
               BaseStyle -> {
                "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                 ShowStringCharacters -> False}, BaselinePosition -> Baseline,
                ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
               GrayLevel[0.75], RoundingRadius -> 7]& )], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"8", " ", "sz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Delta"}], " ", 
                 SuperscriptBox["H1", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["H1", "2"], " ", "ww"}], "+", 
                RowBox[{"16", " ", "Delta", " ", 
                 SuperscriptBox["ww", "2"]}]}], ")"}]}], "-", 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
             
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
             
             RowBox[{"H1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "16"}], " ", "Delta", " ", "sx", " ", 
                 RowBox[{"(", 
                  RowBox[{"Delta", "-", 
                   RowBox[{"2", " ", "ww"}]}], ")"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"phi", "+", 
                   RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
                TemplateBox[{"10"},
                 "OutputSizeLimit`Skeleton",
                 DisplayFunction->(FrameBox[
                   
                   RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                   Background -> GrayLevel[0.75], 
                   BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 1, 
                   FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                "+", 
                RowBox[{
                 SuperscriptBox["H1", "2"], " ", "sy", " ", 
                 RowBox[{"Sin", "[", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton",
                   DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                  "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
             ")"}]}], 
           RowBox[{"3072", " ", 
            SuperscriptBox["ww", "3"]}]], "+", 
          TemplateBox[{"1"},
           "OutputSizeLimit`Skeleton",
           DisplayFunction->(FrameBox[
             RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
             Background -> GrayLevel[0.75], 
             BaseStyle -> {
              "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
               ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
             ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
             GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
          RowBox[{
           FractionBox["1", "12"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"H1", " ", 
                  RowBox[{"(", 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                   ")"}]}], "+", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                 "-", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}],
                 ")"}]}], 
              RowBox[{"3072", " ", 
               SuperscriptBox["ww", "3"]}]], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["\[Alpha]0", "ww"], "-", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}],
                 ")"}], " ", 
               RowBox[{"(", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton",
                 DisplayFunction->(FrameBox[
                   
                   RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                   Background -> GrayLevel[0.75], 
                   BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 1, 
                   FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                ")"}]}], 
              RowBox[{"256", " ", 
               SuperscriptBox["ww", "2"]}]]}], ")"}]}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{58., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{50., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{50., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 57, 25973097131407368734, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{56., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 57, 25973097131407368734, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{42., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{42., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 57, 25973097131407368734, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{74., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{74., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[57]]], "Output",
 CellChangeTimes->{3.721044531699844*^9, 3.721047492099923*^9, 
  3.721047983531351*^9, 3.7210520968401413`*^9, 3.721053197823637*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfC0", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"Jf", "[", 
     RowBox[{"\[Alpha]j", ",", "\[Alpha]0"}], "]"}], ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7210445983038054`*^9, 3.721044604448729*^9}, {
  3.721052503009531*^9, 3.7210525050792522`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.721044609614009*^9, 3.7210482035846567`*^9, 
  3.721052236126339*^9, 3.7210524928301563`*^9, 3.721052529606338*^9, 
  3.721053287533429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfC1", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"Jf", "[", 
      RowBox[{"\[Alpha]j", ",", "\[Alpha]0"}], "]"}], ",", 
     RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.7210446148406763`*^9, 3.721044617503563*^9}, {
   3.721044656997959*^9, 3.7210446757213*^9}, 3.721048184235998*^9, {
   3.7210525092887297`*^9, 3.721052513936734*^9}, {3.7211220753866673`*^9, 
   3.721122076135886*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", "H1", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "sx"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7210446209611464`*^9, 3.72104466060515*^9, 
  3.721045043873933*^9, 3.721048268498653*^9, 3.721052559898611*^9, 
  3.7210533092571573`*^9, 3.721122117239579*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfC2", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"Jf", "[", 
      RowBox[{"\[Alpha]j", ",", "\[Alpha]0"}], "]"}], ",", 
     RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.7210483011904907`*^9, 3.7210483098945837`*^9}, {
  3.721052517786676*^9, 3.7210525238324223`*^9}, {3.7211220597452908`*^9, 
  3.7211220605751133`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", "H1", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"H1", " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
    RowBox[{"4", " ", "Delta", " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"2", " ", "H1", " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
      "]"}]}], "-", 
    RowBox[{"4", " ", "Delta", " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.721048332524579*^9, 3.721052591186449*^9, 
  3.721053382384519*^9, 3.721122093087208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"\[Alpha]j", "\[Rule]", "0"}]}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.7210501468199797`*^9, 3.7210501578995934`*^9}, {
  3.721050271400749*^9, 3.721050271575136*^9}, {3.721053484109458*^9, 
  3.7210534846805267`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", "H1", " ", 
  RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"H1", " ", "sz", " ", 
     RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "+", 
    RowBox[{"4", " ", "Delta", " ", "sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"2", " ", "H1", " ", "sz", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
    RowBox[{"4", " ", "Delta", " ", "sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.721050164007888*^9, 3.721050274441482*^9, 
  3.7210503086722918`*^9, 3.72105348653736*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"%63", "-", 
   RowBox[{
    FractionBox["1", "32"], " ", "\[ImaginaryI]", " ", "H1", " ", 
    RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "+", 
      RowBox[{"4", " ", "Delta", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
      RowBox[{"2", " ", "H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0"}], "]"}]}], "-", 
      RowBox[{"4", " ", "Delta", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}]}], "//", 
  "FS"}]], "Input",
 CellChangeTimes->{{3.721050444758293*^9, 3.721050479344296*^9}, {
  3.721053523170371*^9, 3.721053524529043*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfC3", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"Jf", "[", 
      RowBox[{"\[Alpha]j", ",", "\[Alpha]0"}], "]"}], ",", 
     RowBox[{"1", "/", "ww"}], ",", "3"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.721053921819437*^9, 3.72105392790985*^9}, {
  3.721122102099556*^9, 3.721122103128755*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "1536"], 
   RowBox[{"\[ImaginaryI]", " ", "H1", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"48", " ", "Delta", " ", "H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"48", " ", "Delta", " ", "H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}]}], ")"}]}]}]}]], "Output",\

 CellChangeTimes->{3.721053953988502*^9, 3.7211221699538393`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Jump from one constant drive level to another constant drive level\
\>", "Section",
 CellChangeTimes->{{3.7211212273055468`*^9, 3.7211212429012127`*^9}}],

Cell["\<\
Now we consider jumping from the effective trajectory of constant drive \
strength HA strength for t < tj to the effective trajectory of constant drive \
strength HB for t > tj. Remember: Jf is defined from the real trajectory to \
the effective one. Let\[CloseCurlyQuote]s define Jff jumping from HA to Hreal \
to HB, in line with the Jf definition that we end up on the latest (in time) \
effective trajectory.

So:
exp[ Jff ] = exp[ JfB ] exp [ -JfA ]

we truncate the partial jump operators after order three, otherwise this is \
gonna take forever
\
\>", "Text",
 CellChangeTimes->{{3.72112128387941*^9, 3.7211213979142237`*^9}, {
  3.72112143453277*^9, 3.721121606768746*^9}, {3.721121867459375*^9, 
  3.721121920050819*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfTrunc", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ww", "^", "0"}]}], "*", "JfC0"}], "+", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ww", "^", "1"}]}], "*", "JfC1"}], "+", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ww", "^", "2"}]}], "*", "JfC2"}], "+", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ww", "^", "3"}]}], "*", "JfC3"}]}]}]], "Input",
 CellChangeTimes->{{3.72112195852098*^9, 3.721122027254294*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "H1", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sx"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}], 
   RowBox[{"4", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "H1", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Delta", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", "H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"4", " ", "Delta", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}]}], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1536", " ", 
     SuperscriptBox["ww", "3"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "H1", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"48", " ", "Delta", " ", "H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"48", " ", "Delta", " ", "H1", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["H1", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}]}], ")"}]}]}]}]], "Output",\

 CellChangeTimes->{{3.7211219888763533`*^9, 3.721122028502857*^9}, 
   3.72112218227194*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfTruncA", "=", 
  RowBox[{"JfTrunc", "/.", 
   RowBox[{"H1", "\[Rule]", "HA"}]}]}]], "Input",
 CellChangeTimes->{{3.721122196240919*^9, 3.721122219565176*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "HA", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sx"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}], 
   RowBox[{"4", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "HA", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"HA", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Delta", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", "HA", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"4", " ", "Delta", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}]}], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1536", " ", 
     SuperscriptBox["ww", "3"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "HA", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"48", " ", "Delta", " ", "HA", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"48", " ", "Delta", " ", "HA", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["HA", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["HA", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}]}], ")"}]}]}]}]], "Output",\

 CellChangeTimes->{3.721122220100741*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JfTruncB", "=", 
  RowBox[{"JfTrunc", "/.", 
   RowBox[{"H1", "\[Rule]", "HB"}]}]}]], "Input",
 CellChangeTimes->{{3.721122224306471*^9, 3.7211222356134033`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "HB", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "sx"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}], 
   RowBox[{"4", " ", "ww"}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"32", " ", 
     SuperscriptBox["ww", "2"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "HB", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"HB", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"4", " ", "Delta", " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", "HB", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"4", " ", "Delta", " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
     ")"}]}]}], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1536", " ", 
     SuperscriptBox["ww", "3"]}]], 
   RowBox[{"\[ImaginaryI]", " ", "HB", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"48", " ", "Delta", " ", "HB", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"48", " ", "Delta", " ", "HB", " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["HB", "2"], " ", "sx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"96", " ", 
       SuperscriptBox["Delta", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
      RowBox[{"12", " ", 
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
        "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
        "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "-", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["HB", "2"], " ", "sy", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
         RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}]}], ")"}]}]}]}]], "Output",\

 CellChangeTimes->{3.721122235919444*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BCHFormula", "[", 
   RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"A", "+", "B", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Commutator", "[", 
      RowBox[{"A", ",", "B"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "12"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Commutator", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{"A", ",", "B"}], "]"}]}], "]"}], "+", 
       RowBox[{"Commutator", "[", 
        RowBox[{"B", ",", 
         RowBox[{"Commutator", "[", 
          RowBox[{"B", ",", "A"}], "]"}]}], "]"}]}], ")"}]}]}], "//.", 
   "SigmaComRules"}]}]], "Input",
 CellChangeTimes->{{3.72112225812251*^9, 3.721122313576762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Jff", "=", 
  RowBox[{"BCHFormula", "[", 
   RowBox[{"JfTruncB", ",", 
    RowBox[{"-", "JfTruncA"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.721122328182218*^9, 3.721122353016985*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "HA", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "sx"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}],
                "+", 
               RowBox[{"sy", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
                 "]"}]}]}], ")"}]}], 
            RowBox[{"4", " ", "ww"}]]}], "+", 
          TemplateBox[{"7"},
           "OutputSizeLimit`Skeleton",
           DisplayFunction->(FrameBox[
             RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
             Background -> GrayLevel[0.75], 
             BaseStyle -> {
              "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
               ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
             ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
             GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "HB", " ", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton",
                DisplayFunction->(FrameBox[
                  
                  RowBox[{
                   "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                  Background -> GrayLevel[0.75], 
                  BaseStyle -> {
                   "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                  Baseline, ContentPadding -> False, FrameMargins -> 1, 
                  FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                   RowBox[{"4", " ", 
                    TemplateBox[{"2"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 
                    7]& )]}]]}], "+", 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton",
                  DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}],
                 ")"}]}], 
              RowBox[{"32", " ", 
               SuperscriptBox["ww", "2"]}]], "+", 
             FractionBox[
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton",
               DisplayFunction->(FrameBox[
                 RowBox[{
                  "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                 Background -> GrayLevel[0.75], 
                 BaseStyle -> {
                  "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                   ShowStringCharacters -> False}, BaselinePosition -> 
                 Baseline, ContentPadding -> False, FrameMargins -> 1, 
                 FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
              RowBox[{"4", " ", "ww"}]], "+", 
             TemplateBox[{"6"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
             
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "-", 
             
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               TemplateBox[{"3"},
                "OutputSizeLimit`Skeleton",
                DisplayFunction->(FrameBox[
                  
                  RowBox[{
                   "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                  Background -> GrayLevel[0.75], 
                  BaseStyle -> {
                   "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                  Baseline, ContentPadding -> False, FrameMargins -> 1, 
                  FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}], 
              RowBox[{"1536", " ", 
               SuperscriptBox["ww", "3"]}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "12"], " ", 
           RowBox[{"(", 
            RowBox[{
             TemplateBox[{"71"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
             
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "HA", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
               RowBox[{"(", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton",
                 DisplayFunction->(FrameBox[
                   
                   RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                   Background -> GrayLevel[0.75], 
                   BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 1, 
                   FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                ")"}]}], 
              RowBox[{"1536", " ", 
               SuperscriptBox["ww", "3"]}]]}], ")"}]}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{58., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{50., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 104, 25973097131407368734, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{56., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 104, 25973097131407368734, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{42., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{42., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 104, 25973097131407368734, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{74., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{74., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[104]]], "Output",
 CellChangeTimes->{3.7211224036147957`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JffC0", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"Jff", ",", 
    RowBox[{"1", "/", "ww"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.721122424787615*^9, 3.721122428795854*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.721122431969636*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JffC1", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"Jff", ",", 
     RowBox[{"1", "/", "ww"}], ",", "1"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.721122437794916*^9, 3.7211224446830177`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"HA", "-", "HB"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.721122440919057*^9, 3.721122446176498*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JffC2", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"Jff", ",", 
     RowBox[{"1", "/", "ww"}], ",", "2"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.7211224556514473`*^9, 3.721122467083727*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "32"]}], " ", "\[ImaginaryI]", " ", 
  RowBox[{"(", 
   RowBox[{"HA", "-", "HB"}], ")"}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"HA", "+", "HB"}], ")"}], " ", "sz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
         "]"}]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", "Delta", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
       RowBox[{"sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.721122462937064*^9, 3.7211224735305367`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JffC3", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"Jff", ",", 
     RowBox[{"1", "/", "ww"}], ",", "3"}], "]"}], "//", "FS"}]}]], "Input",
 CellChangeTimes->{{3.721122484302951*^9, 3.721122499925363*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "1536"], 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{"HA", "-", "HB"}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"48", " ", "Delta", " ", 
      RowBox[{"(", 
       RowBox[{"HA", "+", "HB"}], ")"}], " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["HA", "2"], "+", 
        SuperscriptBox["HB", "2"]}], ")"}], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"4", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"12", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"96", " ", 
      SuperscriptBox["Delta", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"2", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"48", " ", "Delta", " ", "HA", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"48", " ", "Delta", " ", "HB", " ", "sz", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"12", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
       "]"}]}], "+", 
     RowBox[{"9", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
       "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
     RowBox[{"2", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["HA", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
     RowBox[{"3", " ", "HA", " ", "HB", " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["HB", "2"], " ", "sx", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"4", " ", "HA", " ", "HB", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", 
        RowBox[{"3", " ", "\[Alpha]0"}], "-", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"12", " ", "HA", " ", "HB", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"96", " ", 
      SuperscriptBox["Delta", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"2", " ", "HA", " ", "HB", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "+", "\[Alpha]0", "+", "\[Alpha]j"}], "]"}]}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"12", " ", "HA", " ", "HB", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"12", " ", 
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"9", " ", "HA", " ", "HB", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
       "]"}]}], "-", 
     RowBox[{"3", " ", 
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "+", "\[Alpha]j"}], 
       "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["HA", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", "HA", " ", "HB", " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["HB", "2"], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"phi", "-", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["HA", "2"], "-", 
        RowBox[{"HA", " ", "HB"}], "+", 
        SuperscriptBox["HB", "2"]}], ")"}], " ", "sy", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"3", " ", "phi"}], "+", "\[Alpha]0", "+", 
        RowBox[{"3", " ", "\[Alpha]j"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.72112249687551*^9, 3.721122787758259*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JfC3", "-", "JffC3"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"HA", "\[Rule]", "0"}], ",", 
     RowBox[{"HB", "\[Rule]", "H1"}]}], "}"}]}], "//", "FS"}]], "Input",
 CellChangeTimes->{{3.721123741149138*^9, 3.721123792744008*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.721123764046105*^9, 3.721123793395412*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JffC1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Alpha]j", "\[Rule]", "0"}], ",", 
    RowBox[{"HA", "\[Rule]", "0"}], ",", 
    RowBox[{"phi", "\[Rule]", "0"}], ",", 
    RowBox[{"Delta", "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.72112934497593*^9, 3.721129385624302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "HB", " ", 
  RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sx", " ", 
     RowBox[{"Cos", "[", "\[Alpha]0", "]"}]}], "-", 
    RowBox[{"sy", " ", 
     RowBox[{"Sin", "[", "\[Alpha]0", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.721129386196434*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.721129446377288*^9, 3.7213693301021433`*^9}]
}, Open  ]]
},
WindowSize->{819, 826},
WindowMargins->{{Automatic, 59}, {22, Automatic}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 136, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[719, 27, 95, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[839, 32, 311, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[1175, 43, 1225, 17, 22, "Print"],
Cell[2403, 62, 1314, 20, 22, "Print"],
Cell[3720, 84, 1224, 17, 22, "Print"],
Cell[4947, 103, 2360, 64, 665, "Print"]
}, Open  ]]
}, Open  ]],
Cell[7334, 171, 624, 17, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7995, 193, 274, 3, 64, "Section"],
Cell[8272, 198, 220, 4, 30, "Text"],
Cell[8495, 204, 745, 23, 46, "Input"],
Cell[CellGroupData[{
Cell[9265, 231, 647, 18, 34, "Input"],
Cell[9915, 251, 999, 16, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10951, 272, 291, 6, 28, "Input"],
Cell[11245, 280, 1579, 34, 47, "Output"]
}, Open  ]],
Cell[12839, 317, 164, 3, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13040, 325, 111, 1, 64, "Section"],
Cell[13154, 328, 179, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[13358, 335, 844, 18, 63, "Input"],
Cell[14205, 355, 3024, 81, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17266, 441, 952, 26, 97, "Input"],
Cell[CellGroupData[{
Cell[18243, 471, 831, 16, 38, "Print"],
Cell[19077, 489, 684, 13, 22, "Print"],
Cell[19764, 504, 837, 17, 22, "Print"],
Cell[20604, 523, 724, 14, 22, "Print"],
Cell[21331, 539, 676, 13, 22, "Print"],
Cell[22010, 554, 712, 13, 22, "Print"],
Cell[22725, 569, 835, 17, 22, "Print"],
Cell[23563, 588, 722, 14, 22, "Print"],
Cell[24288, 604, 698, 13, 22, "Print"],
Cell[24989, 619, 829, 16, 38, "Print"],
Cell[25821, 637, 682, 13, 22, "Print"],
Cell[26506, 652, 833, 17, 22, "Print"],
Cell[27342, 671, 722, 14, 22, "Print"],
Cell[28067, 687, 672, 13, 22, "Print"],
Cell[28742, 702, 714, 13, 22, "Print"],
Cell[29459, 717, 833, 17, 22, "Print"],
Cell[30295, 736, 722, 14, 22, "Print"],
Cell[31020, 752, 698, 13, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[31745, 769, 279, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[32049, 780, 624, 20, 28, "Input"],
Cell[32676, 802, 6657, 174, 282, "Output"]
}, Open  ]],
Cell[39348, 979, 287, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[39660, 991, 242, 6, 28, "Input"],
Cell[39905, 999, 6462, 171, 282, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46416, 1176, 99, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[46540, 1181, 5099, 136, 227, "Input"],
Cell[51642, 1319, 4566, 130, 191, "Output"]
}, Open  ]],
Cell[56223, 1452, 267, 7, 28, "Input"],
Cell[56493, 1461, 92, 1, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56622, 1467, 107, 1, 64, "Section"],
Cell[56732, 1470, 218, 3, 28, "Input"],
Cell[56953, 1475, 92, 1, 28, "Input"],
Cell[CellGroupData[{
Cell[57070, 1480, 528, 12, 28, "Input"],
Cell[57601, 1494, 2207, 57, 112, "Output"]
}, Open  ]],
Cell[59823, 1554, 99, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[59947, 1559, 377, 9, 28, "Input"],
Cell[60327, 1570, 498, 12, 47, "Output"]
}, Open  ]],
Cell[60840, 1585, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[60962, 1590, 526, 11, 28, "Input"],
Cell[61491, 1603, 3046, 84, 119, "Output"]
}, Open  ]],
Cell[64552, 1690, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[64674, 1695, 329, 8, 28, "Input"],
Cell[65006, 1705, 1617, 49, 68, "Output"]
}, Open  ]],
Cell[66638, 1757, 74, 1, 28, "Input"],
Cell[66715, 1760, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[66837, 1765, 307, 8, 28, "Input"],
Cell[67147, 1775, 119, 2, 28, "Output"]
}, Open  ]],
Cell[67281, 1780, 231, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[67537, 1788, 439, 12, 28, "Input"],
Cell[67979, 1802, 2401, 64, 110, "Output"]
}, Open  ]],
Cell[70395, 1869, 9287, 231, 348, "Input"],
Cell[CellGroupData[{
Cell[79707, 2104, 643, 14, 28, "Input"],
Cell[80353, 2120, 3144, 77, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83534, 2202, 485, 10, 28, "Input"],
Cell[84022, 2214, 1862, 55, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85921, 2274, 335, 8, 28, "Input"],
Cell[86259, 2284, 1305, 41, 68, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87613, 2331, 122, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[87760, 2336, 441, 10, 28, "Input"],
Cell[88204, 2348, 1457, 38, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89698, 2391, 679, 15, 28, "Input"],
Cell[90380, 2408, 1362, 37, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91779, 2450, 402, 11, 28, "Input"],
Cell[92184, 2463, 3492, 93, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95713, 2561, 1482, 42, 122, "Input"],
Cell[97198, 2605, 15334, 364, 167, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112569, 2974, 153, 3, 28, "Input"],
Cell[112725, 2979, 98, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112860, 2985, 203, 5, 28, "Input"],
Cell[113066, 2992, 51974, 1272, 1983, "Output"]
}, Open  ]],
Cell[165055, 4267, 130, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[165210, 4272, 355, 8, 28, "Input"],
Cell[165568, 4282, 138, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165743, 4289, 462, 10, 28, "Input"],
Cell[166208, 4301, 600, 15, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166845, 4321, 429, 9, 28, "Input"],
Cell[167277, 4332, 1267, 34, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168581, 4371, 878, 22, 86, "Input"],
Cell[169462, 4395, 1131, 31, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[170642, 4432, 168, 2, 64, "Section"],
Cell[170813, 4436, 1657, 32, 296, "Text"],
Cell[CellGroupData[{
Cell[172495, 4472, 608, 16, 28, "Input"],
Cell[173106, 4490, 3251, 89, 156, "Output"]
}, Open  ]],
Cell[176372, 4582, 862, 21, 46, "Input"],
Cell[CellGroupData[{
Cell[177259, 4607, 2367, 65, 156, "Input"],
Cell[179629, 4674, 17178, 401, 165, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196844, 5080, 342, 8, 28, "Input"],
Cell[197189, 5090, 190, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197416, 5098, 495, 11, 28, "Input"],
Cell[197914, 5111, 667, 17, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198618, 5133, 427, 10, 28, "Input"],
Cell[199048, 5145, 926, 23, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200011, 5173, 283, 6, 28, "Input"],
Cell[200297, 5181, 795, 19, 66, "Output"]
}, Open  ]],
Cell[201107, 5203, 883, 22, 102, "Input"],
Cell[CellGroupData[{
Cell[202015, 5229, 367, 9, 28, "Input"],
Cell[202385, 5240, 4389, 110, 190, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[206823, 5356, 163, 3, 99, "Section"],
Cell[206989, 5361, 741, 17, 201, "Text"],
Cell[CellGroupData[{
Cell[207755, 5382, 479, 15, 28, "Input"],
Cell[208237, 5399, 5870, 152, 263, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214144, 5556, 184, 4, 28, "Input"],
Cell[214331, 5562, 5819, 151, 263, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220187, 5718, 186, 4, 28, "Input"],
Cell[220376, 5724, 5819, 151, 263, "Output"]
}, Open  ]],
Cell[226210, 5878, 764, 23, 104, "Input"],
Cell[CellGroupData[{
Cell[226999, 5905, 212, 5, 28, "Input"],
Cell[227214, 5912, 15939, 374, 186, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243190, 6291, 219, 5, 28, "Input"],
Cell[243412, 6298, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243519, 6304, 249, 6, 28, "Input"],
Cell[243771, 6312, 577, 16, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244385, 6333, 249, 6, 28, "Input"],
Cell[244637, 6341, 1099, 32, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245773, 6378, 247, 6, 28, "Input"],
Cell[246023, 6386, 10128, 255, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256188, 6646, 288, 8, 28, "Input"],
Cell[256479, 6656, 94, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256610, 6662, 325, 8, 28, "Input"],
Cell[256938, 6672, 394, 11, 47, "Output"]
}, Open  ]],
Cell[257347, 6686, 92, 1, 28, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
