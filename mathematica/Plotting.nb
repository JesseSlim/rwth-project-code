(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     94285,       2222]
NotebookOptionsPosition[     92724,       2164]
NotebookOutlinePosition[     93106,       2181]
CellTagsIndexPosition[     93063,       2178]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Visualizations of qubit driving beyond the RWA", \
"Title"]], "Text",
 CellChangeTimes->{{3.720415856469101*^9, 3.720415908146785*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Original Hamiltonian & Magnus approximation \
Hamiltonians", "Chapter"]], "Section",
 CellChangeTimes->{{3.720415922532062*^9, 3.720415974260635*^9}, {
  3.720502947730855*^9, 3.720502953208394*^9}}],

Cell["\<\

Define original Hamiltonian in the rotating frame\
\>", "Text",
 CellChangeTimes->{{3.7196436607136917`*^9, 3.7196436919140244`*^9}, 
   3.719657744467873*^9, {3.720244319005018*^9, 3.7202443210489607`*^9}, 
   3.720415852398018*^9}],

Cell[BoxData[
 RowBox[{"Horig", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"H1", "/", "4"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "phi", "]"}], "*", "sx"}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "sx"}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", "phi", "]"}], "sy"}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", "*", "ww", "*", "t"}], "+", "phi"}], "]"}], "*", 
       "sy"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Delta", "/", "2"}], "*", "sz"}]}]}]], "Input",
 CellChangeTimes->{{3.719643473500388*^9, 3.7196436036867323`*^9}, {
   3.719643650553937*^9, 3.7196436528412933`*^9}, {3.720244552513276*^9, 
   3.720244588137054*^9}, {3.720244629147169*^9, 3.720244667635796*^9}, 
   3.7203341327742767`*^9}],

Cell["Define Magnus approximation Hamiltonians", "Text",
 CellChangeTimes->{{3.71964340444093*^9, 3.719643433346612*^9}, {
  3.720245446605926*^9, 3.72024544741252*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"termHww0", "=", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Delta", " ", "sz"}], "+", 
      RowBox[{"H1", " ", "sx", " ", 
       RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
      RowBox[{"H1", " ", "sy", " ", 
       RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termHwwM1", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"32", " ", "ww"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["H1", "2"], " ", "sz", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Delta", " ", "H1", " ", "sx"}], "+", 
         RowBox[{"H1D", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"H1D", " ", "sx"}], "-", 
         RowBox[{"Delta", " ", "H1", " ", "sy"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", 
         RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"termHwwM2", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"256", " ", 
       SuperscriptBox["ww", "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "Delta", " ", 
        SuperscriptBox["H1", "2"], " ", "sz"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", 
        RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
       RowBox[{"8", " ", "Delta", " ", 
        SuperscriptBox["H1", "2"], " ", "sz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
       RowBox[{"16", " ", 
        SuperscriptBox["Delta", "2"], " ", "H1", " ", "sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
       RowBox[{"16", " ", "H1DD", " ", "sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
       RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sy", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["H1", "3"], " ", "sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"3", " ", "phi"}], "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["H1", "3"], " ", "sx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"3", " ", "phi"}], "+", 
          RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", 
        RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
       RowBox[{"24", " ", "H1", " ", "H1D", " ", "sz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"phi", "+", "\[Alpha]0"}], ")"}]}], "]"}]}], "-", 
       RowBox[{"32", " ", "Delta", " ", "H1D", " ", "sx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
       RowBox[{"16", " ", 
        SuperscriptBox["Delta", "2"], " ", "H1", " ", "sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "-", 
       RowBox[{"16", " ", "H1DD", " ", "sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"phi", "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["H1", "3"], " ", "sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"3", " ", "phi"}], "+", 
          RowBox[{"2", " ", "\[Alpha]0"}]}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["H1", "3"], " ", "sy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"3", " ", "phi"}], "+", 
          RowBox[{"4", " ", "\[Alpha]0"}]}], "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hww0", "=", "termHww0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HwwM1", "=", 
   RowBox[{"termHww0", "+", "termHwwM1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HwwM2", "=", 
    RowBox[{"termHww0", "+", "termHwwM1", "+", "termHwwM2"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApproxHList", "=", 
   RowBox[{"{", 
    RowBox[{"Hww0", ",", "HwwM1", ",", "HwwM2"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719643381072638*^9, 3.719643396752432*^9}, {
  3.7196434965181017`*^9, 3.7196434980195923`*^9}, {3.7202442779699717`*^9, 
  3.720244309855783*^9}, {3.720245964623187*^9, 3.720246063536854*^9}, {
  3.7202461644283943`*^9, 3.720246231240554*^9}, {3.720248708864814*^9, 
  3.7202487111749573`*^9}, {3.720268371550209*^9, 3.720268372408391*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of the driving envelopes", "Chapter",
 CellChangeTimes->{{3.719753983824387*^9, 3.7197539861273727`*^9}, {
  3.7202683776598577`*^9, 3.720268378498946*^9}, {3.720349085146244*^9, 
  3.7203490888034067`*^9}, {3.720416056449759*^9, 3.720416062111112*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"id2", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"ones2", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Cosine", " ", "profile"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cosineH1p", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "*", "Pi", "*", "t"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cosineJmp", " ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Trapezoid", " ", "profile"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trapezoidH1p", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"t", ",", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"t", "<", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t", "/", 
            RowBox[{"(", 
             RowBox[{"tr", "-", 
              RowBox[{"tr", "^", "2"}]}], ")"}]}], ",", 
           RowBox[{"t", "<", "tr"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}], ",", 
           RowBox[{"t", "<", 
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "t"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"tr", "-", 
              RowBox[{"tr", "^", "2"}]}], ")"}]}], ",", 
           RowBox[{"t", "<", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"t", ">", "1"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
       "]"}]}], " ", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"tr", "\[Rule]", "0.2"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trapezoidJmp", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Cosine", "-", 
    RowBox[{"trapezoid", " ", "profile"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costrapH1p", "=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"t", ",", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"t", "<", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"Pi", "*", 
                 RowBox[{"t", "/", "tr"}]}], "]"}], "/", "2"}]}], ")"}], "/", 
            
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}], ",", 
           RowBox[{"t", "<", "tr"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}], ",", 
           RowBox[{"t", "<", 
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", "/", "2"}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"Pi", "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "t"}], ")"}], "/", "tr"}]}], "]"}], "/", 
               "2"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}], ",", 
           RowBox[{"t", "<", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"t", ">", "1"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
       "]"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"tr", "\[Rule]", 
      RowBox[{"1", "/", "5"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"costrapJmp", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constantH1p", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constantJmp", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"0", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"4", "ww"}]]}], " ", "\[ImaginaryI]", " ", "H1", " ", 
       RowBox[{"Sin", "[", "\[Alpha]0", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sx", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}], "-", 
         RowBox[{"sy", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", "\[Alpha]0"}], "]"}]}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1pOptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[Rule]", "\"\<constant\>\""}], ",", 
     RowBox[{"2", "\[Rule]", "\"\<cosine\>\""}], ",", 
     RowBox[{"3", "\[Rule]", "\"\<trapezoid\>\""}], ",", 
     RowBox[{"4", "\[Rule]", "\"\<step function with cos ramps\>\""}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1pList", "=", 
   RowBox[{"{", 
    RowBox[{
    "constantH1p", ",", "cosineH1p", ",", "trapezoidH1p", ",", "costrapH1p"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jmpList", "=", 
    RowBox[{"{", 
     RowBox[{
     "constantJmp", ",", " ", "cosineJmp", ",", "trapezoidJmp", ",", 
      "costrapJmp"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"H1profile", "=", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"t", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", "t", "]"}], "-", 
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"t", "-", "tr"}], "]"}]}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"Pi", "*", 
                RowBox[{"t", "/", "tr"}]}], "]"}], "/", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "tr"}], ")"}]}]}], "\[IndentingNewLine]", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"t", "-", "tr"}], "]"}], "-", 
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"t", "-", "1", "+", "tr"}], "]"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "tr"}], ")"}]}], ")"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"t", "-", "1", "+", "tr"}], "]"}], "-", 
            RowBox[{"HeavisideTheta", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"Pi", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "t"}], ")"}], "/", "tr"}]}], "]"}], "/", 
              "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "tr"}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
       "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"tr", "\[Rule]", 
        RowBox[{"1", "/", "5"}]}], "}"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PopupMenu", "[", 
  RowBox[{
   RowBox[{"Dynamic", "[", "selprof", "]"}], ",", "H1pOptions"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"H1pList", "[", 
      RowBox[{"[", "selprof", "]"}], "]"}], "@", "t"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<t/t_max\>\"", ",", "\"\<H1/H1_avg\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<driving envelope H1(t)\>\""}]}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.719813276104945*^9, 3.719813281352642*^9}, {
   3.720266739595523*^9, 3.72026680429106*^9}, {3.720266905183339*^9, 
   3.720266948230866*^9}, {3.720266981312031*^9, 3.7202670323321037`*^9}, {
   3.7202672274332438`*^9, 3.720267271592948*^9}, {3.72026741191917*^9, 
   3.720267453792047*^9}, {3.72026748825782*^9, 3.720267494673595*^9}, {
   3.720267547716856*^9, 3.720267592363762*^9}, {3.7202676239672947`*^9, 
   3.7202676798461857`*^9}, {3.720267721080347*^9, 3.720267721879774*^9}, {
   3.720267778205008*^9, 3.720267831172491*^9}, {3.720267861796727*^9, 
   3.720267877500526*^9}, {3.7202679107836437`*^9, 3.720267915478465*^9}, {
   3.720268076244336*^9, 3.720268190866675*^9}, {3.7202682248174877`*^9, 
   3.720268265328919*^9}, {3.720268301556294*^9, 3.7202683152184277`*^9}, {
   3.720268386543592*^9, 3.7202683871865396`*^9}, {3.720268639550334*^9, 
   3.720268721637198*^9}, {3.720331019478126*^9, 3.720331066261516*^9}, {
   3.720331196985037*^9, 3.720331201863633*^9}, {3.720333179408434*^9, 
   3.720333195835477*^9}, {3.720333499391531*^9, 3.7203335083590193`*^9}, {
   3.720333579743729*^9, 3.720333585223814*^9}, 3.720335455942601*^9, {
   3.720335545105612*^9, 3.72033555755285*^9}, 3.720355513649579*^9, {
   3.72035599041612*^9, 3.720356056575248*^9}, {3.720356088866191*^9, 
   3.7203564705029078`*^9}, {3.720356510495723*^9, 3.720356548256439*^9}, {
   3.720416517520042*^9, 3.720416517677897*^9}, {3.720416551520164*^9, 
   3.7204166948204193`*^9}, {3.72043353806583*^9, 3.720433555385394*^9}, {
   3.720438511996814*^9, 3.720438539773818*^9}, {3.720440701307568*^9, 
   3.720440714771039*^9}, {3.720502044311821*^9, 3.720502048941143*^9}, {
   3.720867840722589*^9, 3.720867850358924*^9}, {3.7208678940854187`*^9, 
   3.720867948418954*^9}, {3.720867980809053*^9, 3.7208679837721043`*^9}, {
   3.720868027730586*^9, 3.720868031525524*^9}, 3.7208682846405077`*^9, {
   3.720869871860929*^9, 3.7208698760412197`*^9}, 3.720870244286984*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trajectory integration and coordinate transformations", "Chapter",
 CellChangeTimes->{{3.720416000990511*^9, 3.72041603102313*^9}, {
  3.720505805275112*^9, 3.720505808025489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pms", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"si", "\[Rule]", 
      RowBox[{"PauliMatrix", "[", "0", "]"}]}], ",", 
     RowBox[{"sx", "\[Rule]", 
      RowBox[{"PauliMatrix", "[", "1", "]"}]}], ",", 
     RowBox[{"sy", "\[Rule]", 
      RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", 
     RowBox[{"sz", "\[Rule]", 
      RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H1Dsubs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H1", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"H1", "[", "t", "]"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"H1D", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"H1", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1"}], "}"}]}], "]"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"H1DD", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"H1", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"H1DDD", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"H1", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "3"}], "}"}]}], "]"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"H1DDDD", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"H1", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "4"}], "}"}]}], "]"}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssembleH", "[", 
    RowBox[{"H_", ",", "H1f_", ",", "vals_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"H", "/.", "vals"}], "/.", "H1Dsubs"}], "/.", "pms"}], "/.", 
     RowBox[{"{", 
      RowBox[{"H1", "\[Rule]", "H1f"}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToHFunc", "[", "H_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "\[Alpha]0"}], "}"}], ",", "func"}], "]"}], "/.", 
    RowBox[{"func", "\[Rule]", "H"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetHFunc", "[", 
    RowBox[{"H_", ",", "H1f_", ",", "vals_"}], "]"}], ":=", 
   RowBox[{"ToHFunc", "@", 
    RowBox[{"AssembleH", "[", 
     RowBox[{"H", ",", "H1f", ",", "vals"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719643717851988*^9, 3.719643722578844*^9}, {
   3.7196445358476553`*^9, 3.719644645913954*^9}, 3.719644992270249*^9, {
   3.7196450874805927`*^9, 3.719645101937063*^9}, {3.719645166643141*^9, 
   3.719645174523979*^9}, {3.719646103414359*^9, 3.719646119832254*^9}, {
   3.719646168655179*^9, 3.7196461788069487`*^9}, {3.7196463846793957`*^9, 
   3.719646390557131*^9}, {3.719646450568348*^9, 3.719646468168521*^9}, {
   3.719646508600741*^9, 3.719646518312168*^9}, {3.7196465654593678`*^9, 
   3.719646574014278*^9}, {3.71964660406135*^9, 3.7196466172357883`*^9}, {
   3.7196467640886707`*^9, 3.719646784321706*^9}, {3.719651934490148*^9, 
   3.719651955486479*^9}, {3.7196520793437443`*^9, 3.719652080619643*^9}, {
   3.719652110886743*^9, 3.7196521323243837`*^9}, {3.719652912585964*^9, 
   3.7196529681193132`*^9}, {3.719653010339864*^9, 3.719653012248835*^9}, {
   3.719653562023431*^9, 3.71965359310808*^9}, 3.7197264696092863`*^9, {
   3.719726534188534*^9, 3.719726555250202*^9}, {3.7202444989299*^9, 
   3.720244499447023*^9}, {3.720245034401173*^9, 3.720245060520206*^9}, {
   3.720333881548126*^9, 3.720333916662674*^9}, {3.720334062056768*^9, 
   3.720334072368347*^9}, {3.72043352496012*^9, 3.72043353067106*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Numerically", " ", "compute", " ", "trajectory", " ", "from", " ", "any", 
    " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NTrajectory", "[", 
     RowBox[{"Hfunc_", ",", "tM_", ",", "\[Alpha]0_", ",", "\[Psi]0_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"I", "*", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"\[Psi]", "[", "t", "]"}], ",", "t"}], "]"}]}], 
              "\[Equal]", 
              RowBox[{
               RowBox[{"Hfunc", "[", 
                RowBox[{"t", ",", "\[Alpha]0"}], "]"}], ".", 
               RowBox[{"\[Psi]", "[", "t", "]"}]}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"Indeterminate", "\[Rule]", "0"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"\[Psi]", "[", "0", "]"}], "==", "\[Psi]0"}]}], "}"}], 
         ",", "\[Psi]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tM"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Helper", " ", "functions", " ", "for", " ", "plotting"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Coordinate", " ", "transforms"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlochCoordinatesFromState", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "state", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Conjugate]"}]}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Conjugate]"}], 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Im", "[", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{
              RowBox[{"state", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Conjugate]"}]}], "]"}]}], 
          "+", 
          RowBox[{"Im", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Conjugate]"}], "*", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"state", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Conjugate]"}]}], "-", 
          RowBox[{
           RowBox[{"state", "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Conjugate]"}]}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RotationAxisFromHamiltonian", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "H", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"Tr", "[", 
            RowBox[{"H", ".", 
             RowBox[{"PauliMatrix", "[", "i", "]"}]}], "]"}], "/", "2."}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Cartesian", " ", "Bloch", " ", "angles", " ", "transformations"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RestrictAngleMPiPPi", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"x", "+", "Pi"}], ",", 
          RowBox[{"2", "Pi"}]}], "]"}], "-", "Pi"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlochAngleCoordinatesFromState", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "state", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RestrictAngleMPiPPi", "[", 
          RowBox[{
           RowBox[{"Arg", "[", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", 
           RowBox[{"Arg", "[", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"2", "*", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XBasisFromZBasis", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "state", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Mercator", " ", "transformations"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MercatorCoordinatesFromBlochAngle", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "coords", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coords", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"ArcTanh", "[", 
           RowBox[{"Cos", "[", 
            RowBox[{"coords", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7196456313106613`*^9, 3.7196457882836943`*^9}, {
   3.7196458716288233`*^9, 3.719645911340754*^9}, {3.719645962519986*^9, 
   3.71964596967822*^9}, {3.7196533116293583`*^9, 3.7196534768806133`*^9}, {
   3.7196535952050047`*^9, 3.719653636196929*^9}, {3.719653924912017*^9, 
   3.719653952078833*^9}, {3.719653982641733*^9, 3.7196541434211063`*^9}, {
   3.719654220012231*^9, 3.719654233648473*^9}, {3.719654305510405*^9, 
   3.719654370261098*^9}, 3.7196545885118237`*^9, {3.7196546591842413`*^9, 
   3.71965466040137*^9}, {3.719656570585896*^9, 3.719656791159357*^9}, {
   3.7196568442729473`*^9, 3.719656851205359*^9}, {3.7196572565643587`*^9, 
   3.719657313018717*^9}, {3.7196573615194473`*^9, 3.719657362838056*^9}, {
   3.7196574060430803`*^9, 3.7196574386561003`*^9}, {3.719657472676058*^9, 
   3.719657498442898*^9}, {3.719657636218652*^9, 3.719657670184771*^9}, {
   3.7196577017151403`*^9, 3.719657703617139*^9}, {3.71966221613478*^9, 
   3.7196622280306664`*^9}, {3.719662480763899*^9, 3.7196625063999977`*^9}, {
   3.7196625619171677`*^9, 3.7196626002209387`*^9}, {3.71966267955975*^9, 
   3.719662715988278*^9}, {3.719662812997129*^9, 3.719662842149823*^9}, {
   3.719663093430153*^9, 3.719663101156107*^9}, {3.719663195553578*^9, 
   3.719663265292507*^9}, {3.7196633599608927`*^9, 3.719663372540359*^9}, {
   3.719663412348423*^9, 3.719663458141337*^9}, {3.719665537183547*^9, 
   3.7196655719879723`*^9}, {3.7197254052652473`*^9, 3.719725494833666*^9}, {
   3.719725681914853*^9, 3.719725715616377*^9}, {3.719725799333725*^9, 
   3.719725818220581*^9}, {3.719725877273431*^9, 3.7197259613612823`*^9}, {
   3.719726025691444*^9, 3.719726213112496*^9}, {3.719726444128738*^9, 
   3.719726456529598*^9}, {3.719727596190259*^9, 3.719727629362872*^9}, {
   3.719727806211677*^9, 3.719727934266852*^9}, {3.719727974230893*^9, 
   3.719727977229498*^9}, {3.719728097049365*^9, 3.719728100049505*^9}, {
   3.719729072077509*^9, 3.7197292151938267`*^9}, {3.7197320213069*^9, 
   3.719732028076088*^9}, {3.719732088790575*^9, 3.719732094917544*^9}, {
   3.7197321867243977`*^9, 3.719732209033658*^9}, {3.719732289478074*^9, 
   3.719732406489702*^9}, {3.7197326085787983`*^9, 3.71973261842257*^9}, {
   3.719732689954171*^9, 3.7197327314741783`*^9}, {3.719733471072098*^9, 
   3.719733472058918*^9}, {3.719733522645763*^9, 3.719733553157633*^9}, {
   3.719733584774048*^9, 3.719733735083021*^9}, {3.719737395185192*^9, 
   3.719737399408736*^9}, {3.71981940856663*^9, 3.719819411138315*^9}, {
   3.719843314063737*^9, 3.719843413670208*^9}, {3.719843528252864*^9, 
   3.719843533598009*^9}, {3.719843620978965*^9, 3.71984362210338*^9}, {
   3.720243519084482*^9, 3.7202435229175987`*^9}, {3.7202451043841333`*^9, 
   3.720245415885253*^9}, {3.720246273548353*^9, 3.720246474447229*^9}, {
   3.720248674427906*^9, 3.7202486815214987`*^9}, {3.720331115904566*^9, 
   3.7203311681436863`*^9}, {3.72033351656979*^9, 3.720333520463787*^9}, {
   3.7203340842696123`*^9, 3.7203340971892853`*^9}, {3.720348987490931*^9, 
   3.720349010711841*^9}, {3.720349244836308*^9, 3.720349253979446*^9}, {
   3.720503107201013*^9, 3.720503180313891*^9}, {3.720503308390954*^9, 
   3.7205033420945883`*^9}, {3.720505394832678*^9, 3.720505399174391*^9}, {
   3.72050545297269*^9, 3.720505559165401*^9}, {3.720505600648261*^9, 
   3.720505610319808*^9}, {3.720505644865181*^9, 3.720505691536974*^9}, 
   3.720505792435629*^9, 3.720505834077351*^9}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Plotting helper functions", "Chapter"]], "Section",
 CellChangeTimes->{{3.720505813089984*^9, 3.720505825747862*^9}, {
  3.720505918679694*^9, 3.7205059198125763`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Precompute", " ", "the", " ", "static", " ", "bloch", " ", "sphere", " ", 
    "elements", " ", 
    RowBox[{"(", 
     RowBox[{"circumferences", " ", "and", " ", "axes"}], ")"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BlochSphereCircles", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"0.99", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
              RowBox[{"r", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", 
             RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", "Gray"}], "}"}]}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"0.99", "*", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"r", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
              RowBox[{"r", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", 
             RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", "Gray"}], "}"}]}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"0.99", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", " ", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
              RowBox[{"r", " ", 
               RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", 
             RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thin", ",", "Gray"}], "}"}]}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlochSphereAxes", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", "1"}], "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "Thin", ",", " ", "Gray", ",", " ", "Dashed", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1."}], ",", "0.", ",", "0."}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", 
                RowBox[{"-", "1."}], ",", "0."}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "1.", ",", "0."}], "}"}]}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", 
                RowBox[{"-", "1."}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", "}"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Plot", " ", "trace", " ", "on", " ", "Bloch", " ", "sphere"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotBlochTraceFromState", "[", 
      RowBox[{"\[Psi]_", ",", "range_", ",", 
       RowBox[{"opts", " ", ":", 
        RowBox[{"OptionsPattern", "[", 
         RowBox[{"{", "ParametricPlot3D", "}"}], "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"ParametricPlot3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BlochCoordinatesFromState", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Evaluate", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "t", "}"}], ",", "range"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "opts", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "a", " ", "vector", " ", "from", " ", "the", " ", "center", 
     " ", "of", " ", "the", " ", "Bloch", " ", "sphere", " ", "to", " ", 
     "the", " ", "surface", " ", "for", " ", "a", " ", "given", " ", "state", 
     " ", "\[Psi]"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotBlochVectorFromState", "[", 
      RowBox[{"\[Psi]_", ",", 
       RowBox[{"style_List", " ", ":", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", 
     RowBox[{"PlotBlochVector", "[", 
      RowBox[{
       RowBox[{"BlochCoordinatesFromState", "[", "\[Psi]", "]"}], ",", 
       "style"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "a", " ", "vector", " ", "from", " ", "the", " ", "center", 
     " ", "of", " ", "the", " ", "Bloch", " ", "sphere", " ", "to", " ", 
     "the", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], " ", "coordinates", 
     " ", "given", " ", "by", " ", "vec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotBlochVector", "[", 
      RowBox[{"vec_", ",", 
       RowBox[{"style_List", " ", ":", " ", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"style", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", "vec"}], 
            "}"}], "]"}], "}"}]}], "\[IndentingNewLine]", "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "points", " ", "given", " ", "by", " ", "a", " ", "list", 
     " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], " ", "tuples", " ", 
     "in", " ", "pts"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotBlochPoints", "[", 
      RowBox[{"pts_", ",", 
       RowBox[{"style_List", " ", ":", " ", 
        RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"Evaluate", "[", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{"style", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Point", "[", "pts", "]"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plot", " ", "points", " ", "given", " ", "by", " ", "a", " ", "list", 
     " ", "of", " ", "state", " ", "vectors", " ", "\[Psi]s"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PlotBlochPointsFromStates", "[", 
     RowBox[{"\[Psi]s_", ",", 
      RowBox[{"style_List", " ", ":", " ", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"PlotBlochPoints", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"BlochCoordinatesFromState", ",", "\[Psi]s"}], "]"}], ",", 
      "style"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Plot", " ", "BlochAngle", " ", "trace"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotBlochAngleTraceFromState", "[", 
      RowBox[{"\[Psi]_", ",", "range_", ",", 
       RowBox[{"opts", " ", ":", 
        RowBox[{"OptionsPattern", "[", 
         RowBox[{"{", "ParametricPlot", "}"}], "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ParametricPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BlochAngleCoordinatesFromState", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "t", "}"}], ",", "range"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "opts"}], "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{
       RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
       RowBox[{"Line", "@", 
        RowBox[{"Split", "[", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"#", "-", "#2"}], "]"}], "<", "1.5"}], "&"}]}], 
         "]"}]}]}]}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "This", " ", "stuff", " ", "is", " ", "necessary", " ", "to", " ", 
      "remove", " ", "discontinuous", " ", "jumps"}], " ", "*)"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Plot", " ", "mercator", " ", "Bloch", " ", "trace"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotMercatorBlochTraceFromState", "[", 
      RowBox[{"\[Psi]_", ",", "range_", ",", 
       RowBox[{"opts", " ", ":", 
        RowBox[{"OptionsPattern", "[", 
         RowBox[{"{", "ParametricPlot", "}"}], "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ParametricPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MercatorCoordinatesFromBlochAngle", "[", 
         RowBox[{"BlochAngleCoordinatesFromState", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "t", "}"}], ",", "range"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "opts"}], "\[IndentingNewLine]", "]"}], "/.", 
      RowBox[{
       RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
       RowBox[{"Line", "@", 
        RowBox[{"Split", "[", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"#", "-", "#2"}], "]"}], "<", "1.5"}], "&"}]}], 
         "]"}]}]}]}]}], 
    RowBox[{"(*", " ", 
     RowBox[{
     "This", " ", "stuff", " ", "is", " ", "necessary", " ", "to", " ", 
      "remove", " ", "discontinuous", " ", "jumps"}], " ", "*)"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.720505899810814*^9, 3.7205059013441477`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting code", "Chapter",
 CellChangeTimes->{{3.720349110741601*^9, 3.7203491126040497`*^9}}],

Cell[CellGroupData[{

Cell["3D plots", "Section",
 CellChangeTimes->{{3.7203491161574183`*^9, 3.7203491326688643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bloch3DPlotter", ":=", 
    RowBox[{"Hold", "[", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Plot", " ", "the", " ", "trajectory"}], ",", " ", 
            RowBox[{
            "state", " ", "vector", " ", "and", " ", "instantaneous", " ", 
             "rotation", " ", "axis", " ", "of", " ", "the", " ", "qubit", 
             " ", "under", " ", "the", " ", "original", " ", 
             "Hamiltonian"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PlotBlochTraceFromState", "[", 
            RowBox[{"origTrace", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"tM", "*", "tMax"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotBlochVectorFromState", "[", 
            RowBox[{
             RowBox[{"origTrace", "[", 
              RowBox[{"tM", "*", "tMax"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"Thickness", "[", "0.015", "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotBlochVector", "[", 
            RowBox[{
             RowBox[{"RotationAxisFromHamiltonian", "[", 
              RowBox[{"hOrigFunc", "[", 
               RowBox[{
                RowBox[{"tM", "*", "tMax"}], ",", "0.0"}], "]"}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"Thickness", "[", "0.010", "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"PlotBlochPointsFromStates", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"origTrace", ",", "relevantTCoincidence"}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red"}], 
              "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Plot", " ", "the", " ", "trajectory", " ", "of", " ", "the", " ", 
           "qubit", " ", "under", " ", "the", " ", "approximate", " ", 
           "Hamiltonians"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PlotBlochTraceFromState", "[", 
            RowBox[{
             RowBox[{"approxTraces", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"tM", "*", "tMax"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"approxColors", "[", 
               RowBox[{"[", " ", 
                RowBox[{"selectedOrders", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Plot", " ", "the", " ", "points", " ", "where", " ", "the", " ", 
           "approximate", " ", "trajectories", " ", 
           RowBox[{"(", "should", ")"}], " ", "coincide", " ", "with", " ", 
           "the", " ", "original", " ", "trajectory"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PlotBlochPointsFromStates", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"approxTraces", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "relevantTCoincidence"}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "Large", "]"}], ",", 
               RowBox[{"approxColors", "[", 
                RowBox[{"[", " ", 
                 RowBox[{"selectedOrders", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Add", " ", "static", " ", "Bloch", " ", "sphere", " ", 
           "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
         "BlochSphereCircles", ",", "\[IndentingNewLine]", 
         "BlochSphereAxes"}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ViewAngle", "->", 
        RowBox[{"Pi", "/", "10"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Boxed", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.71965440505723*^9, 3.719654452102209*^9}, {
   3.719654674060545*^9, 3.719654702869274*^9}, {3.719655508107579*^9, 
   3.719655526354762*^9}, {3.719657512358118*^9, 3.7196575140282583`*^9}, {
   3.719657606966461*^9, 3.719657611640386*^9}, {3.719662541770338*^9, 
   3.719662544425715*^9}, {3.719662625109373*^9, 3.719662628605137*^9}, {
   3.719662663367815*^9, 3.719662669335495*^9}, 3.719662704950479*^9, {
   3.7196635194614553`*^9, 3.719663565642974*^9}, {3.719663736795269*^9, 
   3.719663854251069*^9}, {3.719663984969365*^9, 3.7196639870074778`*^9}, {
   3.719664020674241*^9, 3.719664121158648*^9}, {3.7196641711675653`*^9, 
   3.719664189486896*^9}, {3.71966437771943*^9, 3.719664378404018*^9}, {
   3.719665318712253*^9, 3.719665390125635*^9}, {3.719665580709318*^9, 
   3.719665646073825*^9}, 3.719725396498043*^9, {3.7197257200427322`*^9, 
   3.719725785884077*^9}, {3.719725822556342*^9, 3.7197258251010942`*^9}, {
   3.719725989354001*^9, 3.7197260028892193`*^9}, {3.719726193801155*^9, 
   3.719726198344083*^9}, {3.719726277620516*^9, 3.719726283818696*^9}, {
   3.719726354815783*^9, 3.719726378278873*^9}, {3.7197265657339993`*^9, 
   3.719726588676334*^9}, {3.719726672655373*^9, 3.719726705026067*^9}, {
   3.71972795518334*^9, 3.7197280766738787`*^9}, {3.719728147204784*^9, 
   3.719728160898158*^9}, {3.719729227395198*^9, 3.719729279699827*^9}, {
   3.719729613243144*^9, 3.7197297188378067`*^9}, {3.719729785104641*^9, 
   3.7197297916086206`*^9}, {3.719729832297455*^9, 3.719729924459887*^9}, {
   3.719729979097412*^9, 3.71972998131817*^9}, {3.719730030233679*^9, 
   3.719730032904345*^9}, 3.719730159287866*^9, {3.719730351583226*^9, 
   3.719730371607519*^9}, {3.7197305373153563`*^9, 3.719730567858818*^9}, {
   3.719730608124115*^9, 3.719730697896439*^9}, {3.7197308187913733`*^9, 
   3.719731050265031*^9}, {3.719731131151889*^9, 3.719731257267704*^9}, {
   3.7197313143414392`*^9, 3.719731372327129*^9}, {3.7197314547622433`*^9, 
   3.7197314783220367`*^9}, {3.719731524980694*^9, 3.719731593527*^9}, 
   3.7197316336068687`*^9, {3.719731992082862*^9, 3.7197320151148567`*^9}, {
   3.719732748119629*^9, 3.719732851854064*^9}, {3.7197328899051027`*^9, 
   3.7197328948084784`*^9}, {3.7197329327062607`*^9, 3.719732933728594*^9}, {
   3.71973303737566*^9, 3.71973306993294*^9}, {3.719733167347945*^9, 
   3.71973317633293*^9}, {3.7197335847993593`*^9, 3.7197335848066587`*^9}, {
   3.719733768925458*^9, 3.7197339297769823`*^9}, {3.71973397704596*^9, 
   3.7197340738104753`*^9}, {3.719734142221374*^9, 3.719734148600995*^9}, {
   3.719737410434022*^9, 3.7197374196115923`*^9}, {3.7197374707945433`*^9, 
   3.7197374739364157`*^9}, {3.719739622793873*^9, 3.7197397000068483`*^9}, {
   3.7197398319804983`*^9, 3.719739898920965*^9}, {3.719739971782125*^9, 
   3.719740089488901*^9}, {3.719740404220591*^9, 3.719740409874135*^9}, {
   3.7197404902076283`*^9, 3.719740571638661*^9}, {3.7197410313203*^9, 
   3.7197410503182507`*^9}, {3.719741121879806*^9, 3.71974117754482*^9}, {
   3.719741255202168*^9, 3.71974135947784*^9}, {3.7197414046488457`*^9, 
   3.719741470762108*^9}, {3.7197416516644793`*^9, 3.7197417115878963`*^9}, {
   3.719741744193177*^9, 3.719741767017825*^9}, {3.719741806060226*^9, 
   3.7197418150240927`*^9}, {3.719741894073694*^9, 3.719742024722701*^9}, {
   3.719742089576519*^9, 3.71974221270998*^9}, {3.7197422462915382`*^9, 
   3.71974226678841*^9}, {3.719742367841947*^9, 3.7197423861490498`*^9}, {
   3.719742445922613*^9, 3.719742477138301*^9}, {3.719742941971538*^9, 
   3.7197429773772917`*^9}, {3.719743007755834*^9, 3.7197430214095917`*^9}, {
   3.719743074741489*^9, 3.719743099028145*^9}, {3.7197431470330477`*^9, 
   3.719743148430347*^9}, {3.7197432081005373`*^9, 3.719743252056549*^9}, {
   3.7197434238639717`*^9, 3.719743434209897*^9}, {3.719743481769442*^9, 
   3.7197435941957827`*^9}, {3.7197436743197317`*^9, 3.719743707914002*^9}, {
   3.7197437601792727`*^9, 3.719743761463875*^9}, {3.7197438959599743`*^9, 
   3.719743896251837*^9}, {3.719743980824048*^9, 3.719744039519884*^9}, {
   3.71974407663945*^9, 3.719744077959858*^9}, {3.71974412137658*^9, 
   3.7197443108652143`*^9}, {3.7197444202114687`*^9, 
   3.7197444513077803`*^9}, {3.719744481614853*^9, 3.719744679803318*^9}, {
   3.7197447325833883`*^9, 3.7197447331771393`*^9}, {3.719744911692194*^9, 
   3.719744912256269*^9}, {3.7197449638534822`*^9, 3.719744984859655*^9}, {
   3.719745052670991*^9, 3.719745055917173*^9}, {3.719745176627383*^9, 
   3.719745186909519*^9}, {3.719745228208479*^9, 3.719745237732038*^9}, {
   3.719746399671158*^9, 3.719746479871434*^9}, {3.719746545220299*^9, 
   3.719746621029441*^9}, 3.719746747927788*^9, {3.719746799124988*^9, 
   3.7197469339805927`*^9}, {3.719746976946539*^9, 3.71974703642428*^9}, {
   3.719747100670011*^9, 3.7197471020664597`*^9}, {3.7198119359065437`*^9, 
   3.719811953752569*^9}, {3.719812061519149*^9, 3.719812063628517*^9}, 
   3.719813267447775*^9, 3.719832746783979*^9, 3.7198428663838882`*^9, {
   3.719843354205288*^9, 3.719843363712579*^9}, {3.719843444367652*^9, 
   3.719843502247257*^9}, {3.719843537230729*^9, 3.719843545435014*^9}, {
   3.720246413114575*^9, 3.720246414290749*^9}, {3.720246522590025*^9, 
   3.720246523257423*^9}, 3.720268295639347*^9, 3.720349143625721*^9, {
   3.720503221707087*^9, 3.720503251315072*^9}, {3.720503281956786*^9, 
   3.720503293085417*^9}, {3.720504877053884*^9, 3.720504884432884*^9}, {
   3.7205060857987757`*^9, 3.7205061378284187`*^9}, {3.720509189462253*^9, 
   3.720509191525303*^9}, {3.72051122820717*^9, 3.720511231103367*^9}, {
   3.7208687519522552`*^9, 3.720868757989324*^9}, {3.7208700198551207`*^9, 
   3.720870029893828*^9}, {3.720870118547086*^9, 3.720870123364106*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cartesian Bloch angle plots", "Section",
 CellChangeTimes->{{3.7203491486514997`*^9, 3.720349156317628*^9}, {
  3.720358276007145*^9, 3.720358277511012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlochAnglePlotter", ":=", 
   RowBox[{"Hold", "[", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Plot", " ", "the", " ", "trajectory", " ", "and", " ", 
           "stroboscopic", " ", "coincidence", " ", "points", " ", "of", " ", 
           "the", " ", "qubit", " ", "under", " ", "the", " ", "original", 
           " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PlotBlochAngleTraceFromState", "[", 
           RowBox[{
            RowBox[{"XBasisFromZBasis", "@*", "origTrace"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"tM", "*", "tMax"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"BlochAngleCoordinatesFromState", "/@", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"XBasisFromZBasis", "@*", "origTrace"}], ")"}], "/@",
                 "relevantTCoincidence"}]}], "]"}]}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Plot", " ", "the", " ", "trajectory", " ", "of", " ", "the", " ", 
          "qubit", " ", "under", " ", "the", " ", "approximate", " ", 
          "Hamiltonians"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PlotBlochAngleTraceFromState", "[", 
           RowBox[{
            RowBox[{"XBasisFromZBasis", "@*", 
             RowBox[{"(", 
              RowBox[{"approxTraces", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"tM", "*", "tMax"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"approxColors", "[", 
              RowBox[{"[", " ", 
               RowBox[{"selectedOrders", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}]}], " ", 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Plot", " ", "the", " ", "points", " ", "where", " ", "the", " ", 
          "approximate", " ", "trajectories", " ", 
          RowBox[{"(", "should", ")"}], " ", "coincide", " ", "with", " ", 
          "the", " ", "original", " ", "trajectory"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "Large", "]"}], ",", 
             RowBox[{"approxColors", "[", 
              RowBox[{"[", " ", 
               RowBox[{"selectedOrders", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"BlochAngleCoordinatesFromState", "/@", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"XBasisFromZBasis", "@*", 
                  RowBox[{"(", 
                   RowBox[{"approxTraces", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}], "/@", 
                "relevantTCoincidence"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Pi"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AxesOrigin", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"800", ",", "400"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<x-basis phase angle \[Phi]\\n\[Phi] = arg(<\[Psi]|->) - arg(<\
\[Psi]|+>)\\n'longitude'\>\"", ",", 
         "\"\<x-basis population angle \[Theta]\\ncos(\[Theta]/2) = \
|<\[Psi]|+>|\\n'latitude'\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\<Bloch angle coordinates in the X-basis\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.720349177905793*^9, 3.720349179320332*^9}, {
  3.720355569185862*^9, 3.720355572720828*^9}, {3.7205048805844927`*^9, 
  3.720504883185042*^9}, {3.720505694807459*^9, 3.720505742305789*^9}, {
  3.7205061512319*^9, 3.7205062122944803`*^9}, {3.720509164985203*^9, 
  3.7205091682638073`*^9}, {3.720511225983327*^9, 3.7205112377910023`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mercator plots", "Section",
 CellChangeTimes->{{3.720349180673524*^9, 3.720349185766903*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlochMercatorPlotter", ":=", 
    RowBox[{"Hold", "[", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Plot", " ", "the", " ", "trajectory", " ", "and", " ", 
            "stroboscopic", " ", "coincidence", " ", "points", " ", "of", " ",
             "the", " ", "qubit", " ", "under", " ", "the", " ", "original", 
            " ", "Hamiltonian"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PlotMercatorBlochTraceFromState", "[", 
            RowBox[{
             RowBox[{"XBasisFromZBasis", "@*", "origTrace"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"tM", "*", "tMax"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"MercatorCoordinatesFromBlochAngle", "/@", 
                RowBox[{"BlochAngleCoordinatesFromState", "/@", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"XBasisFromZBasis", "@*", "origTrace"}], ")"}], "/@",
                   "relevantTCoincidence"}]}]}], "]"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Plot", " ", "the", " ", "trajectory", " ", "of", " ", "the", " ", 
           "qubit", " ", "under", " ", "the", " ", "approximate", " ", 
           "Hamiltonians"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PlotMercatorBlochTraceFromState", "[", 
            RowBox[{
             RowBox[{"XBasisFromZBasis", "@*", 
              RowBox[{"(", 
               RowBox[{"approxTraces", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"tM", "*", "tMax"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"approxColors", "[", 
               RowBox[{"[", " ", 
                RowBox[{"selectedOrders", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}]}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Plot", " ", "the", " ", "points", " ", "where", " ", "the", " ", 
           "approximate", " ", "trajectories", " ", 
           RowBox[{"(", "should", ")"}], " ", "coincide", " ", "with", " ", 
           "the", " ", "original", " ", "trajectory"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Large", "]"}], ",", 
              RowBox[{"approxColors", "[", 
               RowBox[{"[", " ", 
                RowBox[{"selectedOrders", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"MercatorCoordinatesFromBlochAngle", "/@", 
                RowBox[{"BlochAngleCoordinatesFromState", "/@", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"XBasisFromZBasis", "@*", 
                    RowBox[{"(", 
                    RowBox[{"approxTraces", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}], "/@", 
                  "relevantTCoincidence"}]}]}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"800", ",", "400"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Mercator longitude \[Phi],\\nx-basis phase angle \
\[Phi]\\n\[Phi] = arg(<\[Psi]|->) - arg(<\[Psi]|+>)\\n\>\"", ",", 
          "\"\<Mercator z-intersect z(\[Theta]),\\nx-basis population angle \
\[Theta]\\ncos(\[Theta]/2) = |<\[Psi]|+>|\>\""}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.71975408758805*^9, 3.719754110021474*^9}, {
   3.71975452981112*^9, 3.719754606574605*^9}, {3.7197546407783012`*^9, 
   3.7197546472498083`*^9}, {3.719817864184292*^9, 3.719817909721388*^9}, {
   3.7198195019856577`*^9, 3.719819503285576*^9}, {3.719820235918066*^9, 
   3.719820251476564*^9}, {3.7198305755691357`*^9, 3.719830650051548*^9}, {
   3.719830821928141*^9, 3.71983084255162*^9}, {3.719831527367661*^9, 
   3.7198315552291822`*^9}, {3.719831613657439*^9, 3.719831643177147*^9}, {
   3.719831705045723*^9, 3.719831718901246*^9}, {3.7198318221473017`*^9, 
   3.7198318312066927`*^9}, {3.7198320641366243`*^9, 3.719832088334985*^9}, {
   3.719832134179079*^9, 3.719832144872622*^9}, {3.7198323815882187`*^9, 
   3.719832471802874*^9}, {3.7198325240014887`*^9, 3.719832537116781*^9}, 
   3.7198328266032667`*^9, {3.719843174759067*^9, 3.719843244248317*^9}, {
   3.7198437511308002`*^9, 3.719843788827873*^9}, {3.71984384298101*^9, 
   3.719843864113104*^9}, {3.720243702204912*^9, 3.7202437875619783`*^9}, {
   3.720243943503297*^9, 3.720243987025612*^9}, {3.7202464165341167`*^9, 
   3.7202464172056713`*^9}, {3.72024652475279*^9, 3.720246525600177*^9}, {
   3.720349200187489*^9, 3.7203492111628036`*^9}, {3.7203492623724937`*^9, 
   3.720349272891117*^9}, {3.720349762101885*^9, 3.720349764371441*^9}, {
   3.720504887848832*^9, 3.720504889168459*^9}, {3.7205057516031103`*^9, 
   3.720505759989237*^9}, {3.7205062204664783`*^9, 3.7205062598765697`*^9}, {
   3.720509177535778*^9, 3.7205091823988943`*^9}, {3.7205112202573357`*^9, 
   3.720511220601502*^9}, {3.7205112516885767`*^9, 3.720511257207906*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interactive trajectory manipulation code", "Section",
 CellChangeTimes->{{3.720349274914537*^9, 3.720349289002267*^9}, {
  3.720349585158554*^9, 3.720349590148341*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"approxColors", "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}], ",", 
      RowBox[{"Length", "[", "ApproxHList", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "1."}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InteractiveTrajectoryPlotting", "[", "plotExprs_List", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "origTrace", ",", "approxTraces", ",", "\[Psi]0", ",", "gateAngle", ",", 
      "tMax", ",", "H1func", ",", "vals", ",", "hOrigFunc", ",", 
      "\[IndentingNewLine]", "tCoincidence", ",", "t0", ",", "tC", ",", 
      "relevantTCoincidence", ",", "selectedH1Profile", ",", 
      "selectedH1Index", ",", "numSelectedOrders", ",", "\[IndentingNewLine]",
       "selectedJmpOperators", ",", "approx\[Psi]0", ",", "jmpFuncs"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", "\"\<Select driving envelope:  \>\"", "]"}], 
          ",", 
          RowBox[{"PopupMenu", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "selectedH1Index", "]"}], ",", 
            "H1pOptions"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"H1pList", "[", 
               RowBox[{"[", "selectedH1Index", "]"}], "]"}], "@", "t"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<t/t_max\>\"", ",", "\"\<H1/H1_avg\>\""}], "}"}]}],
              ",", 
             RowBox[{
             "PlotLabel", "\[Rule]", "\"\<driving envelope H1(t)\>\""}], ",", 
             
             RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Define", " ", "initial", " ", "state", " ", "and", " ", "desired", 
          " ", "gate", " ", "angle"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]0", "=", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"gateAngle", " ", "=", " ", "Pi"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tMax", " ", "=", " ", 
           RowBox[{"2", "*", 
            RowBox[{"gateAngle", "/", "H1avg"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", "selectedH1Index", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"selectedH1Profile", "=", 
           RowBox[{"H1pList", "[", 
            RowBox[{"[", "selectedH1Index", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"H1func", "=", 
           RowBox[{"Function", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"selectedH1Profile", "[", 
               RowBox[{"t", "/", "tMax"}], "]"}], "*", "H1avg"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"vals", " ", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ww", "\[Rule]", "wwIn"}], ",", 
             RowBox[{"Delta", "\[Rule]", "DeltaIn"}], ",", 
             RowBox[{"phi", "\[Rule]", "phiIn"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Compute", " ", "the", " ", "times", " ", "at", " ", "which", " ", 
            "the", " ", "Magnus", " ", "and", " ", "the", " ", "real", " ", 
            "Hamiltonians", " ", "are", " ", "supposed", " ", "to", " ", 
            "coincide"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"t0", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Alpha]0", "/", "ww"}], ")"}], "/.", "vals"}]}], ";", 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "ww", " ", "is", " ", "still", " ", "defined", " ", "in", " ", 
             "vals"}], ",", " ", 
            RowBox[{
            "maybe", " ", "later", " ", "we", " ", "make", " ", "it", " ", 
             "an", " ", "interactive", " ", "parameter", " ", "as", " ", 
             RowBox[{"well", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tC", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Pi", "/", "ww"}], ")"}], "/.", "vals"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tCoincidence", "=", 
           RowBox[{"t0", "+", 
            RowBox[{"Range", "[", 
             RowBox[{"0.0", ",", "tMax", ",", "tC"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"numSelectedOrders", "=", 
           RowBox[{"Length", "[", "selectedOrders", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "calculate", " ", "the", " ", "starting", " ", "positions", " ", 
            "of", " ", "the", " ", "approximate", " ", "trajectories", " ", 
            "using", " ", "the", " ", "jump", " ", "operators"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"selectedJmpOperators", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "/.", "pms"}], ")"}], " ", "*", "ones2"}], 
                 "&"}], "/@", 
                RowBox[{"jmpList", "[", 
                 RowBox[{"[", "selectedH1Index", "]"}], "]"}]}], ")"}], "/.", 
              "vals"}], "/.", "H1Dsubs"}], "/.", 
            RowBox[{"{", 
             RowBox[{"H1", "\[Rule]", "H1func"}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"MatrixForm", "/@", "selectedJmpOperators"}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"jmpFuncs", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"t", ",", "\[Alpha]0"}], "}"}], ",", "func"}], 
                "]"}], "/.", 
               RowBox[{"func", "\[Rule]", "#"}]}], "&"}], ")"}], "/@", 
            "selectedJmpOperators"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"approx\[Psi]0", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MatrixExp", "[", 
               RowBox[{
                RowBox[{"jmpFuncs", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{"selectedOrders", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], "[", 
                RowBox[{"0", ",", "\[Alpha]0"}], "]"}], "]"}], ".", 
              "\[Psi]0"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Assemble", " ", "Hamiltonians", " ", "based", " ", "on", " ", 
            "the", " ", "given", " ", "parameters", " ", "and", " ", 
            "numerically", " ", "solve", " ", "trajectories", " ", "of", " ", 
            "qubit"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"hOrigFunc", "=", 
           RowBox[{"GetHFunc", "[", 
            RowBox[{"Horig", ",", "H1func", ",", "vals"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"origTrace", "=", 
           RowBox[{"\[Psi]", "/.", 
            RowBox[{"NTrajectory", "[", 
             RowBox[{
             "hOrigFunc", ",", "tMax", ",", "\[Alpha]0", ",", "\[Psi]0"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"approxTraces", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "/.", 
              RowBox[{"NTrajectory", "[", 
               RowBox[{
                RowBox[{"GetHFunc", "[", 
                 RowBox[{
                  RowBox[{"ApproxHList", "[", 
                   RowBox[{"[", " ", 
                    RowBox[{"selectedOrders", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], ",", 
                  "H1func", ",", "vals"}], "]"}], ",", "tMax", ",", 
                "\[Alpha]0", ",", 
                RowBox[{"approx\[Psi]0", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "numSelectedOrders"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Let", "'"}], "s", " ", "get", " ", 
            RowBox[{
             RowBox[{"plottin", "'"}], "!"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"relevantTCoincidence", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"tCoincidence", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", "<", 
                  RowBox[{"tM", "*", "tMax"}]}], "&"}], ")"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"selectedPlots", "=", 
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "plotExprs", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"selplots", "[", "1", "]"}], ",", 
                    RowBox[{"selplots", "[", "2", "]"}], ",", 
                    RowBox[{"selplots", "[", "3", "]"}], ",", 
                    RowBox[{"selplots", "[", "4", "]"}]}], "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Length", "[", "plotExprs", "]"}]}], "]"}], "]"}],
                  ",", "1"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"ReleaseHold", "[", 
                 RowBox[{"plotExprs", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "selectedPlots"}], "}"}]}], "]"}], "}"}], 
             "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tM", ",", " ", "0.01", ",", "\"\<Time t\>\""}], "}"}], 
           ",", "0.01", ",", "1.0", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}], ",", 
           RowBox[{"AnimationRate", "\[Rule]", ".03"}], ",", 
           RowBox[{"RefreshRate", "\[Rule]", ".005"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[Alpha]0", ",", "0.0", ",", "\"\<Offset \[Alpha]0\>\""}], "}"}],
            ",", "0.0", ",", " ", "Pi", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "H1avg", ",", " ", "0.2", ",", 
             "\"\<Average drive strength H1_avg\>\""}], "}"}], ",", "0.01", 
           ",", "2.0", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "upToOrder", ",", "1", ",", 
               "\"\<Include Magnus expansion up to order\>\""}], "}"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "ApproxHList", "]"}], "-", "1"}], ",", 
             "1", ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
           ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"selectedOrders", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], ",", 
             "\"\<Show Magnus orders\>\""}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Graphics", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                   RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
                   RowBox[{"approxColors", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", 
                   RowBox[{"Rectangle", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}], "]"}]}], "}"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"30", ",", "12"}], "}"}]}]}], "]"}]}], ")"}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ApproxHList", "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ControlType", "\[Rule]", "CheckboxBar"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "wwIn", ",", "1.0", ",", "\"\<Drive frequency \[Omega]\>\""}], 
            "}"}], ",", "0.01", ",", "2.0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "DeltaIn", ",", "0.0", ",", 
             "\"\<Qubit detuning \[CapitalDelta]\>\""}], "}"}], ",", 
           RowBox[{"-", "1.0"}], ",", "1.0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "phiIn", ",", "0.0", ",", "\"\<Rotation axis angle \[Phi]\>\""}], 
            "}"}], ",", 
           RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"selectedPlots", ",", 
             RowBox[{"Pick", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "plotExprs", "]"}], "]"}], ",", 
               RowBox[{"plotExprs", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
             ",", "\"\<Visualizations\>\""}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "\[Rule]", 
              RowBox[{"plotExprs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "plotExprs", "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"ControlType", "\[Rule]", "CheckboxBar"}]}], "}"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"selplots", "[", "i", "]"}], ",", 
                 RowBox[{"plotExprs", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"plotExprs", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "plotExprs", "]"}]}], "}"}]}], "]"}]}], 
          "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.720349299127124*^9, 3.720349338149681*^9}, {
   3.720349478941538*^9, 3.7203495598621273`*^9}, {3.720349817696536*^9, 
   3.7203499678848886`*^9}, {3.720350043493881*^9, 3.720350060925932*^9}, {
   3.7203501344568367`*^9, 3.720350138578557*^9}, {3.7203502617824078`*^9, 
   3.72035034671142*^9}, {3.7203545357709427`*^9, 3.7203545764962263`*^9}, {
   3.720354836996895*^9, 3.720355097484405*^9}, 3.720355260675953*^9, {
   3.7203553217548532`*^9, 3.720355391386819*^9}, {3.720355431421301*^9, 
   3.7203555195771217`*^9}, {3.720355676095797*^9, 3.7203557106301613`*^9}, {
   3.7203558735766077`*^9, 3.720355875562792*^9}, {3.720355909045388*^9, 
   3.720355936774487*^9}, {3.720355973648233*^9, 3.720355976247266*^9}, {
   3.720356580133671*^9, 3.720356685788978*^9}, {3.720356758993224*^9, 
   3.720356778205873*^9}, {3.720356820963797*^9, 3.720356824347335*^9}, {
   3.720356862222742*^9, 3.72035695355239*^9}, {3.720357074386897*^9, 
   3.720357128171701*^9}, {3.720357196568652*^9, 3.7203572437036448`*^9}, {
   3.72035767462002*^9, 3.720357676933795*^9}, {3.7204167171578503`*^9, 
   3.7204168090083113`*^9}, {3.720416863690905*^9, 3.720416970664596*^9}, {
   3.720417087468534*^9, 3.720417280077005*^9}, {3.7204173409015503`*^9, 
   3.7204174045789757`*^9}, {3.720417876164535*^9, 3.720417881689611*^9}, {
   3.7204331855001373`*^9, 3.720433197760211*^9}, {3.7204333954557858`*^9, 
   3.720433396014113*^9}, {3.720438271155867*^9, 3.720438286607758*^9}, {
   3.720438365375224*^9, 3.7204383956050987`*^9}, {3.720439038000201*^9, 
   3.720439041807666*^9}, {3.7204390911541023`*^9, 3.720439111619898*^9}, {
   3.720439245517983*^9, 3.720439300383903*^9}, {3.7204393548640747`*^9, 
   3.720439362766941*^9}, {3.7204396219577093`*^9, 3.720439626845045*^9}, 
   3.720439788131686*^9, {3.720439821666958*^9, 3.7204398384104967`*^9}, {
   3.720440043883354*^9, 3.720440052023467*^9}, {3.720440092882688*^9, 
   3.720440117236165*^9}, {3.7204401499661837`*^9, 3.720440150867346*^9}, {
   3.720440191472412*^9, 3.720440246637135*^9}, {3.720440286790915*^9, 
   3.720440290239402*^9}, 3.7204403300419683`*^9, {3.7204403715737877`*^9, 
   3.720440384044261*^9}, {3.720440425212141*^9, 3.720440425795039*^9}, {
   3.7204406417152042`*^9, 3.720440643665909*^9}, {3.720440723046317*^9, 
   3.720440809702422*^9}, {3.7204409554437923`*^9, 3.7204409880526*^9}, {
   3.720441035955605*^9, 3.720441044230165*^9}, 3.72044109572644*^9, {
   3.72044128697493*^9, 3.720441287421446*^9}, {3.720441911426277*^9, 
   3.720441928753602*^9}, 3.7204421078645763`*^9, {3.7205020618102417`*^9, 
   3.720502061999702*^9}, {3.720503823520789*^9, 3.720503828270088*^9}, {
   3.7205043201587343`*^9, 3.720504522123054*^9}, {3.72050455324612*^9, 
   3.720504595734074*^9}, {3.720504633274888*^9, 3.7205046661842833`*^9}, {
   3.72050476156581*^9, 3.720504860553863*^9}, {3.720504919673787*^9, 
   3.720504920080515*^9}, {3.7205060010845947`*^9, 3.720506065348461*^9}, 
   3.720506307741461*^9, {3.720510979556518*^9, 3.720511100781433*^9}, {
   3.720511180273054*^9, 3.720511208352579*^9}, {3.720511702905122*^9, 
   3.72051170472011*^9}, {3.720516432362967*^9, 3.720516485451816*^9}, {
   3.720516857019567*^9, 3.7205168574962482`*^9}, {3.720517980628001*^9, 
   3.720518030948935*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The final plot!", "Section",
 CellChangeTimes->{{3.720349571021181*^9, 3.7203495810279293`*^9}}],

Cell[BoxData[
 RowBox[{"InteractiveTrajectoryPlotting", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Bloch3DPlotter", ",", "\"\<3D\>\"", ",", "1"}], "}"}], ",", " ",
     "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "BlochAnglePlotter", ",", "\"\<Cartesian Bloch angle\>\"", ",", "0"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"BlochMercatorPlotter", ",", "\"\<Mercator\>\"", ",", "0"}], 
     "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7203495969029007`*^9, 3.720349646558012*^9}, {
   3.7203553974281397`*^9, 3.720355417289392*^9}, {3.720357054369513*^9, 
   3.7203570667768917`*^9}, {3.720357149726101*^9, 3.720357154276394*^9}, {
   3.720357505089733*^9, 3.72035753003902*^9}, {3.720357679173058*^9, 
   3.72035768248389*^9}, {3.72035826940269*^9, 3.720358270887439*^9}, {
   3.7204167455022297`*^9, 3.72041675968716*^9}, 3.7204400971983337`*^9, {
   3.720504530316079*^9, 3.720504534626072*^9}, {3.720505763220057*^9, 
   3.720505766040083*^9}, {3.720516467328878*^9, 3.720516467773799*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 929},
WindowMargins->{{-1920, Automatic}, {Automatic, 6}},
CellContext->Notebook,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 159, 2, 66, "Text"],
Cell[CellGroupData[{
Cell[742, 26, 223, 3, 71, "Section"],
Cell[968, 31, 244, 6, 49, "Text"],
Cell[1215, 39, 894, 25, 28, "Input"],
Cell[2112, 66, 169, 2, 30, "Text"],
Cell[2284, 70, 5400, 143, 272, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7721, 218, 270, 3, 65, "Chapter"],
Cell[7994, 223, 11419, 299, 821, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19450, 527, 186, 2, 65, "Chapter"],
Cell[19639, 531, 3904, 97, 199, "Input"],
Cell[23546, 630, 10855, 245, 743, "Input"],
Cell[CellGroupData[{
Cell[34426, 879, 192, 2, 71, "Section"],
Cell[34621, 883, 12125, 302, 1015, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46795, 1191, 100, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[46920, 1196, 97, 1, 64, "Section"],
Cell[47020, 1199, 11067, 198, 454, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58124, 1402, 163, 2, 64, "Section"],
Cell[58290, 1406, 5480, 122, 369, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63807, 1533, 99, 1, 64, "Section"],
Cell[63909, 1536, 6832, 137, 352, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70778, 1678, 174, 2, 64, "Section"],
Cell[70955, 1682, 20475, 449, 1049, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91467, 2136, 102, 1, 64, "Section"],
Cell[91572, 2139, 1124, 21, 97, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
